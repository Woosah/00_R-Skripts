


<!DOCTYPE html>
<html>
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# githubog: http://ogp.me/ns/fb/githubog#">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>metvurst/markdown/20130617_data_vis_workshop.Rmd at master · tim-salabim/metvurst · GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub" />
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-144.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144.png" />
    <link rel="logo" type="image/svg" href="https://github-media-downloads.s3.amazonaws.com/github-logo.svg" />
    <meta property="og:image" content="https://github.global.ssl.fastly.net/images/modules/logos_page/Octocat.png">
    <meta name="hostname" content="fe4.rs.github.com">
    <link rel="assets" href="https://github.global.ssl.fastly.net/">
    <link rel="xhr-socket" href="/_sockets" />
    
    


    <meta name="msapplication-TileImage" content="/windows-tile.png" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="selected-link" value="repo_source" data-pjax-transient />
    <meta content="collector.githubapp.com" name="octolytics-host" /><meta content="github" name="octolytics-app-id" />

    
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <meta content="authenticity_token" name="csrf-param" />
<meta content="bvrv7baoesHlSPPZcnBn8SS216a1kgbcpok90N4IXbw=" name="csrf-token" />

    <link href="https://github.global.ssl.fastly.net/assets/github-a51b7140dfba9f0ae1fe0eaf345dd6a4381f4ef8.css" media="all" rel="stylesheet" type="text/css" />
    <link href="https://github.global.ssl.fastly.net/assets/github2-ec4f51bae74d4ad5725891dccaecd4cc727d8cdc.css" media="all" rel="stylesheet" type="text/css" />
    


      <script src="https://github.global.ssl.fastly.net/assets/frameworks-e8054ad804a1cf9e9849130fee5a4a5487b663ed.js" type="text/javascript"></script>
      <script src="https://github.global.ssl.fastly.net/assets/github-90f8e0e909066dd1bee7ca4e33b769e7a28f0e3f.js" type="text/javascript"></script>
      
      <meta http-equiv="x-pjax-version" content="2faa5dbb764a951963be37a67771af2b">

        <link data-pjax-transient rel='permalink' href='/tim-salabim/metvurst/blob/70a375ed56f9dede98876177ce316434d5232f9f/markdown/20130617_data_vis_workshop.Rmd'>
  <meta property="og:title" content="metvurst"/>
  <meta property="og:type" content="githubog:gitrepository"/>
  <meta property="og:url" content="https://github.com/tim-salabim/metvurst"/>
  <meta property="og:image" content="https://github.global.ssl.fastly.net/images/gravatars/gravatar-user-420.png"/>
  <meta property="og:site_name" content="GitHub"/>
  <meta property="og:description" content="metvurst - meteorological visualisation utilities using R for science and teaching"/>

  <meta name="description" content="metvurst - meteorological visualisation utilities using R for science and teaching" />

  <meta content="2826432" name="octolytics-dimension-user_id" /><meta content="tim-salabim" name="octolytics-dimension-user_login" /><meta content="8243610" name="octolytics-dimension-repository_id" /><meta content="tim-salabim/metvurst" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="8243610" name="octolytics-dimension-repository_network_root_id" /><meta content="tim-salabim/metvurst" name="octolytics-dimension-repository_network_root_nwo" />
  <link href="https://github.com/tim-salabim/metvurst/commits/master.atom" rel="alternate" title="Recent Commits to metvurst:master" type="application/atom+xml" />

  </head>


  <body class="logged_out page-blob windows vis-public env-production ">

    <div class="wrapper">
      
      
      


      
      <div class="header header-logged-out">
  <div class="container clearfix">

    <a class="header-logo-wordmark" href="https://github.com/">
      <span class="mega-octicon octicon-logo-github"></span>
    </a>

    <div class="header-actions">
      <a class="button primary" href="/signup">Sign up</a>
      <a class="button" href="/login?return_to=%2Ftim-salabim%2Fmetvurst%2Fblob%2Fmaster%2Fmarkdown%2F20130617_data_vis_workshop.Rmd">Sign in</a>
    </div>

    <div class="command-bar js-command-bar  in-repository">


      <ul class="top-nav">
          <li class="explore"><a href="/explore">Explore</a></li>
        <li class="features"><a href="/features">Features</a></li>
          <li class="enterprise"><a href="https://enterprise.github.com/">Enterprise</a></li>
          <li class="blog"><a href="/blog">Blog</a></li>
      </ul>
        <form accept-charset="UTF-8" action="/search" class="command-bar-form" id="top_search_form" method="get">

<input type="text" data-hotkey=" s" name="q" id="js-command-bar-field" placeholder="Search or type a command" tabindex="1" autocapitalize="off"
    
    
      data-repo="tim-salabim/metvurst"
      data-branch="master"
      data-sha="738a4744e73e4be3ab6514b6a3eee95276d21d8d"
  >

    <input type="hidden" name="nwo" value="tim-salabim/metvurst" />

    <div class="select-menu js-menu-container js-select-menu search-context-select-menu">
      <span class="minibutton select-menu-button js-menu-target">
        <span class="js-select-button">This repository</span>
      </span>

      <div class="select-menu-modal-holder js-menu-content js-navigation-container">
        <div class="select-menu-modal">

          <div class="select-menu-item js-navigation-item js-this-repository-navigation-item selected">
            <span class="select-menu-item-icon octicon octicon-check"></span>
            <input type="radio" class="js-search-this-repository" name="search_target" value="repository" checked="checked" />
            <div class="select-menu-item-text js-select-button-text">This repository</div>
          </div> <!-- /.select-menu-item -->

          <div class="select-menu-item js-navigation-item js-all-repositories-navigation-item">
            <span class="select-menu-item-icon octicon octicon-check"></span>
            <input type="radio" name="search_target" value="global" />
            <div class="select-menu-item-text js-select-button-text">All repositories</div>
          </div> <!-- /.select-menu-item -->

        </div>
      </div>
    </div>

  <span class="octicon help tooltipped downwards" title="Show command bar help">
    <span class="octicon octicon-question"></span>
  </span>


  <input type="hidden" name="ref" value="cmdform">

</form>
    </div>

  </div>
</div>


      


          <div class="site" itemscope itemtype="http://schema.org/WebPage">
    
    <div class="pagehead repohead instapaper_ignore readability-menu">
      <div class="container">
        

<ul class="pagehead-actions">


  <li>
  <a href="/login?return_to=%2Ftim-salabim%2Fmetvurst"
  class="minibutton with-count js-toggler-target star-button entice tooltipped upwards "
  title="You must be signed in to use this feature" rel="nofollow">
  <span class="octicon octicon-star"></span>Star
</a>
<a class="social-count js-social-count" href="/tim-salabim/metvurst/stargazers">
  8
</a>

  </li>

    <li>
      <a href="/login?return_to=%2Ftim-salabim%2Fmetvurst"
        class="minibutton with-count js-toggler-target fork-button entice tooltipped upwards"
        title="You must be signed in to fork a repository" rel="nofollow">
        <span class="octicon octicon-git-branch"></span>Fork
      </a>
      <a href="/tim-salabim/metvurst/network" class="social-count">
        4
      </a>
    </li>
</ul>

        <h1 itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="entry-title public">
          <span class="repo-label"><span>public</span></span>
          <span class="mega-octicon octicon-repo"></span>
          <span class="author">
            <a href="/tim-salabim" class="url fn" itemprop="url" rel="author"><span itemprop="title">tim-salabim</span></a></span
          ><span class="repohead-name-divider">/</span><strong
          ><a href="/tim-salabim/metvurst" class="js-current-repository js-repo-home-link">metvurst</a></strong>

          <span class="page-context-loader">
            <img alt="Octocat-spinner-32" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
          </span>

        </h1>
      </div><!-- /.container -->
    </div><!-- /.repohead -->

    <div class="container">

      <div class="repository-with-sidebar repo-container
            ">

          <div class="repository-sidebar">

              

<div class="repo-nav repo-nav-full js-repository-container-pjax js-octicon-loaders">
  <div class="repo-nav-contents">
    <ul class="repo-menu">
      <li class="tooltipped leftwards" title="Code">
        <a href="/tim-salabim/metvurst" aria-label="Code" class="js-selected-navigation-item selected" data-gotokey="c" data-pjax="true" data-selected-links="repo_source repo_downloads repo_commits repo_tags repo_branches /tim-salabim/metvurst">
          <span class="octicon octicon-code"></span> <span class="full-word">Code</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

        <li class="tooltipped leftwards" title="Issues">
          <a href="/tim-salabim/metvurst/issues" aria-label="Issues" class="js-selected-navigation-item js-disable-pjax" data-gotokey="i" data-selected-links="repo_issues /tim-salabim/metvurst/issues">
            <span class="octicon octicon-issue-opened"></span> <span class="full-word">Issues</span>
            <span class='counter'>0</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>

      <li class="tooltipped leftwards" title="Pull Requests"><a href="/tim-salabim/metvurst/pulls" aria-label="Pull Requests" class="js-selected-navigation-item js-disable-pjax" data-gotokey="p" data-selected-links="repo_pulls /tim-salabim/metvurst/pulls">
            <span class="octicon octicon-git-pull-request"></span> <span class="full-word">Pull Requests</span>
            <span class='counter'>0</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>


        <li class="tooltipped leftwards" title="Wiki">
          <a href="/tim-salabim/metvurst/wiki" aria-label="Wiki" class="js-selected-navigation-item " data-pjax="true" data-selected-links="repo_wiki /tim-salabim/metvurst/wiki">
            <span class="octicon octicon-book"></span> <span class="full-word">Wiki</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>


    </ul>
    <div class="repo-menu-separator"></div>
    <ul class="repo-menu">

      <li class="tooltipped leftwards" title="Pulse">
        <a href="/tim-salabim/metvurst/pulse" aria-label="Pulse" class="js-selected-navigation-item " data-pjax="true" data-selected-links="pulse /tim-salabim/metvurst/pulse">
          <span class="octicon octicon-pulse"></span> <span class="full-word">Pulse</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

      <li class="tooltipped leftwards" title="Graphs">
        <a href="/tim-salabim/metvurst/graphs" aria-label="Graphs" class="js-selected-navigation-item " data-pjax="true" data-selected-links="repo_graphs repo_contributors /tim-salabim/metvurst/graphs">
          <span class="octicon octicon-graph"></span> <span class="full-word">Graphs</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

      <li class="tooltipped leftwards" title="Network">
        <a href="/tim-salabim/metvurst/network" aria-label="Network" class="js-selected-navigation-item js-disable-pjax" data-selected-links="repo_network /tim-salabim/metvurst/network">
          <span class="octicon octicon-git-branch"></span> <span class="full-word">Network</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

    </ul>

  </div>
</div>


              <div class="only-with-full-nav">

                

  

<div class="clone-url open"
  data-protocol-type="http"
  data-url="/users/set_protocol?protocol_selector=http&amp;protocol_type=clone">
  <h3><strong>HTTPS</strong> clone URL</h3>

  <input type="text" class="clone js-url-field"
         value="https://github.com/tim-salabim/metvurst.git" readonly="readonly">

  <span class="js-zeroclipboard url-box-clippy minibutton zeroclipboard-button" data-clipboard-text="https://github.com/tim-salabim/metvurst.git" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
</div>

  

<div class="clone-url "
  data-protocol-type="subversion"
  data-url="/users/set_protocol?protocol_selector=subversion&amp;protocol_type=clone">
  <h3><strong>Subversion</strong> checkout URL</h3>

  <input type="text" class="clone js-url-field"
         value="https://github.com/tim-salabim/metvurst" readonly="readonly">

  <span class="js-zeroclipboard url-box-clippy minibutton zeroclipboard-button" data-clipboard-text="https://github.com/tim-salabim/metvurst" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
</div>



<p class="clone-options">You can clone with
    <a href="#" class="js-clone-selector" data-protocol="http">HTTPS</a>,
    <a href="#" class="js-clone-selector" data-protocol="subversion">Subversion</a>,
  and <a href="https://help.github.com/articles/which-remote-url-should-i-use">other methods.</a>
</p>


  <a href="http://windows.github.com" class="minibutton sidebar-button">
    <span class="octicon octicon-device-desktop"></span>
    Clone in Desktop
  </a>


                  <a href="/tim-salabim/metvurst/archive/master.zip"
                     class="minibutton sidebar-button"
                     title="Download this repository as a zip file"
                     rel="nofollow">
                    <span class="octicon octicon-cloud-download"></span>
                    Download ZIP
                  </a>

              </div>
          </div>

          <div id="js-repo-pjax-container" class="repository-content context-loader-container" data-pjax-container>
            


<!-- blob contrib key: blob_contributors:v21:77913c45a983eceab2f6497e7b051a2f -->
<!-- blob contrib frag key: views10/v8/blob_contributors:v21:77913c45a983eceab2f6497e7b051a2f -->

<p title="This is a placeholder element" class="js-history-link-replace hidden"></p>

<a href="/tim-salabim/metvurst/find/master" data-pjax data-hotkey="t" style="display:none">Show File Finder</a>

<div class="file-navigation">
  


<div class="select-menu js-menu-container js-select-menu" >
  <span class="minibutton select-menu-button js-menu-target" data-hotkey="w"
    data-master-branch="master"
    data-ref="master">
    <span class="octicon octicon-git-branch"></span>
    <i>branch:</i>
    <span class="js-select-button">master</span>
  </span>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax>

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <span class="select-menu-title">Switch branches/tags</span>
        <span class="octicon octicon-remove-close js-menu-close"></span>
      </div> <!-- /.select-menu-header -->

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" id="context-commitish-filter-field" class="js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" class="js-select-menu-tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" class="js-select-menu-tab">Tags</a>
            </li>
          </ul>
        </div><!-- /.select-menu-tabs -->
      </div><!-- /.select-menu-filters -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <div class="select-menu-item js-navigation-item ">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/tim-salabim/metvurst/blob/gh-pages/markdown/20130617_data_vis_workshop.Rmd" class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target" data-name="gh-pages" rel="nofollow" title="gh-pages">gh-pages</a>
            </div> <!-- /.select-menu-item -->
            <div class="select-menu-item js-navigation-item selected">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/tim-salabim/metvurst/blob/master/markdown/20130617_data_vis_workshop.Rmd" class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target" data-name="master" rel="nofollow" title="master">master</a>
            </div> <!-- /.select-menu-item -->
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div> <!-- /.select-menu-list -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div> <!-- /.select-menu-list -->

    </div> <!-- /.select-menu-modal -->
  </div> <!-- /.select-menu-modal-holder -->
</div> <!-- /.select-menu -->

  <div class="breadcrumb">
    <span class='repo-root js-repo-root'><span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="/tim-salabim/metvurst" data-branch="master" data-direction="back" data-pjax="true" itemscope="url"><span itemprop="title">metvurst</span></a></span></span><span class="separator"> / </span><span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="/tim-salabim/metvurst/tree/master/markdown" data-branch="master" data-direction="back" data-pjax="true" itemscope="url"><span itemprop="title">markdown</span></a></span><span class="separator"> / </span><strong class="final-path">20130617_data_vis_workshop.Rmd</strong> <span class="js-zeroclipboard minibutton zeroclipboard-button" data-clipboard-text="markdown/20130617_data_vis_workshop.Rmd" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
  </div>
</div>


  
  <div class="commit file-history-tease">
    <img class="main-avatar" height="24" src="https://secure.gravatar.com/avatar/a335dd53c85978d7faa763d14c2dd85d?s=140&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png" width="24" />
    <span class="author"><a href="/tim-salabim" rel="author">tim-salabim</a></span>
    <time class="js-relative-date" datetime="2013-07-08T08:08:25-07:00" title="2013-07-08 08:08:25">July 08, 2013</time>
    <div class="commit-title">
        <a href="/tim-salabim/metvurst/commit/61e93926f2254109a4846b8d52c41b71f513f5d1" class="message" data-pjax="true">include markdown directory for teaching demos</a>
    </div>

    <div class="participation">
      <p class="quickstat"><a href="#blob_contributors_box" rel="facebox"><strong>1</strong> contributor</a></p>
      
    </div>
    <div id="blob_contributors_box" style="display:none">
      <h2 class="facebox-header">Users who have contributed to this file</h2>
      <ul class="facebox-user-list">
        <li class="facebox-user-list-item">
          <img height="24" src="https://secure.gravatar.com/avatar/a335dd53c85978d7faa763d14c2dd85d?s=140&amp;d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png" width="24" />
          <a href="/tim-salabim">tim-salabim</a>
        </li>
      </ul>
    </div>
  </div>


<div id="files" class="bubble">
  <div class="file">
    <div class="meta">
      <div class="info">
        <span class="icon"><b class="octicon octicon-file-text"></b></span>
        <span class="mode" title="File Mode">executable file</span>
          <span>1602 lines (1120 sloc)</span>
        <span>93.624 kb</span>
      </div>
      <div class="actions">
        <div class="button-group">
              <a class="minibutton js-entice" href=""
                 data-entice="You must be signed in and on a branch to make or propose changes">Edit</a>
          <a href="/tim-salabim/metvurst/raw/master/markdown/20130617_data_vis_workshop.Rmd" class="button minibutton " id="raw-url">Raw</a>
            <a href="/tim-salabim/metvurst/blame/master/markdown/20130617_data_vis_workshop.Rmd" class="button minibutton ">Blame</a>
          <a href="/tim-salabim/metvurst/commits/master/markdown/20130617_data_vis_workshop.Rmd" class="button minibutton " rel="nofollow">History</a>
        </div><!-- /.button-group -->
            <a class="minibutton danger empty-icon js-entice" href=""
               data-entice="You must be signed in and on a branch to make or propose changes">
            Delete
          </a>
      </div><!-- /.actions -->

    </div>
        <div class="blob-wrapper data type-text js-blob-data">
      <table class="file-code file-diff">
        <tr class="file-code-line">
          <td class="blob-line-nums">
            <span id="L1" rel="#L1">1</span>
<span id="L2" rel="#L2">2</span>
<span id="L3" rel="#L3">3</span>
<span id="L4" rel="#L4">4</span>
<span id="L5" rel="#L5">5</span>
<span id="L6" rel="#L6">6</span>
<span id="L7" rel="#L7">7</span>
<span id="L8" rel="#L8">8</span>
<span id="L9" rel="#L9">9</span>
<span id="L10" rel="#L10">10</span>
<span id="L11" rel="#L11">11</span>
<span id="L12" rel="#L12">12</span>
<span id="L13" rel="#L13">13</span>
<span id="L14" rel="#L14">14</span>
<span id="L15" rel="#L15">15</span>
<span id="L16" rel="#L16">16</span>
<span id="L17" rel="#L17">17</span>
<span id="L18" rel="#L18">18</span>
<span id="L19" rel="#L19">19</span>
<span id="L20" rel="#L20">20</span>
<span id="L21" rel="#L21">21</span>
<span id="L22" rel="#L22">22</span>
<span id="L23" rel="#L23">23</span>
<span id="L24" rel="#L24">24</span>
<span id="L25" rel="#L25">25</span>
<span id="L26" rel="#L26">26</span>
<span id="L27" rel="#L27">27</span>
<span id="L28" rel="#L28">28</span>
<span id="L29" rel="#L29">29</span>
<span id="L30" rel="#L30">30</span>
<span id="L31" rel="#L31">31</span>
<span id="L32" rel="#L32">32</span>
<span id="L33" rel="#L33">33</span>
<span id="L34" rel="#L34">34</span>
<span id="L35" rel="#L35">35</span>
<span id="L36" rel="#L36">36</span>
<span id="L37" rel="#L37">37</span>
<span id="L38" rel="#L38">38</span>
<span id="L39" rel="#L39">39</span>
<span id="L40" rel="#L40">40</span>
<span id="L41" rel="#L41">41</span>
<span id="L42" rel="#L42">42</span>
<span id="L43" rel="#L43">43</span>
<span id="L44" rel="#L44">44</span>
<span id="L45" rel="#L45">45</span>
<span id="L46" rel="#L46">46</span>
<span id="L47" rel="#L47">47</span>
<span id="L48" rel="#L48">48</span>
<span id="L49" rel="#L49">49</span>
<span id="L50" rel="#L50">50</span>
<span id="L51" rel="#L51">51</span>
<span id="L52" rel="#L52">52</span>
<span id="L53" rel="#L53">53</span>
<span id="L54" rel="#L54">54</span>
<span id="L55" rel="#L55">55</span>
<span id="L56" rel="#L56">56</span>
<span id="L57" rel="#L57">57</span>
<span id="L58" rel="#L58">58</span>
<span id="L59" rel="#L59">59</span>
<span id="L60" rel="#L60">60</span>
<span id="L61" rel="#L61">61</span>
<span id="L62" rel="#L62">62</span>
<span id="L63" rel="#L63">63</span>
<span id="L64" rel="#L64">64</span>
<span id="L65" rel="#L65">65</span>
<span id="L66" rel="#L66">66</span>
<span id="L67" rel="#L67">67</span>
<span id="L68" rel="#L68">68</span>
<span id="L69" rel="#L69">69</span>
<span id="L70" rel="#L70">70</span>
<span id="L71" rel="#L71">71</span>
<span id="L72" rel="#L72">72</span>
<span id="L73" rel="#L73">73</span>
<span id="L74" rel="#L74">74</span>
<span id="L75" rel="#L75">75</span>
<span id="L76" rel="#L76">76</span>
<span id="L77" rel="#L77">77</span>
<span id="L78" rel="#L78">78</span>
<span id="L79" rel="#L79">79</span>
<span id="L80" rel="#L80">80</span>
<span id="L81" rel="#L81">81</span>
<span id="L82" rel="#L82">82</span>
<span id="L83" rel="#L83">83</span>
<span id="L84" rel="#L84">84</span>
<span id="L85" rel="#L85">85</span>
<span id="L86" rel="#L86">86</span>
<span id="L87" rel="#L87">87</span>
<span id="L88" rel="#L88">88</span>
<span id="L89" rel="#L89">89</span>
<span id="L90" rel="#L90">90</span>
<span id="L91" rel="#L91">91</span>
<span id="L92" rel="#L92">92</span>
<span id="L93" rel="#L93">93</span>
<span id="L94" rel="#L94">94</span>
<span id="L95" rel="#L95">95</span>
<span id="L96" rel="#L96">96</span>
<span id="L97" rel="#L97">97</span>
<span id="L98" rel="#L98">98</span>
<span id="L99" rel="#L99">99</span>
<span id="L100" rel="#L100">100</span>
<span id="L101" rel="#L101">101</span>
<span id="L102" rel="#L102">102</span>
<span id="L103" rel="#L103">103</span>
<span id="L104" rel="#L104">104</span>
<span id="L105" rel="#L105">105</span>
<span id="L106" rel="#L106">106</span>
<span id="L107" rel="#L107">107</span>
<span id="L108" rel="#L108">108</span>
<span id="L109" rel="#L109">109</span>
<span id="L110" rel="#L110">110</span>
<span id="L111" rel="#L111">111</span>
<span id="L112" rel="#L112">112</span>
<span id="L113" rel="#L113">113</span>
<span id="L114" rel="#L114">114</span>
<span id="L115" rel="#L115">115</span>
<span id="L116" rel="#L116">116</span>
<span id="L117" rel="#L117">117</span>
<span id="L118" rel="#L118">118</span>
<span id="L119" rel="#L119">119</span>
<span id="L120" rel="#L120">120</span>
<span id="L121" rel="#L121">121</span>
<span id="L122" rel="#L122">122</span>
<span id="L123" rel="#L123">123</span>
<span id="L124" rel="#L124">124</span>
<span id="L125" rel="#L125">125</span>
<span id="L126" rel="#L126">126</span>
<span id="L127" rel="#L127">127</span>
<span id="L128" rel="#L128">128</span>
<span id="L129" rel="#L129">129</span>
<span id="L130" rel="#L130">130</span>
<span id="L131" rel="#L131">131</span>
<span id="L132" rel="#L132">132</span>
<span id="L133" rel="#L133">133</span>
<span id="L134" rel="#L134">134</span>
<span id="L135" rel="#L135">135</span>
<span id="L136" rel="#L136">136</span>
<span id="L137" rel="#L137">137</span>
<span id="L138" rel="#L138">138</span>
<span id="L139" rel="#L139">139</span>
<span id="L140" rel="#L140">140</span>
<span id="L141" rel="#L141">141</span>
<span id="L142" rel="#L142">142</span>
<span id="L143" rel="#L143">143</span>
<span id="L144" rel="#L144">144</span>
<span id="L145" rel="#L145">145</span>
<span id="L146" rel="#L146">146</span>
<span id="L147" rel="#L147">147</span>
<span id="L148" rel="#L148">148</span>
<span id="L149" rel="#L149">149</span>
<span id="L150" rel="#L150">150</span>
<span id="L151" rel="#L151">151</span>
<span id="L152" rel="#L152">152</span>
<span id="L153" rel="#L153">153</span>
<span id="L154" rel="#L154">154</span>
<span id="L155" rel="#L155">155</span>
<span id="L156" rel="#L156">156</span>
<span id="L157" rel="#L157">157</span>
<span id="L158" rel="#L158">158</span>
<span id="L159" rel="#L159">159</span>
<span id="L160" rel="#L160">160</span>
<span id="L161" rel="#L161">161</span>
<span id="L162" rel="#L162">162</span>
<span id="L163" rel="#L163">163</span>
<span id="L164" rel="#L164">164</span>
<span id="L165" rel="#L165">165</span>
<span id="L166" rel="#L166">166</span>
<span id="L167" rel="#L167">167</span>
<span id="L168" rel="#L168">168</span>
<span id="L169" rel="#L169">169</span>
<span id="L170" rel="#L170">170</span>
<span id="L171" rel="#L171">171</span>
<span id="L172" rel="#L172">172</span>
<span id="L173" rel="#L173">173</span>
<span id="L174" rel="#L174">174</span>
<span id="L175" rel="#L175">175</span>
<span id="L176" rel="#L176">176</span>
<span id="L177" rel="#L177">177</span>
<span id="L178" rel="#L178">178</span>
<span id="L179" rel="#L179">179</span>
<span id="L180" rel="#L180">180</span>
<span id="L181" rel="#L181">181</span>
<span id="L182" rel="#L182">182</span>
<span id="L183" rel="#L183">183</span>
<span id="L184" rel="#L184">184</span>
<span id="L185" rel="#L185">185</span>
<span id="L186" rel="#L186">186</span>
<span id="L187" rel="#L187">187</span>
<span id="L188" rel="#L188">188</span>
<span id="L189" rel="#L189">189</span>
<span id="L190" rel="#L190">190</span>
<span id="L191" rel="#L191">191</span>
<span id="L192" rel="#L192">192</span>
<span id="L193" rel="#L193">193</span>
<span id="L194" rel="#L194">194</span>
<span id="L195" rel="#L195">195</span>
<span id="L196" rel="#L196">196</span>
<span id="L197" rel="#L197">197</span>
<span id="L198" rel="#L198">198</span>
<span id="L199" rel="#L199">199</span>
<span id="L200" rel="#L200">200</span>
<span id="L201" rel="#L201">201</span>
<span id="L202" rel="#L202">202</span>
<span id="L203" rel="#L203">203</span>
<span id="L204" rel="#L204">204</span>
<span id="L205" rel="#L205">205</span>
<span id="L206" rel="#L206">206</span>
<span id="L207" rel="#L207">207</span>
<span id="L208" rel="#L208">208</span>
<span id="L209" rel="#L209">209</span>
<span id="L210" rel="#L210">210</span>
<span id="L211" rel="#L211">211</span>
<span id="L212" rel="#L212">212</span>
<span id="L213" rel="#L213">213</span>
<span id="L214" rel="#L214">214</span>
<span id="L215" rel="#L215">215</span>
<span id="L216" rel="#L216">216</span>
<span id="L217" rel="#L217">217</span>
<span id="L218" rel="#L218">218</span>
<span id="L219" rel="#L219">219</span>
<span id="L220" rel="#L220">220</span>
<span id="L221" rel="#L221">221</span>
<span id="L222" rel="#L222">222</span>
<span id="L223" rel="#L223">223</span>
<span id="L224" rel="#L224">224</span>
<span id="L225" rel="#L225">225</span>
<span id="L226" rel="#L226">226</span>
<span id="L227" rel="#L227">227</span>
<span id="L228" rel="#L228">228</span>
<span id="L229" rel="#L229">229</span>
<span id="L230" rel="#L230">230</span>
<span id="L231" rel="#L231">231</span>
<span id="L232" rel="#L232">232</span>
<span id="L233" rel="#L233">233</span>
<span id="L234" rel="#L234">234</span>
<span id="L235" rel="#L235">235</span>
<span id="L236" rel="#L236">236</span>
<span id="L237" rel="#L237">237</span>
<span id="L238" rel="#L238">238</span>
<span id="L239" rel="#L239">239</span>
<span id="L240" rel="#L240">240</span>
<span id="L241" rel="#L241">241</span>
<span id="L242" rel="#L242">242</span>
<span id="L243" rel="#L243">243</span>
<span id="L244" rel="#L244">244</span>
<span id="L245" rel="#L245">245</span>
<span id="L246" rel="#L246">246</span>
<span id="L247" rel="#L247">247</span>
<span id="L248" rel="#L248">248</span>
<span id="L249" rel="#L249">249</span>
<span id="L250" rel="#L250">250</span>
<span id="L251" rel="#L251">251</span>
<span id="L252" rel="#L252">252</span>
<span id="L253" rel="#L253">253</span>
<span id="L254" rel="#L254">254</span>
<span id="L255" rel="#L255">255</span>
<span id="L256" rel="#L256">256</span>
<span id="L257" rel="#L257">257</span>
<span id="L258" rel="#L258">258</span>
<span id="L259" rel="#L259">259</span>
<span id="L260" rel="#L260">260</span>
<span id="L261" rel="#L261">261</span>
<span id="L262" rel="#L262">262</span>
<span id="L263" rel="#L263">263</span>
<span id="L264" rel="#L264">264</span>
<span id="L265" rel="#L265">265</span>
<span id="L266" rel="#L266">266</span>
<span id="L267" rel="#L267">267</span>
<span id="L268" rel="#L268">268</span>
<span id="L269" rel="#L269">269</span>
<span id="L270" rel="#L270">270</span>
<span id="L271" rel="#L271">271</span>
<span id="L272" rel="#L272">272</span>
<span id="L273" rel="#L273">273</span>
<span id="L274" rel="#L274">274</span>
<span id="L275" rel="#L275">275</span>
<span id="L276" rel="#L276">276</span>
<span id="L277" rel="#L277">277</span>
<span id="L278" rel="#L278">278</span>
<span id="L279" rel="#L279">279</span>
<span id="L280" rel="#L280">280</span>
<span id="L281" rel="#L281">281</span>
<span id="L282" rel="#L282">282</span>
<span id="L283" rel="#L283">283</span>
<span id="L284" rel="#L284">284</span>
<span id="L285" rel="#L285">285</span>
<span id="L286" rel="#L286">286</span>
<span id="L287" rel="#L287">287</span>
<span id="L288" rel="#L288">288</span>
<span id="L289" rel="#L289">289</span>
<span id="L290" rel="#L290">290</span>
<span id="L291" rel="#L291">291</span>
<span id="L292" rel="#L292">292</span>
<span id="L293" rel="#L293">293</span>
<span id="L294" rel="#L294">294</span>
<span id="L295" rel="#L295">295</span>
<span id="L296" rel="#L296">296</span>
<span id="L297" rel="#L297">297</span>
<span id="L298" rel="#L298">298</span>
<span id="L299" rel="#L299">299</span>
<span id="L300" rel="#L300">300</span>
<span id="L301" rel="#L301">301</span>
<span id="L302" rel="#L302">302</span>
<span id="L303" rel="#L303">303</span>
<span id="L304" rel="#L304">304</span>
<span id="L305" rel="#L305">305</span>
<span id="L306" rel="#L306">306</span>
<span id="L307" rel="#L307">307</span>
<span id="L308" rel="#L308">308</span>
<span id="L309" rel="#L309">309</span>
<span id="L310" rel="#L310">310</span>
<span id="L311" rel="#L311">311</span>
<span id="L312" rel="#L312">312</span>
<span id="L313" rel="#L313">313</span>
<span id="L314" rel="#L314">314</span>
<span id="L315" rel="#L315">315</span>
<span id="L316" rel="#L316">316</span>
<span id="L317" rel="#L317">317</span>
<span id="L318" rel="#L318">318</span>
<span id="L319" rel="#L319">319</span>
<span id="L320" rel="#L320">320</span>
<span id="L321" rel="#L321">321</span>
<span id="L322" rel="#L322">322</span>
<span id="L323" rel="#L323">323</span>
<span id="L324" rel="#L324">324</span>
<span id="L325" rel="#L325">325</span>
<span id="L326" rel="#L326">326</span>
<span id="L327" rel="#L327">327</span>
<span id="L328" rel="#L328">328</span>
<span id="L329" rel="#L329">329</span>
<span id="L330" rel="#L330">330</span>
<span id="L331" rel="#L331">331</span>
<span id="L332" rel="#L332">332</span>
<span id="L333" rel="#L333">333</span>
<span id="L334" rel="#L334">334</span>
<span id="L335" rel="#L335">335</span>
<span id="L336" rel="#L336">336</span>
<span id="L337" rel="#L337">337</span>
<span id="L338" rel="#L338">338</span>
<span id="L339" rel="#L339">339</span>
<span id="L340" rel="#L340">340</span>
<span id="L341" rel="#L341">341</span>
<span id="L342" rel="#L342">342</span>
<span id="L343" rel="#L343">343</span>
<span id="L344" rel="#L344">344</span>
<span id="L345" rel="#L345">345</span>
<span id="L346" rel="#L346">346</span>
<span id="L347" rel="#L347">347</span>
<span id="L348" rel="#L348">348</span>
<span id="L349" rel="#L349">349</span>
<span id="L350" rel="#L350">350</span>
<span id="L351" rel="#L351">351</span>
<span id="L352" rel="#L352">352</span>
<span id="L353" rel="#L353">353</span>
<span id="L354" rel="#L354">354</span>
<span id="L355" rel="#L355">355</span>
<span id="L356" rel="#L356">356</span>
<span id="L357" rel="#L357">357</span>
<span id="L358" rel="#L358">358</span>
<span id="L359" rel="#L359">359</span>
<span id="L360" rel="#L360">360</span>
<span id="L361" rel="#L361">361</span>
<span id="L362" rel="#L362">362</span>
<span id="L363" rel="#L363">363</span>
<span id="L364" rel="#L364">364</span>
<span id="L365" rel="#L365">365</span>
<span id="L366" rel="#L366">366</span>
<span id="L367" rel="#L367">367</span>
<span id="L368" rel="#L368">368</span>
<span id="L369" rel="#L369">369</span>
<span id="L370" rel="#L370">370</span>
<span id="L371" rel="#L371">371</span>
<span id="L372" rel="#L372">372</span>
<span id="L373" rel="#L373">373</span>
<span id="L374" rel="#L374">374</span>
<span id="L375" rel="#L375">375</span>
<span id="L376" rel="#L376">376</span>
<span id="L377" rel="#L377">377</span>
<span id="L378" rel="#L378">378</span>
<span id="L379" rel="#L379">379</span>
<span id="L380" rel="#L380">380</span>
<span id="L381" rel="#L381">381</span>
<span id="L382" rel="#L382">382</span>
<span id="L383" rel="#L383">383</span>
<span id="L384" rel="#L384">384</span>
<span id="L385" rel="#L385">385</span>
<span id="L386" rel="#L386">386</span>
<span id="L387" rel="#L387">387</span>
<span id="L388" rel="#L388">388</span>
<span id="L389" rel="#L389">389</span>
<span id="L390" rel="#L390">390</span>
<span id="L391" rel="#L391">391</span>
<span id="L392" rel="#L392">392</span>
<span id="L393" rel="#L393">393</span>
<span id="L394" rel="#L394">394</span>
<span id="L395" rel="#L395">395</span>
<span id="L396" rel="#L396">396</span>
<span id="L397" rel="#L397">397</span>
<span id="L398" rel="#L398">398</span>
<span id="L399" rel="#L399">399</span>
<span id="L400" rel="#L400">400</span>
<span id="L401" rel="#L401">401</span>
<span id="L402" rel="#L402">402</span>
<span id="L403" rel="#L403">403</span>
<span id="L404" rel="#L404">404</span>
<span id="L405" rel="#L405">405</span>
<span id="L406" rel="#L406">406</span>
<span id="L407" rel="#L407">407</span>
<span id="L408" rel="#L408">408</span>
<span id="L409" rel="#L409">409</span>
<span id="L410" rel="#L410">410</span>
<span id="L411" rel="#L411">411</span>
<span id="L412" rel="#L412">412</span>
<span id="L413" rel="#L413">413</span>
<span id="L414" rel="#L414">414</span>
<span id="L415" rel="#L415">415</span>
<span id="L416" rel="#L416">416</span>
<span id="L417" rel="#L417">417</span>
<span id="L418" rel="#L418">418</span>
<span id="L419" rel="#L419">419</span>
<span id="L420" rel="#L420">420</span>
<span id="L421" rel="#L421">421</span>
<span id="L422" rel="#L422">422</span>
<span id="L423" rel="#L423">423</span>
<span id="L424" rel="#L424">424</span>
<span id="L425" rel="#L425">425</span>
<span id="L426" rel="#L426">426</span>
<span id="L427" rel="#L427">427</span>
<span id="L428" rel="#L428">428</span>
<span id="L429" rel="#L429">429</span>
<span id="L430" rel="#L430">430</span>
<span id="L431" rel="#L431">431</span>
<span id="L432" rel="#L432">432</span>
<span id="L433" rel="#L433">433</span>
<span id="L434" rel="#L434">434</span>
<span id="L435" rel="#L435">435</span>
<span id="L436" rel="#L436">436</span>
<span id="L437" rel="#L437">437</span>
<span id="L438" rel="#L438">438</span>
<span id="L439" rel="#L439">439</span>
<span id="L440" rel="#L440">440</span>
<span id="L441" rel="#L441">441</span>
<span id="L442" rel="#L442">442</span>
<span id="L443" rel="#L443">443</span>
<span id="L444" rel="#L444">444</span>
<span id="L445" rel="#L445">445</span>
<span id="L446" rel="#L446">446</span>
<span id="L447" rel="#L447">447</span>
<span id="L448" rel="#L448">448</span>
<span id="L449" rel="#L449">449</span>
<span id="L450" rel="#L450">450</span>
<span id="L451" rel="#L451">451</span>
<span id="L452" rel="#L452">452</span>
<span id="L453" rel="#L453">453</span>
<span id="L454" rel="#L454">454</span>
<span id="L455" rel="#L455">455</span>
<span id="L456" rel="#L456">456</span>
<span id="L457" rel="#L457">457</span>
<span id="L458" rel="#L458">458</span>
<span id="L459" rel="#L459">459</span>
<span id="L460" rel="#L460">460</span>
<span id="L461" rel="#L461">461</span>
<span id="L462" rel="#L462">462</span>
<span id="L463" rel="#L463">463</span>
<span id="L464" rel="#L464">464</span>
<span id="L465" rel="#L465">465</span>
<span id="L466" rel="#L466">466</span>
<span id="L467" rel="#L467">467</span>
<span id="L468" rel="#L468">468</span>
<span id="L469" rel="#L469">469</span>
<span id="L470" rel="#L470">470</span>
<span id="L471" rel="#L471">471</span>
<span id="L472" rel="#L472">472</span>
<span id="L473" rel="#L473">473</span>
<span id="L474" rel="#L474">474</span>
<span id="L475" rel="#L475">475</span>
<span id="L476" rel="#L476">476</span>
<span id="L477" rel="#L477">477</span>
<span id="L478" rel="#L478">478</span>
<span id="L479" rel="#L479">479</span>
<span id="L480" rel="#L480">480</span>
<span id="L481" rel="#L481">481</span>
<span id="L482" rel="#L482">482</span>
<span id="L483" rel="#L483">483</span>
<span id="L484" rel="#L484">484</span>
<span id="L485" rel="#L485">485</span>
<span id="L486" rel="#L486">486</span>
<span id="L487" rel="#L487">487</span>
<span id="L488" rel="#L488">488</span>
<span id="L489" rel="#L489">489</span>
<span id="L490" rel="#L490">490</span>
<span id="L491" rel="#L491">491</span>
<span id="L492" rel="#L492">492</span>
<span id="L493" rel="#L493">493</span>
<span id="L494" rel="#L494">494</span>
<span id="L495" rel="#L495">495</span>
<span id="L496" rel="#L496">496</span>
<span id="L497" rel="#L497">497</span>
<span id="L498" rel="#L498">498</span>
<span id="L499" rel="#L499">499</span>
<span id="L500" rel="#L500">500</span>
<span id="L501" rel="#L501">501</span>
<span id="L502" rel="#L502">502</span>
<span id="L503" rel="#L503">503</span>
<span id="L504" rel="#L504">504</span>
<span id="L505" rel="#L505">505</span>
<span id="L506" rel="#L506">506</span>
<span id="L507" rel="#L507">507</span>
<span id="L508" rel="#L508">508</span>
<span id="L509" rel="#L509">509</span>
<span id="L510" rel="#L510">510</span>
<span id="L511" rel="#L511">511</span>
<span id="L512" rel="#L512">512</span>
<span id="L513" rel="#L513">513</span>
<span id="L514" rel="#L514">514</span>
<span id="L515" rel="#L515">515</span>
<span id="L516" rel="#L516">516</span>
<span id="L517" rel="#L517">517</span>
<span id="L518" rel="#L518">518</span>
<span id="L519" rel="#L519">519</span>
<span id="L520" rel="#L520">520</span>
<span id="L521" rel="#L521">521</span>
<span id="L522" rel="#L522">522</span>
<span id="L523" rel="#L523">523</span>
<span id="L524" rel="#L524">524</span>
<span id="L525" rel="#L525">525</span>
<span id="L526" rel="#L526">526</span>
<span id="L527" rel="#L527">527</span>
<span id="L528" rel="#L528">528</span>
<span id="L529" rel="#L529">529</span>
<span id="L530" rel="#L530">530</span>
<span id="L531" rel="#L531">531</span>
<span id="L532" rel="#L532">532</span>
<span id="L533" rel="#L533">533</span>
<span id="L534" rel="#L534">534</span>
<span id="L535" rel="#L535">535</span>
<span id="L536" rel="#L536">536</span>
<span id="L537" rel="#L537">537</span>
<span id="L538" rel="#L538">538</span>
<span id="L539" rel="#L539">539</span>
<span id="L540" rel="#L540">540</span>
<span id="L541" rel="#L541">541</span>
<span id="L542" rel="#L542">542</span>
<span id="L543" rel="#L543">543</span>
<span id="L544" rel="#L544">544</span>
<span id="L545" rel="#L545">545</span>
<span id="L546" rel="#L546">546</span>
<span id="L547" rel="#L547">547</span>
<span id="L548" rel="#L548">548</span>
<span id="L549" rel="#L549">549</span>
<span id="L550" rel="#L550">550</span>
<span id="L551" rel="#L551">551</span>
<span id="L552" rel="#L552">552</span>
<span id="L553" rel="#L553">553</span>
<span id="L554" rel="#L554">554</span>
<span id="L555" rel="#L555">555</span>
<span id="L556" rel="#L556">556</span>
<span id="L557" rel="#L557">557</span>
<span id="L558" rel="#L558">558</span>
<span id="L559" rel="#L559">559</span>
<span id="L560" rel="#L560">560</span>
<span id="L561" rel="#L561">561</span>
<span id="L562" rel="#L562">562</span>
<span id="L563" rel="#L563">563</span>
<span id="L564" rel="#L564">564</span>
<span id="L565" rel="#L565">565</span>
<span id="L566" rel="#L566">566</span>
<span id="L567" rel="#L567">567</span>
<span id="L568" rel="#L568">568</span>
<span id="L569" rel="#L569">569</span>
<span id="L570" rel="#L570">570</span>
<span id="L571" rel="#L571">571</span>
<span id="L572" rel="#L572">572</span>
<span id="L573" rel="#L573">573</span>
<span id="L574" rel="#L574">574</span>
<span id="L575" rel="#L575">575</span>
<span id="L576" rel="#L576">576</span>
<span id="L577" rel="#L577">577</span>
<span id="L578" rel="#L578">578</span>
<span id="L579" rel="#L579">579</span>
<span id="L580" rel="#L580">580</span>
<span id="L581" rel="#L581">581</span>
<span id="L582" rel="#L582">582</span>
<span id="L583" rel="#L583">583</span>
<span id="L584" rel="#L584">584</span>
<span id="L585" rel="#L585">585</span>
<span id="L586" rel="#L586">586</span>
<span id="L587" rel="#L587">587</span>
<span id="L588" rel="#L588">588</span>
<span id="L589" rel="#L589">589</span>
<span id="L590" rel="#L590">590</span>
<span id="L591" rel="#L591">591</span>
<span id="L592" rel="#L592">592</span>
<span id="L593" rel="#L593">593</span>
<span id="L594" rel="#L594">594</span>
<span id="L595" rel="#L595">595</span>
<span id="L596" rel="#L596">596</span>
<span id="L597" rel="#L597">597</span>
<span id="L598" rel="#L598">598</span>
<span id="L599" rel="#L599">599</span>
<span id="L600" rel="#L600">600</span>
<span id="L601" rel="#L601">601</span>
<span id="L602" rel="#L602">602</span>
<span id="L603" rel="#L603">603</span>
<span id="L604" rel="#L604">604</span>
<span id="L605" rel="#L605">605</span>
<span id="L606" rel="#L606">606</span>
<span id="L607" rel="#L607">607</span>
<span id="L608" rel="#L608">608</span>
<span id="L609" rel="#L609">609</span>
<span id="L610" rel="#L610">610</span>
<span id="L611" rel="#L611">611</span>
<span id="L612" rel="#L612">612</span>
<span id="L613" rel="#L613">613</span>
<span id="L614" rel="#L614">614</span>
<span id="L615" rel="#L615">615</span>
<span id="L616" rel="#L616">616</span>
<span id="L617" rel="#L617">617</span>
<span id="L618" rel="#L618">618</span>
<span id="L619" rel="#L619">619</span>
<span id="L620" rel="#L620">620</span>
<span id="L621" rel="#L621">621</span>
<span id="L622" rel="#L622">622</span>
<span id="L623" rel="#L623">623</span>
<span id="L624" rel="#L624">624</span>
<span id="L625" rel="#L625">625</span>
<span id="L626" rel="#L626">626</span>
<span id="L627" rel="#L627">627</span>
<span id="L628" rel="#L628">628</span>
<span id="L629" rel="#L629">629</span>
<span id="L630" rel="#L630">630</span>
<span id="L631" rel="#L631">631</span>
<span id="L632" rel="#L632">632</span>
<span id="L633" rel="#L633">633</span>
<span id="L634" rel="#L634">634</span>
<span id="L635" rel="#L635">635</span>
<span id="L636" rel="#L636">636</span>
<span id="L637" rel="#L637">637</span>
<span id="L638" rel="#L638">638</span>
<span id="L639" rel="#L639">639</span>
<span id="L640" rel="#L640">640</span>
<span id="L641" rel="#L641">641</span>
<span id="L642" rel="#L642">642</span>
<span id="L643" rel="#L643">643</span>
<span id="L644" rel="#L644">644</span>
<span id="L645" rel="#L645">645</span>
<span id="L646" rel="#L646">646</span>
<span id="L647" rel="#L647">647</span>
<span id="L648" rel="#L648">648</span>
<span id="L649" rel="#L649">649</span>
<span id="L650" rel="#L650">650</span>
<span id="L651" rel="#L651">651</span>
<span id="L652" rel="#L652">652</span>
<span id="L653" rel="#L653">653</span>
<span id="L654" rel="#L654">654</span>
<span id="L655" rel="#L655">655</span>
<span id="L656" rel="#L656">656</span>
<span id="L657" rel="#L657">657</span>
<span id="L658" rel="#L658">658</span>
<span id="L659" rel="#L659">659</span>
<span id="L660" rel="#L660">660</span>
<span id="L661" rel="#L661">661</span>
<span id="L662" rel="#L662">662</span>
<span id="L663" rel="#L663">663</span>
<span id="L664" rel="#L664">664</span>
<span id="L665" rel="#L665">665</span>
<span id="L666" rel="#L666">666</span>
<span id="L667" rel="#L667">667</span>
<span id="L668" rel="#L668">668</span>
<span id="L669" rel="#L669">669</span>
<span id="L670" rel="#L670">670</span>
<span id="L671" rel="#L671">671</span>
<span id="L672" rel="#L672">672</span>
<span id="L673" rel="#L673">673</span>
<span id="L674" rel="#L674">674</span>
<span id="L675" rel="#L675">675</span>
<span id="L676" rel="#L676">676</span>
<span id="L677" rel="#L677">677</span>
<span id="L678" rel="#L678">678</span>
<span id="L679" rel="#L679">679</span>
<span id="L680" rel="#L680">680</span>
<span id="L681" rel="#L681">681</span>
<span id="L682" rel="#L682">682</span>
<span id="L683" rel="#L683">683</span>
<span id="L684" rel="#L684">684</span>
<span id="L685" rel="#L685">685</span>
<span id="L686" rel="#L686">686</span>
<span id="L687" rel="#L687">687</span>
<span id="L688" rel="#L688">688</span>
<span id="L689" rel="#L689">689</span>
<span id="L690" rel="#L690">690</span>
<span id="L691" rel="#L691">691</span>
<span id="L692" rel="#L692">692</span>
<span id="L693" rel="#L693">693</span>
<span id="L694" rel="#L694">694</span>
<span id="L695" rel="#L695">695</span>
<span id="L696" rel="#L696">696</span>
<span id="L697" rel="#L697">697</span>
<span id="L698" rel="#L698">698</span>
<span id="L699" rel="#L699">699</span>
<span id="L700" rel="#L700">700</span>
<span id="L701" rel="#L701">701</span>
<span id="L702" rel="#L702">702</span>
<span id="L703" rel="#L703">703</span>
<span id="L704" rel="#L704">704</span>
<span id="L705" rel="#L705">705</span>
<span id="L706" rel="#L706">706</span>
<span id="L707" rel="#L707">707</span>
<span id="L708" rel="#L708">708</span>
<span id="L709" rel="#L709">709</span>
<span id="L710" rel="#L710">710</span>
<span id="L711" rel="#L711">711</span>
<span id="L712" rel="#L712">712</span>
<span id="L713" rel="#L713">713</span>
<span id="L714" rel="#L714">714</span>
<span id="L715" rel="#L715">715</span>
<span id="L716" rel="#L716">716</span>
<span id="L717" rel="#L717">717</span>
<span id="L718" rel="#L718">718</span>
<span id="L719" rel="#L719">719</span>
<span id="L720" rel="#L720">720</span>
<span id="L721" rel="#L721">721</span>
<span id="L722" rel="#L722">722</span>
<span id="L723" rel="#L723">723</span>
<span id="L724" rel="#L724">724</span>
<span id="L725" rel="#L725">725</span>
<span id="L726" rel="#L726">726</span>
<span id="L727" rel="#L727">727</span>
<span id="L728" rel="#L728">728</span>
<span id="L729" rel="#L729">729</span>
<span id="L730" rel="#L730">730</span>
<span id="L731" rel="#L731">731</span>
<span id="L732" rel="#L732">732</span>
<span id="L733" rel="#L733">733</span>
<span id="L734" rel="#L734">734</span>
<span id="L735" rel="#L735">735</span>
<span id="L736" rel="#L736">736</span>
<span id="L737" rel="#L737">737</span>
<span id="L738" rel="#L738">738</span>
<span id="L739" rel="#L739">739</span>
<span id="L740" rel="#L740">740</span>
<span id="L741" rel="#L741">741</span>
<span id="L742" rel="#L742">742</span>
<span id="L743" rel="#L743">743</span>
<span id="L744" rel="#L744">744</span>
<span id="L745" rel="#L745">745</span>
<span id="L746" rel="#L746">746</span>
<span id="L747" rel="#L747">747</span>
<span id="L748" rel="#L748">748</span>
<span id="L749" rel="#L749">749</span>
<span id="L750" rel="#L750">750</span>
<span id="L751" rel="#L751">751</span>
<span id="L752" rel="#L752">752</span>
<span id="L753" rel="#L753">753</span>
<span id="L754" rel="#L754">754</span>
<span id="L755" rel="#L755">755</span>
<span id="L756" rel="#L756">756</span>
<span id="L757" rel="#L757">757</span>
<span id="L758" rel="#L758">758</span>
<span id="L759" rel="#L759">759</span>
<span id="L760" rel="#L760">760</span>
<span id="L761" rel="#L761">761</span>
<span id="L762" rel="#L762">762</span>
<span id="L763" rel="#L763">763</span>
<span id="L764" rel="#L764">764</span>
<span id="L765" rel="#L765">765</span>
<span id="L766" rel="#L766">766</span>
<span id="L767" rel="#L767">767</span>
<span id="L768" rel="#L768">768</span>
<span id="L769" rel="#L769">769</span>
<span id="L770" rel="#L770">770</span>
<span id="L771" rel="#L771">771</span>
<span id="L772" rel="#L772">772</span>
<span id="L773" rel="#L773">773</span>
<span id="L774" rel="#L774">774</span>
<span id="L775" rel="#L775">775</span>
<span id="L776" rel="#L776">776</span>
<span id="L777" rel="#L777">777</span>
<span id="L778" rel="#L778">778</span>
<span id="L779" rel="#L779">779</span>
<span id="L780" rel="#L780">780</span>
<span id="L781" rel="#L781">781</span>
<span id="L782" rel="#L782">782</span>
<span id="L783" rel="#L783">783</span>
<span id="L784" rel="#L784">784</span>
<span id="L785" rel="#L785">785</span>
<span id="L786" rel="#L786">786</span>
<span id="L787" rel="#L787">787</span>
<span id="L788" rel="#L788">788</span>
<span id="L789" rel="#L789">789</span>
<span id="L790" rel="#L790">790</span>
<span id="L791" rel="#L791">791</span>
<span id="L792" rel="#L792">792</span>
<span id="L793" rel="#L793">793</span>
<span id="L794" rel="#L794">794</span>
<span id="L795" rel="#L795">795</span>
<span id="L796" rel="#L796">796</span>
<span id="L797" rel="#L797">797</span>
<span id="L798" rel="#L798">798</span>
<span id="L799" rel="#L799">799</span>
<span id="L800" rel="#L800">800</span>
<span id="L801" rel="#L801">801</span>
<span id="L802" rel="#L802">802</span>
<span id="L803" rel="#L803">803</span>
<span id="L804" rel="#L804">804</span>
<span id="L805" rel="#L805">805</span>
<span id="L806" rel="#L806">806</span>
<span id="L807" rel="#L807">807</span>
<span id="L808" rel="#L808">808</span>
<span id="L809" rel="#L809">809</span>
<span id="L810" rel="#L810">810</span>
<span id="L811" rel="#L811">811</span>
<span id="L812" rel="#L812">812</span>
<span id="L813" rel="#L813">813</span>
<span id="L814" rel="#L814">814</span>
<span id="L815" rel="#L815">815</span>
<span id="L816" rel="#L816">816</span>
<span id="L817" rel="#L817">817</span>
<span id="L818" rel="#L818">818</span>
<span id="L819" rel="#L819">819</span>
<span id="L820" rel="#L820">820</span>
<span id="L821" rel="#L821">821</span>
<span id="L822" rel="#L822">822</span>
<span id="L823" rel="#L823">823</span>
<span id="L824" rel="#L824">824</span>
<span id="L825" rel="#L825">825</span>
<span id="L826" rel="#L826">826</span>
<span id="L827" rel="#L827">827</span>
<span id="L828" rel="#L828">828</span>
<span id="L829" rel="#L829">829</span>
<span id="L830" rel="#L830">830</span>
<span id="L831" rel="#L831">831</span>
<span id="L832" rel="#L832">832</span>
<span id="L833" rel="#L833">833</span>
<span id="L834" rel="#L834">834</span>
<span id="L835" rel="#L835">835</span>
<span id="L836" rel="#L836">836</span>
<span id="L837" rel="#L837">837</span>
<span id="L838" rel="#L838">838</span>
<span id="L839" rel="#L839">839</span>
<span id="L840" rel="#L840">840</span>
<span id="L841" rel="#L841">841</span>
<span id="L842" rel="#L842">842</span>
<span id="L843" rel="#L843">843</span>
<span id="L844" rel="#L844">844</span>
<span id="L845" rel="#L845">845</span>
<span id="L846" rel="#L846">846</span>
<span id="L847" rel="#L847">847</span>
<span id="L848" rel="#L848">848</span>
<span id="L849" rel="#L849">849</span>
<span id="L850" rel="#L850">850</span>
<span id="L851" rel="#L851">851</span>
<span id="L852" rel="#L852">852</span>
<span id="L853" rel="#L853">853</span>
<span id="L854" rel="#L854">854</span>
<span id="L855" rel="#L855">855</span>
<span id="L856" rel="#L856">856</span>
<span id="L857" rel="#L857">857</span>
<span id="L858" rel="#L858">858</span>
<span id="L859" rel="#L859">859</span>
<span id="L860" rel="#L860">860</span>
<span id="L861" rel="#L861">861</span>
<span id="L862" rel="#L862">862</span>
<span id="L863" rel="#L863">863</span>
<span id="L864" rel="#L864">864</span>
<span id="L865" rel="#L865">865</span>
<span id="L866" rel="#L866">866</span>
<span id="L867" rel="#L867">867</span>
<span id="L868" rel="#L868">868</span>
<span id="L869" rel="#L869">869</span>
<span id="L870" rel="#L870">870</span>
<span id="L871" rel="#L871">871</span>
<span id="L872" rel="#L872">872</span>
<span id="L873" rel="#L873">873</span>
<span id="L874" rel="#L874">874</span>
<span id="L875" rel="#L875">875</span>
<span id="L876" rel="#L876">876</span>
<span id="L877" rel="#L877">877</span>
<span id="L878" rel="#L878">878</span>
<span id="L879" rel="#L879">879</span>
<span id="L880" rel="#L880">880</span>
<span id="L881" rel="#L881">881</span>
<span id="L882" rel="#L882">882</span>
<span id="L883" rel="#L883">883</span>
<span id="L884" rel="#L884">884</span>
<span id="L885" rel="#L885">885</span>
<span id="L886" rel="#L886">886</span>
<span id="L887" rel="#L887">887</span>
<span id="L888" rel="#L888">888</span>
<span id="L889" rel="#L889">889</span>
<span id="L890" rel="#L890">890</span>
<span id="L891" rel="#L891">891</span>
<span id="L892" rel="#L892">892</span>
<span id="L893" rel="#L893">893</span>
<span id="L894" rel="#L894">894</span>
<span id="L895" rel="#L895">895</span>
<span id="L896" rel="#L896">896</span>
<span id="L897" rel="#L897">897</span>
<span id="L898" rel="#L898">898</span>
<span id="L899" rel="#L899">899</span>
<span id="L900" rel="#L900">900</span>
<span id="L901" rel="#L901">901</span>
<span id="L902" rel="#L902">902</span>
<span id="L903" rel="#L903">903</span>
<span id="L904" rel="#L904">904</span>
<span id="L905" rel="#L905">905</span>
<span id="L906" rel="#L906">906</span>
<span id="L907" rel="#L907">907</span>
<span id="L908" rel="#L908">908</span>
<span id="L909" rel="#L909">909</span>
<span id="L910" rel="#L910">910</span>
<span id="L911" rel="#L911">911</span>
<span id="L912" rel="#L912">912</span>
<span id="L913" rel="#L913">913</span>
<span id="L914" rel="#L914">914</span>
<span id="L915" rel="#L915">915</span>
<span id="L916" rel="#L916">916</span>
<span id="L917" rel="#L917">917</span>
<span id="L918" rel="#L918">918</span>
<span id="L919" rel="#L919">919</span>
<span id="L920" rel="#L920">920</span>
<span id="L921" rel="#L921">921</span>
<span id="L922" rel="#L922">922</span>
<span id="L923" rel="#L923">923</span>
<span id="L924" rel="#L924">924</span>
<span id="L925" rel="#L925">925</span>
<span id="L926" rel="#L926">926</span>
<span id="L927" rel="#L927">927</span>
<span id="L928" rel="#L928">928</span>
<span id="L929" rel="#L929">929</span>
<span id="L930" rel="#L930">930</span>
<span id="L931" rel="#L931">931</span>
<span id="L932" rel="#L932">932</span>
<span id="L933" rel="#L933">933</span>
<span id="L934" rel="#L934">934</span>
<span id="L935" rel="#L935">935</span>
<span id="L936" rel="#L936">936</span>
<span id="L937" rel="#L937">937</span>
<span id="L938" rel="#L938">938</span>
<span id="L939" rel="#L939">939</span>
<span id="L940" rel="#L940">940</span>
<span id="L941" rel="#L941">941</span>
<span id="L942" rel="#L942">942</span>
<span id="L943" rel="#L943">943</span>
<span id="L944" rel="#L944">944</span>
<span id="L945" rel="#L945">945</span>
<span id="L946" rel="#L946">946</span>
<span id="L947" rel="#L947">947</span>
<span id="L948" rel="#L948">948</span>
<span id="L949" rel="#L949">949</span>
<span id="L950" rel="#L950">950</span>
<span id="L951" rel="#L951">951</span>
<span id="L952" rel="#L952">952</span>
<span id="L953" rel="#L953">953</span>
<span id="L954" rel="#L954">954</span>
<span id="L955" rel="#L955">955</span>
<span id="L956" rel="#L956">956</span>
<span id="L957" rel="#L957">957</span>
<span id="L958" rel="#L958">958</span>
<span id="L959" rel="#L959">959</span>
<span id="L960" rel="#L960">960</span>
<span id="L961" rel="#L961">961</span>
<span id="L962" rel="#L962">962</span>
<span id="L963" rel="#L963">963</span>
<span id="L964" rel="#L964">964</span>
<span id="L965" rel="#L965">965</span>
<span id="L966" rel="#L966">966</span>
<span id="L967" rel="#L967">967</span>
<span id="L968" rel="#L968">968</span>
<span id="L969" rel="#L969">969</span>
<span id="L970" rel="#L970">970</span>
<span id="L971" rel="#L971">971</span>
<span id="L972" rel="#L972">972</span>
<span id="L973" rel="#L973">973</span>
<span id="L974" rel="#L974">974</span>
<span id="L975" rel="#L975">975</span>
<span id="L976" rel="#L976">976</span>
<span id="L977" rel="#L977">977</span>
<span id="L978" rel="#L978">978</span>
<span id="L979" rel="#L979">979</span>
<span id="L980" rel="#L980">980</span>
<span id="L981" rel="#L981">981</span>
<span id="L982" rel="#L982">982</span>
<span id="L983" rel="#L983">983</span>
<span id="L984" rel="#L984">984</span>
<span id="L985" rel="#L985">985</span>
<span id="L986" rel="#L986">986</span>
<span id="L987" rel="#L987">987</span>
<span id="L988" rel="#L988">988</span>
<span id="L989" rel="#L989">989</span>
<span id="L990" rel="#L990">990</span>
<span id="L991" rel="#L991">991</span>
<span id="L992" rel="#L992">992</span>
<span id="L993" rel="#L993">993</span>
<span id="L994" rel="#L994">994</span>
<span id="L995" rel="#L995">995</span>
<span id="L996" rel="#L996">996</span>
<span id="L997" rel="#L997">997</span>
<span id="L998" rel="#L998">998</span>
<span id="L999" rel="#L999">999</span>
<span id="L1000" rel="#L1000">1000</span>
<span id="L1001" rel="#L1001">1001</span>
<span id="L1002" rel="#L1002">1002</span>
<span id="L1003" rel="#L1003">1003</span>
<span id="L1004" rel="#L1004">1004</span>
<span id="L1005" rel="#L1005">1005</span>
<span id="L1006" rel="#L1006">1006</span>
<span id="L1007" rel="#L1007">1007</span>
<span id="L1008" rel="#L1008">1008</span>
<span id="L1009" rel="#L1009">1009</span>
<span id="L1010" rel="#L1010">1010</span>
<span id="L1011" rel="#L1011">1011</span>
<span id="L1012" rel="#L1012">1012</span>
<span id="L1013" rel="#L1013">1013</span>
<span id="L1014" rel="#L1014">1014</span>
<span id="L1015" rel="#L1015">1015</span>
<span id="L1016" rel="#L1016">1016</span>
<span id="L1017" rel="#L1017">1017</span>
<span id="L1018" rel="#L1018">1018</span>
<span id="L1019" rel="#L1019">1019</span>
<span id="L1020" rel="#L1020">1020</span>
<span id="L1021" rel="#L1021">1021</span>
<span id="L1022" rel="#L1022">1022</span>
<span id="L1023" rel="#L1023">1023</span>
<span id="L1024" rel="#L1024">1024</span>
<span id="L1025" rel="#L1025">1025</span>
<span id="L1026" rel="#L1026">1026</span>
<span id="L1027" rel="#L1027">1027</span>
<span id="L1028" rel="#L1028">1028</span>
<span id="L1029" rel="#L1029">1029</span>
<span id="L1030" rel="#L1030">1030</span>
<span id="L1031" rel="#L1031">1031</span>
<span id="L1032" rel="#L1032">1032</span>
<span id="L1033" rel="#L1033">1033</span>
<span id="L1034" rel="#L1034">1034</span>
<span id="L1035" rel="#L1035">1035</span>
<span id="L1036" rel="#L1036">1036</span>
<span id="L1037" rel="#L1037">1037</span>
<span id="L1038" rel="#L1038">1038</span>
<span id="L1039" rel="#L1039">1039</span>
<span id="L1040" rel="#L1040">1040</span>
<span id="L1041" rel="#L1041">1041</span>
<span id="L1042" rel="#L1042">1042</span>
<span id="L1043" rel="#L1043">1043</span>
<span id="L1044" rel="#L1044">1044</span>
<span id="L1045" rel="#L1045">1045</span>
<span id="L1046" rel="#L1046">1046</span>
<span id="L1047" rel="#L1047">1047</span>
<span id="L1048" rel="#L1048">1048</span>
<span id="L1049" rel="#L1049">1049</span>
<span id="L1050" rel="#L1050">1050</span>
<span id="L1051" rel="#L1051">1051</span>
<span id="L1052" rel="#L1052">1052</span>
<span id="L1053" rel="#L1053">1053</span>
<span id="L1054" rel="#L1054">1054</span>
<span id="L1055" rel="#L1055">1055</span>
<span id="L1056" rel="#L1056">1056</span>
<span id="L1057" rel="#L1057">1057</span>
<span id="L1058" rel="#L1058">1058</span>
<span id="L1059" rel="#L1059">1059</span>
<span id="L1060" rel="#L1060">1060</span>
<span id="L1061" rel="#L1061">1061</span>
<span id="L1062" rel="#L1062">1062</span>
<span id="L1063" rel="#L1063">1063</span>
<span id="L1064" rel="#L1064">1064</span>
<span id="L1065" rel="#L1065">1065</span>
<span id="L1066" rel="#L1066">1066</span>
<span id="L1067" rel="#L1067">1067</span>
<span id="L1068" rel="#L1068">1068</span>
<span id="L1069" rel="#L1069">1069</span>
<span id="L1070" rel="#L1070">1070</span>
<span id="L1071" rel="#L1071">1071</span>
<span id="L1072" rel="#L1072">1072</span>
<span id="L1073" rel="#L1073">1073</span>
<span id="L1074" rel="#L1074">1074</span>
<span id="L1075" rel="#L1075">1075</span>
<span id="L1076" rel="#L1076">1076</span>
<span id="L1077" rel="#L1077">1077</span>
<span id="L1078" rel="#L1078">1078</span>
<span id="L1079" rel="#L1079">1079</span>
<span id="L1080" rel="#L1080">1080</span>
<span id="L1081" rel="#L1081">1081</span>
<span id="L1082" rel="#L1082">1082</span>
<span id="L1083" rel="#L1083">1083</span>
<span id="L1084" rel="#L1084">1084</span>
<span id="L1085" rel="#L1085">1085</span>
<span id="L1086" rel="#L1086">1086</span>
<span id="L1087" rel="#L1087">1087</span>
<span id="L1088" rel="#L1088">1088</span>
<span id="L1089" rel="#L1089">1089</span>
<span id="L1090" rel="#L1090">1090</span>
<span id="L1091" rel="#L1091">1091</span>
<span id="L1092" rel="#L1092">1092</span>
<span id="L1093" rel="#L1093">1093</span>
<span id="L1094" rel="#L1094">1094</span>
<span id="L1095" rel="#L1095">1095</span>
<span id="L1096" rel="#L1096">1096</span>
<span id="L1097" rel="#L1097">1097</span>
<span id="L1098" rel="#L1098">1098</span>
<span id="L1099" rel="#L1099">1099</span>
<span id="L1100" rel="#L1100">1100</span>
<span id="L1101" rel="#L1101">1101</span>
<span id="L1102" rel="#L1102">1102</span>
<span id="L1103" rel="#L1103">1103</span>
<span id="L1104" rel="#L1104">1104</span>
<span id="L1105" rel="#L1105">1105</span>
<span id="L1106" rel="#L1106">1106</span>
<span id="L1107" rel="#L1107">1107</span>
<span id="L1108" rel="#L1108">1108</span>
<span id="L1109" rel="#L1109">1109</span>
<span id="L1110" rel="#L1110">1110</span>
<span id="L1111" rel="#L1111">1111</span>
<span id="L1112" rel="#L1112">1112</span>
<span id="L1113" rel="#L1113">1113</span>
<span id="L1114" rel="#L1114">1114</span>
<span id="L1115" rel="#L1115">1115</span>
<span id="L1116" rel="#L1116">1116</span>
<span id="L1117" rel="#L1117">1117</span>
<span id="L1118" rel="#L1118">1118</span>
<span id="L1119" rel="#L1119">1119</span>
<span id="L1120" rel="#L1120">1120</span>
<span id="L1121" rel="#L1121">1121</span>
<span id="L1122" rel="#L1122">1122</span>
<span id="L1123" rel="#L1123">1123</span>
<span id="L1124" rel="#L1124">1124</span>
<span id="L1125" rel="#L1125">1125</span>
<span id="L1126" rel="#L1126">1126</span>
<span id="L1127" rel="#L1127">1127</span>
<span id="L1128" rel="#L1128">1128</span>
<span id="L1129" rel="#L1129">1129</span>
<span id="L1130" rel="#L1130">1130</span>
<span id="L1131" rel="#L1131">1131</span>
<span id="L1132" rel="#L1132">1132</span>
<span id="L1133" rel="#L1133">1133</span>
<span id="L1134" rel="#L1134">1134</span>
<span id="L1135" rel="#L1135">1135</span>
<span id="L1136" rel="#L1136">1136</span>
<span id="L1137" rel="#L1137">1137</span>
<span id="L1138" rel="#L1138">1138</span>
<span id="L1139" rel="#L1139">1139</span>
<span id="L1140" rel="#L1140">1140</span>
<span id="L1141" rel="#L1141">1141</span>
<span id="L1142" rel="#L1142">1142</span>
<span id="L1143" rel="#L1143">1143</span>
<span id="L1144" rel="#L1144">1144</span>
<span id="L1145" rel="#L1145">1145</span>
<span id="L1146" rel="#L1146">1146</span>
<span id="L1147" rel="#L1147">1147</span>
<span id="L1148" rel="#L1148">1148</span>
<span id="L1149" rel="#L1149">1149</span>
<span id="L1150" rel="#L1150">1150</span>
<span id="L1151" rel="#L1151">1151</span>
<span id="L1152" rel="#L1152">1152</span>
<span id="L1153" rel="#L1153">1153</span>
<span id="L1154" rel="#L1154">1154</span>
<span id="L1155" rel="#L1155">1155</span>
<span id="L1156" rel="#L1156">1156</span>
<span id="L1157" rel="#L1157">1157</span>
<span id="L1158" rel="#L1158">1158</span>
<span id="L1159" rel="#L1159">1159</span>
<span id="L1160" rel="#L1160">1160</span>
<span id="L1161" rel="#L1161">1161</span>
<span id="L1162" rel="#L1162">1162</span>
<span id="L1163" rel="#L1163">1163</span>
<span id="L1164" rel="#L1164">1164</span>
<span id="L1165" rel="#L1165">1165</span>
<span id="L1166" rel="#L1166">1166</span>
<span id="L1167" rel="#L1167">1167</span>
<span id="L1168" rel="#L1168">1168</span>
<span id="L1169" rel="#L1169">1169</span>
<span id="L1170" rel="#L1170">1170</span>
<span id="L1171" rel="#L1171">1171</span>
<span id="L1172" rel="#L1172">1172</span>
<span id="L1173" rel="#L1173">1173</span>
<span id="L1174" rel="#L1174">1174</span>
<span id="L1175" rel="#L1175">1175</span>
<span id="L1176" rel="#L1176">1176</span>
<span id="L1177" rel="#L1177">1177</span>
<span id="L1178" rel="#L1178">1178</span>
<span id="L1179" rel="#L1179">1179</span>
<span id="L1180" rel="#L1180">1180</span>
<span id="L1181" rel="#L1181">1181</span>
<span id="L1182" rel="#L1182">1182</span>
<span id="L1183" rel="#L1183">1183</span>
<span id="L1184" rel="#L1184">1184</span>
<span id="L1185" rel="#L1185">1185</span>
<span id="L1186" rel="#L1186">1186</span>
<span id="L1187" rel="#L1187">1187</span>
<span id="L1188" rel="#L1188">1188</span>
<span id="L1189" rel="#L1189">1189</span>
<span id="L1190" rel="#L1190">1190</span>
<span id="L1191" rel="#L1191">1191</span>
<span id="L1192" rel="#L1192">1192</span>
<span id="L1193" rel="#L1193">1193</span>
<span id="L1194" rel="#L1194">1194</span>
<span id="L1195" rel="#L1195">1195</span>
<span id="L1196" rel="#L1196">1196</span>
<span id="L1197" rel="#L1197">1197</span>
<span id="L1198" rel="#L1198">1198</span>
<span id="L1199" rel="#L1199">1199</span>
<span id="L1200" rel="#L1200">1200</span>
<span id="L1201" rel="#L1201">1201</span>
<span id="L1202" rel="#L1202">1202</span>
<span id="L1203" rel="#L1203">1203</span>
<span id="L1204" rel="#L1204">1204</span>
<span id="L1205" rel="#L1205">1205</span>
<span id="L1206" rel="#L1206">1206</span>
<span id="L1207" rel="#L1207">1207</span>
<span id="L1208" rel="#L1208">1208</span>
<span id="L1209" rel="#L1209">1209</span>
<span id="L1210" rel="#L1210">1210</span>
<span id="L1211" rel="#L1211">1211</span>
<span id="L1212" rel="#L1212">1212</span>
<span id="L1213" rel="#L1213">1213</span>
<span id="L1214" rel="#L1214">1214</span>
<span id="L1215" rel="#L1215">1215</span>
<span id="L1216" rel="#L1216">1216</span>
<span id="L1217" rel="#L1217">1217</span>
<span id="L1218" rel="#L1218">1218</span>
<span id="L1219" rel="#L1219">1219</span>
<span id="L1220" rel="#L1220">1220</span>
<span id="L1221" rel="#L1221">1221</span>
<span id="L1222" rel="#L1222">1222</span>
<span id="L1223" rel="#L1223">1223</span>
<span id="L1224" rel="#L1224">1224</span>
<span id="L1225" rel="#L1225">1225</span>
<span id="L1226" rel="#L1226">1226</span>
<span id="L1227" rel="#L1227">1227</span>
<span id="L1228" rel="#L1228">1228</span>
<span id="L1229" rel="#L1229">1229</span>
<span id="L1230" rel="#L1230">1230</span>
<span id="L1231" rel="#L1231">1231</span>
<span id="L1232" rel="#L1232">1232</span>
<span id="L1233" rel="#L1233">1233</span>
<span id="L1234" rel="#L1234">1234</span>
<span id="L1235" rel="#L1235">1235</span>
<span id="L1236" rel="#L1236">1236</span>
<span id="L1237" rel="#L1237">1237</span>
<span id="L1238" rel="#L1238">1238</span>
<span id="L1239" rel="#L1239">1239</span>
<span id="L1240" rel="#L1240">1240</span>
<span id="L1241" rel="#L1241">1241</span>
<span id="L1242" rel="#L1242">1242</span>
<span id="L1243" rel="#L1243">1243</span>
<span id="L1244" rel="#L1244">1244</span>
<span id="L1245" rel="#L1245">1245</span>
<span id="L1246" rel="#L1246">1246</span>
<span id="L1247" rel="#L1247">1247</span>
<span id="L1248" rel="#L1248">1248</span>
<span id="L1249" rel="#L1249">1249</span>
<span id="L1250" rel="#L1250">1250</span>
<span id="L1251" rel="#L1251">1251</span>
<span id="L1252" rel="#L1252">1252</span>
<span id="L1253" rel="#L1253">1253</span>
<span id="L1254" rel="#L1254">1254</span>
<span id="L1255" rel="#L1255">1255</span>
<span id="L1256" rel="#L1256">1256</span>
<span id="L1257" rel="#L1257">1257</span>
<span id="L1258" rel="#L1258">1258</span>
<span id="L1259" rel="#L1259">1259</span>
<span id="L1260" rel="#L1260">1260</span>
<span id="L1261" rel="#L1261">1261</span>
<span id="L1262" rel="#L1262">1262</span>
<span id="L1263" rel="#L1263">1263</span>
<span id="L1264" rel="#L1264">1264</span>
<span id="L1265" rel="#L1265">1265</span>
<span id="L1266" rel="#L1266">1266</span>
<span id="L1267" rel="#L1267">1267</span>
<span id="L1268" rel="#L1268">1268</span>
<span id="L1269" rel="#L1269">1269</span>
<span id="L1270" rel="#L1270">1270</span>
<span id="L1271" rel="#L1271">1271</span>
<span id="L1272" rel="#L1272">1272</span>
<span id="L1273" rel="#L1273">1273</span>
<span id="L1274" rel="#L1274">1274</span>
<span id="L1275" rel="#L1275">1275</span>
<span id="L1276" rel="#L1276">1276</span>
<span id="L1277" rel="#L1277">1277</span>
<span id="L1278" rel="#L1278">1278</span>
<span id="L1279" rel="#L1279">1279</span>
<span id="L1280" rel="#L1280">1280</span>
<span id="L1281" rel="#L1281">1281</span>
<span id="L1282" rel="#L1282">1282</span>
<span id="L1283" rel="#L1283">1283</span>
<span id="L1284" rel="#L1284">1284</span>
<span id="L1285" rel="#L1285">1285</span>
<span id="L1286" rel="#L1286">1286</span>
<span id="L1287" rel="#L1287">1287</span>
<span id="L1288" rel="#L1288">1288</span>
<span id="L1289" rel="#L1289">1289</span>
<span id="L1290" rel="#L1290">1290</span>
<span id="L1291" rel="#L1291">1291</span>
<span id="L1292" rel="#L1292">1292</span>
<span id="L1293" rel="#L1293">1293</span>
<span id="L1294" rel="#L1294">1294</span>
<span id="L1295" rel="#L1295">1295</span>
<span id="L1296" rel="#L1296">1296</span>
<span id="L1297" rel="#L1297">1297</span>
<span id="L1298" rel="#L1298">1298</span>
<span id="L1299" rel="#L1299">1299</span>
<span id="L1300" rel="#L1300">1300</span>
<span id="L1301" rel="#L1301">1301</span>
<span id="L1302" rel="#L1302">1302</span>
<span id="L1303" rel="#L1303">1303</span>
<span id="L1304" rel="#L1304">1304</span>
<span id="L1305" rel="#L1305">1305</span>
<span id="L1306" rel="#L1306">1306</span>
<span id="L1307" rel="#L1307">1307</span>
<span id="L1308" rel="#L1308">1308</span>
<span id="L1309" rel="#L1309">1309</span>
<span id="L1310" rel="#L1310">1310</span>
<span id="L1311" rel="#L1311">1311</span>
<span id="L1312" rel="#L1312">1312</span>
<span id="L1313" rel="#L1313">1313</span>
<span id="L1314" rel="#L1314">1314</span>
<span id="L1315" rel="#L1315">1315</span>
<span id="L1316" rel="#L1316">1316</span>
<span id="L1317" rel="#L1317">1317</span>
<span id="L1318" rel="#L1318">1318</span>
<span id="L1319" rel="#L1319">1319</span>
<span id="L1320" rel="#L1320">1320</span>
<span id="L1321" rel="#L1321">1321</span>
<span id="L1322" rel="#L1322">1322</span>
<span id="L1323" rel="#L1323">1323</span>
<span id="L1324" rel="#L1324">1324</span>
<span id="L1325" rel="#L1325">1325</span>
<span id="L1326" rel="#L1326">1326</span>
<span id="L1327" rel="#L1327">1327</span>
<span id="L1328" rel="#L1328">1328</span>
<span id="L1329" rel="#L1329">1329</span>
<span id="L1330" rel="#L1330">1330</span>
<span id="L1331" rel="#L1331">1331</span>
<span id="L1332" rel="#L1332">1332</span>
<span id="L1333" rel="#L1333">1333</span>
<span id="L1334" rel="#L1334">1334</span>
<span id="L1335" rel="#L1335">1335</span>
<span id="L1336" rel="#L1336">1336</span>
<span id="L1337" rel="#L1337">1337</span>
<span id="L1338" rel="#L1338">1338</span>
<span id="L1339" rel="#L1339">1339</span>
<span id="L1340" rel="#L1340">1340</span>
<span id="L1341" rel="#L1341">1341</span>
<span id="L1342" rel="#L1342">1342</span>
<span id="L1343" rel="#L1343">1343</span>
<span id="L1344" rel="#L1344">1344</span>
<span id="L1345" rel="#L1345">1345</span>
<span id="L1346" rel="#L1346">1346</span>
<span id="L1347" rel="#L1347">1347</span>
<span id="L1348" rel="#L1348">1348</span>
<span id="L1349" rel="#L1349">1349</span>
<span id="L1350" rel="#L1350">1350</span>
<span id="L1351" rel="#L1351">1351</span>
<span id="L1352" rel="#L1352">1352</span>
<span id="L1353" rel="#L1353">1353</span>
<span id="L1354" rel="#L1354">1354</span>
<span id="L1355" rel="#L1355">1355</span>
<span id="L1356" rel="#L1356">1356</span>
<span id="L1357" rel="#L1357">1357</span>
<span id="L1358" rel="#L1358">1358</span>
<span id="L1359" rel="#L1359">1359</span>
<span id="L1360" rel="#L1360">1360</span>
<span id="L1361" rel="#L1361">1361</span>
<span id="L1362" rel="#L1362">1362</span>
<span id="L1363" rel="#L1363">1363</span>
<span id="L1364" rel="#L1364">1364</span>
<span id="L1365" rel="#L1365">1365</span>
<span id="L1366" rel="#L1366">1366</span>
<span id="L1367" rel="#L1367">1367</span>
<span id="L1368" rel="#L1368">1368</span>
<span id="L1369" rel="#L1369">1369</span>
<span id="L1370" rel="#L1370">1370</span>
<span id="L1371" rel="#L1371">1371</span>
<span id="L1372" rel="#L1372">1372</span>
<span id="L1373" rel="#L1373">1373</span>
<span id="L1374" rel="#L1374">1374</span>
<span id="L1375" rel="#L1375">1375</span>
<span id="L1376" rel="#L1376">1376</span>
<span id="L1377" rel="#L1377">1377</span>
<span id="L1378" rel="#L1378">1378</span>
<span id="L1379" rel="#L1379">1379</span>
<span id="L1380" rel="#L1380">1380</span>
<span id="L1381" rel="#L1381">1381</span>
<span id="L1382" rel="#L1382">1382</span>
<span id="L1383" rel="#L1383">1383</span>
<span id="L1384" rel="#L1384">1384</span>
<span id="L1385" rel="#L1385">1385</span>
<span id="L1386" rel="#L1386">1386</span>
<span id="L1387" rel="#L1387">1387</span>
<span id="L1388" rel="#L1388">1388</span>
<span id="L1389" rel="#L1389">1389</span>
<span id="L1390" rel="#L1390">1390</span>
<span id="L1391" rel="#L1391">1391</span>
<span id="L1392" rel="#L1392">1392</span>
<span id="L1393" rel="#L1393">1393</span>
<span id="L1394" rel="#L1394">1394</span>
<span id="L1395" rel="#L1395">1395</span>
<span id="L1396" rel="#L1396">1396</span>
<span id="L1397" rel="#L1397">1397</span>
<span id="L1398" rel="#L1398">1398</span>
<span id="L1399" rel="#L1399">1399</span>
<span id="L1400" rel="#L1400">1400</span>
<span id="L1401" rel="#L1401">1401</span>
<span id="L1402" rel="#L1402">1402</span>
<span id="L1403" rel="#L1403">1403</span>
<span id="L1404" rel="#L1404">1404</span>
<span id="L1405" rel="#L1405">1405</span>
<span id="L1406" rel="#L1406">1406</span>
<span id="L1407" rel="#L1407">1407</span>
<span id="L1408" rel="#L1408">1408</span>
<span id="L1409" rel="#L1409">1409</span>
<span id="L1410" rel="#L1410">1410</span>
<span id="L1411" rel="#L1411">1411</span>
<span id="L1412" rel="#L1412">1412</span>
<span id="L1413" rel="#L1413">1413</span>
<span id="L1414" rel="#L1414">1414</span>
<span id="L1415" rel="#L1415">1415</span>
<span id="L1416" rel="#L1416">1416</span>
<span id="L1417" rel="#L1417">1417</span>
<span id="L1418" rel="#L1418">1418</span>
<span id="L1419" rel="#L1419">1419</span>
<span id="L1420" rel="#L1420">1420</span>
<span id="L1421" rel="#L1421">1421</span>
<span id="L1422" rel="#L1422">1422</span>
<span id="L1423" rel="#L1423">1423</span>
<span id="L1424" rel="#L1424">1424</span>
<span id="L1425" rel="#L1425">1425</span>
<span id="L1426" rel="#L1426">1426</span>
<span id="L1427" rel="#L1427">1427</span>
<span id="L1428" rel="#L1428">1428</span>
<span id="L1429" rel="#L1429">1429</span>
<span id="L1430" rel="#L1430">1430</span>
<span id="L1431" rel="#L1431">1431</span>
<span id="L1432" rel="#L1432">1432</span>
<span id="L1433" rel="#L1433">1433</span>
<span id="L1434" rel="#L1434">1434</span>
<span id="L1435" rel="#L1435">1435</span>
<span id="L1436" rel="#L1436">1436</span>
<span id="L1437" rel="#L1437">1437</span>
<span id="L1438" rel="#L1438">1438</span>
<span id="L1439" rel="#L1439">1439</span>
<span id="L1440" rel="#L1440">1440</span>
<span id="L1441" rel="#L1441">1441</span>
<span id="L1442" rel="#L1442">1442</span>
<span id="L1443" rel="#L1443">1443</span>
<span id="L1444" rel="#L1444">1444</span>
<span id="L1445" rel="#L1445">1445</span>
<span id="L1446" rel="#L1446">1446</span>
<span id="L1447" rel="#L1447">1447</span>
<span id="L1448" rel="#L1448">1448</span>
<span id="L1449" rel="#L1449">1449</span>
<span id="L1450" rel="#L1450">1450</span>
<span id="L1451" rel="#L1451">1451</span>
<span id="L1452" rel="#L1452">1452</span>
<span id="L1453" rel="#L1453">1453</span>
<span id="L1454" rel="#L1454">1454</span>
<span id="L1455" rel="#L1455">1455</span>
<span id="L1456" rel="#L1456">1456</span>
<span id="L1457" rel="#L1457">1457</span>
<span id="L1458" rel="#L1458">1458</span>
<span id="L1459" rel="#L1459">1459</span>
<span id="L1460" rel="#L1460">1460</span>
<span id="L1461" rel="#L1461">1461</span>
<span id="L1462" rel="#L1462">1462</span>
<span id="L1463" rel="#L1463">1463</span>
<span id="L1464" rel="#L1464">1464</span>
<span id="L1465" rel="#L1465">1465</span>
<span id="L1466" rel="#L1466">1466</span>
<span id="L1467" rel="#L1467">1467</span>
<span id="L1468" rel="#L1468">1468</span>
<span id="L1469" rel="#L1469">1469</span>
<span id="L1470" rel="#L1470">1470</span>
<span id="L1471" rel="#L1471">1471</span>
<span id="L1472" rel="#L1472">1472</span>
<span id="L1473" rel="#L1473">1473</span>
<span id="L1474" rel="#L1474">1474</span>
<span id="L1475" rel="#L1475">1475</span>
<span id="L1476" rel="#L1476">1476</span>
<span id="L1477" rel="#L1477">1477</span>
<span id="L1478" rel="#L1478">1478</span>
<span id="L1479" rel="#L1479">1479</span>
<span id="L1480" rel="#L1480">1480</span>
<span id="L1481" rel="#L1481">1481</span>
<span id="L1482" rel="#L1482">1482</span>
<span id="L1483" rel="#L1483">1483</span>
<span id="L1484" rel="#L1484">1484</span>
<span id="L1485" rel="#L1485">1485</span>
<span id="L1486" rel="#L1486">1486</span>
<span id="L1487" rel="#L1487">1487</span>
<span id="L1488" rel="#L1488">1488</span>
<span id="L1489" rel="#L1489">1489</span>
<span id="L1490" rel="#L1490">1490</span>
<span id="L1491" rel="#L1491">1491</span>
<span id="L1492" rel="#L1492">1492</span>
<span id="L1493" rel="#L1493">1493</span>
<span id="L1494" rel="#L1494">1494</span>
<span id="L1495" rel="#L1495">1495</span>
<span id="L1496" rel="#L1496">1496</span>
<span id="L1497" rel="#L1497">1497</span>
<span id="L1498" rel="#L1498">1498</span>
<span id="L1499" rel="#L1499">1499</span>
<span id="L1500" rel="#L1500">1500</span>
<span id="L1501" rel="#L1501">1501</span>
<span id="L1502" rel="#L1502">1502</span>
<span id="L1503" rel="#L1503">1503</span>
<span id="L1504" rel="#L1504">1504</span>
<span id="L1505" rel="#L1505">1505</span>
<span id="L1506" rel="#L1506">1506</span>
<span id="L1507" rel="#L1507">1507</span>
<span id="L1508" rel="#L1508">1508</span>
<span id="L1509" rel="#L1509">1509</span>
<span id="L1510" rel="#L1510">1510</span>
<span id="L1511" rel="#L1511">1511</span>
<span id="L1512" rel="#L1512">1512</span>
<span id="L1513" rel="#L1513">1513</span>
<span id="L1514" rel="#L1514">1514</span>
<span id="L1515" rel="#L1515">1515</span>
<span id="L1516" rel="#L1516">1516</span>
<span id="L1517" rel="#L1517">1517</span>
<span id="L1518" rel="#L1518">1518</span>
<span id="L1519" rel="#L1519">1519</span>
<span id="L1520" rel="#L1520">1520</span>
<span id="L1521" rel="#L1521">1521</span>
<span id="L1522" rel="#L1522">1522</span>
<span id="L1523" rel="#L1523">1523</span>
<span id="L1524" rel="#L1524">1524</span>
<span id="L1525" rel="#L1525">1525</span>
<span id="L1526" rel="#L1526">1526</span>
<span id="L1527" rel="#L1527">1527</span>
<span id="L1528" rel="#L1528">1528</span>
<span id="L1529" rel="#L1529">1529</span>
<span id="L1530" rel="#L1530">1530</span>
<span id="L1531" rel="#L1531">1531</span>
<span id="L1532" rel="#L1532">1532</span>
<span id="L1533" rel="#L1533">1533</span>
<span id="L1534" rel="#L1534">1534</span>
<span id="L1535" rel="#L1535">1535</span>
<span id="L1536" rel="#L1536">1536</span>
<span id="L1537" rel="#L1537">1537</span>
<span id="L1538" rel="#L1538">1538</span>
<span id="L1539" rel="#L1539">1539</span>
<span id="L1540" rel="#L1540">1540</span>
<span id="L1541" rel="#L1541">1541</span>
<span id="L1542" rel="#L1542">1542</span>
<span id="L1543" rel="#L1543">1543</span>
<span id="L1544" rel="#L1544">1544</span>
<span id="L1545" rel="#L1545">1545</span>
<span id="L1546" rel="#L1546">1546</span>
<span id="L1547" rel="#L1547">1547</span>
<span id="L1548" rel="#L1548">1548</span>
<span id="L1549" rel="#L1549">1549</span>
<span id="L1550" rel="#L1550">1550</span>
<span id="L1551" rel="#L1551">1551</span>
<span id="L1552" rel="#L1552">1552</span>
<span id="L1553" rel="#L1553">1553</span>
<span id="L1554" rel="#L1554">1554</span>
<span id="L1555" rel="#L1555">1555</span>
<span id="L1556" rel="#L1556">1556</span>
<span id="L1557" rel="#L1557">1557</span>
<span id="L1558" rel="#L1558">1558</span>
<span id="L1559" rel="#L1559">1559</span>
<span id="L1560" rel="#L1560">1560</span>
<span id="L1561" rel="#L1561">1561</span>
<span id="L1562" rel="#L1562">1562</span>
<span id="L1563" rel="#L1563">1563</span>
<span id="L1564" rel="#L1564">1564</span>
<span id="L1565" rel="#L1565">1565</span>
<span id="L1566" rel="#L1566">1566</span>
<span id="L1567" rel="#L1567">1567</span>
<span id="L1568" rel="#L1568">1568</span>
<span id="L1569" rel="#L1569">1569</span>
<span id="L1570" rel="#L1570">1570</span>
<span id="L1571" rel="#L1571">1571</span>
<span id="L1572" rel="#L1572">1572</span>
<span id="L1573" rel="#L1573">1573</span>
<span id="L1574" rel="#L1574">1574</span>
<span id="L1575" rel="#L1575">1575</span>
<span id="L1576" rel="#L1576">1576</span>
<span id="L1577" rel="#L1577">1577</span>
<span id="L1578" rel="#L1578">1578</span>
<span id="L1579" rel="#L1579">1579</span>
<span id="L1580" rel="#L1580">1580</span>
<span id="L1581" rel="#L1581">1581</span>
<span id="L1582" rel="#L1582">1582</span>
<span id="L1583" rel="#L1583">1583</span>
<span id="L1584" rel="#L1584">1584</span>
<span id="L1585" rel="#L1585">1585</span>
<span id="L1586" rel="#L1586">1586</span>
<span id="L1587" rel="#L1587">1587</span>
<span id="L1588" rel="#L1588">1588</span>
<span id="L1589" rel="#L1589">1589</span>
<span id="L1590" rel="#L1590">1590</span>
<span id="L1591" rel="#L1591">1591</span>
<span id="L1592" rel="#L1592">1592</span>
<span id="L1593" rel="#L1593">1593</span>
<span id="L1594" rel="#L1594">1594</span>
<span id="L1595" rel="#L1595">1595</span>
<span id="L1596" rel="#L1596">1596</span>
<span id="L1597" rel="#L1597">1597</span>
<span id="L1598" rel="#L1598">1598</span>
<span id="L1599" rel="#L1599">1599</span>
<span id="L1600" rel="#L1600">1600</span>
<span id="L1601" rel="#L1601">1601</span>

          </td>
          <td class="blob-line-code">
                  <div class="highlight"><pre><div class='line' id='LC1'>Creating publication quality graphs in R</div><div class='line' id='LC2'>========================================================</div><div class='line' id='LC3'><br/></div><div class='line' id='LC4'>![](http://i.creativecommons.org/l/by-sa/3.0/88x31.png)</div><div class='line' id='LC5'><br/></div><div class='line' id='LC6'>This tutorial was developped as part of a one-day workshop held within the Ecosystem Informatics PhD-programme at the Philipps University of Marburg. The contents of this tutorial are published under the creative commons license [&#39;Attribution-ShareAlike CC BY-SA&#39;](http://creativecommons.org/licenses/by-sa/3.0/).</div><div class='line' id='LC7'><br/></div><div class='line' id='LC8'>Further information about this PhD programme can be found [here](http://ecosysteminformatics.org/phd-programm-ecosystem-informatics/)</div><div class='line' id='LC9'><br/></div><div class='line' id='LC10'>To see what we are usually up to I refer the interested reader to our homepage at http://www.environmentalinformatics-marburg.de</div><div class='line' id='LC11'><br/></div><div class='line' id='LC12'>Another resource for creating visualisations using R, more focussed on climatological/atmospheric applications can be found at http://metvurst.wordpress.com</div><div class='line' id='LC13'><br/></div><div class='line' id='LC14'>I hope you find parts of this tutorial, if not all of it useful.</div><div class='line' id='LC15'><br/></div><div class='line' id='LC16'>Comments, feedback, suggestions and bug reports should be directed to [tim.appelhans {at} staff.uni-marburg.de](http://umweltinformatik-marburg.de/mitarbeiterinnen-und-mitarbeiter/tim-appelhans/)</div><div class='line' id='LC17'><br/></div><div class='line' id='LC18'>**In this workshop we will**</div><div class='line' id='LC19'><br/></div><div class='line' id='LC20'>* learn a few things about handling and preparing our data for the creation of meaningful graphs</div><div class='line' id='LC21'>* quickly introduce the two main ways of plot creation in R - base graphics and grid graphics</div><div class='line' id='LC22'>* concentrate on plot production using grid graphics</div><div class='line' id='LC23'>* become familiar with the two main packages for highly flexible data visualisation in R - lattice &amp; ggplot2 (biased towards lattice I have to admit)</div><div class='line' id='LC24'>* learn how to modify the default options of these packages in order to really get what we want </div><div class='line' id='LC25'>* learn even more flexibility using the grid package to create visualisations comprising multiple plots on one page and manipulate existing plots to suit our needs</div><div class='line' id='LC26'>* see how spatial data can be represented using the spatial packages available in R</div><div class='line' id='LC27'>* learn how to save our visualisations in different formats that comply with general publication standards of most academic journals</div><div class='line' id='LC28'><br/></div><div class='line' id='LC29'>TIP: if you study the code provided in this tutorial closely, you will likely find some additional programming gems here and there which are not specifically introduced in this workshop... (such as the first two lines of code ;-))</div><div class='line' id='LC30'><br/></div><div class='line' id='LC31'>**In this workshop it is assumed that you**</div><div class='line' id='LC32'><br/></div><div class='line' id='LC33'>* already know how to get your data into R (```read.table()``` etc)</div><div class='line' id='LC34'>* have a basic understanding how particular parts of your data can be assessed (```$```, ```[``` - in case you do not know what these special characters mean in an R sense, you might want to start at a more basic level, e.g. [here](http://tryr.codeschool.com/))</div><div class='line' id='LC35'>* are familiar the notion of object creation/assignment ( ```&lt;-``` )</div><div class='line' id='LC36'><br/></div><div class='line' id='LC37'>**Note, howerver, that this workshop is not about statistics (we will only be marginally exposed to very basic statistical principles)**</div><div class='line' id='LC38'><br/></div><div class='line' id='LC39'>_Before we start, I would like to highlight a few useful web resources for finding help in case you get stuck with a particular task:_</div><div class='line' id='LC40'><br/></div><div class='line' id='LC41'>* [google is your friend](http://www.google.com) - for R related questions just type something like this &#39;r lattice how to change plot background color&#39; The crux here is that you provide both the programming language - R - and the name of the package your question is related to - lattice. This way you will very likely find useful answers (the web is full of knowledgeable geeks)</div><div class='line' id='LC42'>* for quick reference on the most useful basic functionality of R use http://www.statmethods.net</div><div class='line' id='LC43'>* using google in the way outlined above, you will most likely end up at [Stackoverflow](http://www.stackoverflow.com) at some stage. This is a very helpful platform for all sorts of programming issues with an ever increasing contribution of the R community. To search directly at Stackoverflow for R related stuff, type &#39;r&#39; in front of you search.</div><div class='line' id='LC44'>* [Rseek](http://www.rseek.org) is a search site dedicated exclusively to R-related stuff.</div><div class='line' id='LC45'>* [R-Bloggers](http://www.r-bloggers.com) is a nice site that provides access to all sorts of blog sites dedicated to R from all around the world (in fact, a lot of the material of this workshop is derived from posts found there).</div><div class='line' id='LC46'>* last, but not least, I am hopeful that [this site](http://www.teachpress.environmentalinformatics-marburg.de) will continue to grow and hence provide more and more useful tutorials closely related to issued in environmental sciences. So keep checking this site...</div><div class='line' id='LC47'><br/></div><div class='line' id='LC48'>## 1. Data handling</div><div class='line' id='LC49'><br/></div><div class='line' id='LC50'>One thing that most people fail to acknowledge is that visualising data in R (or any other programming language for that matter) usually involves a little more effort than simply calling some plot function to create a meaningful graph. Data visualisation is in essence an abstract representation of raw data. Most plotting routines available in R, however, are not designed to provide any useful data abstraction. This means that it is up to us to prepare our data to a level of abstraction that is feasible for what we want to show with our visualisation.   </div><div class='line' id='LC51'>Therefore, before we start to produce plots, we will need to spend some time and effort get familiar with some tools to manipulate our raw data sets.</div><div class='line' id='LC52'><br/></div><div class='line' id='LC53'>In particular, we will learn how to **subset**, **aggregate**, **sort** &amp; **merge** our data sets.</div><div class='line' id='LC54'><br/></div><div class='line' id='LC55'>**Right, enough of that introductory talk, let&#39;s start getting our hands dirty...**</div><div class='line' id='LC56'><br/></div><div class='line' id='LC57'>### 1.1. sub-setting our data</div><div class='line' id='LC58'><br/></div><div class='line' id='LC59'>**As a final introductory note I would like to draw your attention to the fact that for the sake of reproducibility, this workshop will make use of the diamonds data set (which comes with ggplot2) in all the provided examples**</div><div class='line' id='LC60'><br/></div><div class='line' id='LC61'>```{r knitr setup, echo = FALSE}</div><div class='line' id='LC62'>knit_hooks$set(plot = function(x, options) {</div><div class='line' id='LC63'>&nbsp;&nbsp;paste(&#39;&lt;figure&gt;&lt;img src=&quot;&#39;,</div><div class='line' id='LC64'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opts_knit$get(&#39;base.url&#39;), paste(x, collapse = &#39;.&#39;),</div><div class='line' id='LC65'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&quot;&gt;&lt;figcaption&gt;&#39;, options$fig.cap, &#39;&lt;/figcaption&gt;&lt;/figure&gt;&#39;,</div><div class='line' id='LC66'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sep = &#39;&#39;)</div><div class='line' id='LC67'>})</div><div class='line' id='LC68'><br/></div><div class='line' id='LC69'>fn = local({</div><div class='line' id='LC70'>&nbsp;&nbsp;i = 0</div><div class='line' id='LC71'>&nbsp;&nbsp;function(x) {</div><div class='line' id='LC72'>&nbsp;&nbsp;&nbsp;&nbsp;i &lt;&lt;- i + 1</div><div class='line' id='LC73'>&nbsp;&nbsp;&nbsp;&nbsp;paste(&#39;Figure &#39;, i, &#39;: &#39;, x, sep = &#39;&#39;)</div><div class='line' id='LC74'>&nbsp;&nbsp;}</div><div class='line' id='LC75'>})</div><div class='line' id='LC76'>```</div><div class='line' id='LC77'><br/></div><div class='line' id='LC78'>First things first, as always in R, we load the necessary packages first (and this should always happen at the beginning of a script, not somewhere in the middle or towards the end!)</div><div class='line' id='LC79'><br/></div><div class='line' id='LC80'>```{r global settings, tidy = FALSE, message = FALSE, results = &#39;hide&#39;}</div><div class='line' id='LC81'>### here&#39;s a rather handy way of loading all packages that you need</div><div class='line' id='LC82'>### for your code to work in one go</div><div class='line' id='LC83'>libs &lt;- c(&#39;ggplot2&#39;, &#39;latticeExtra&#39;, &#39;gridExtra&#39;, &#39;MASS&#39;, </div><div class='line' id='LC84'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;colorspace&#39;, &#39;plyr&#39;, &#39;Hmisc&#39;, &#39;scales&#39;)</div><div class='line' id='LC85'>lapply(libs, require, character.only = T)</div><div class='line' id='LC86'><br/></div><div class='line' id='LC87'>### load the diamonds data set (comes with ggplot2)</div><div class='line' id='LC88'>data(diamonds)</div><div class='line' id='LC89'>```</div><div class='line' id='LC90'><br/></div><div class='line' id='LC91'>The diamonds data set is structured as follows</div><div class='line' id='LC92'><br/></div><div class='line' id='LC93'>```{r str, tidy = FALSE}</div><div class='line' id='LC94'>str(diamonds)</div><div class='line' id='LC95'>```</div><div class='line' id='LC96'><br/></div><div class='line' id='LC97'>The ```str()``` command is probably the most useful command in all of R. It shows the complete structure of our data set and provides a &#39;road map&#39; of how to access certain parts of the data.   </div><div class='line' id='LC98'><br/></div><div class='line' id='LC99'>For example</div><div class='line' id='LC100'>```</div><div class='line' id='LC101'>diamonds$carat</div><div class='line' id='LC102'>```</div><div class='line' id='LC103'>is a numerical vector of length `r length(diamonds$carat)`</div><div class='line' id='LC104'><br/></div><div class='line' id='LC105'>and</div><div class='line' id='LC106'><br/></div><div class='line' id='LC107'>```</div><div class='line' id='LC108'>diamonds$cut</div><div class='line' id='LC109'>```</div><div class='line' id='LC110'><br/></div><div class='line' id='LC111'>is an ordered factor with the ordered levels `r levels(diamonds$cut)`</div><div class='line' id='LC112'><br/></div><div class='line' id='LC113'>Suppose we&#39;re a stingy person and don&#39;t want to spend too much money on the wedding ring for our loved one, we could create a data set only including diamonds that cost less than 1000 US$ (though 1000 US$ does still seem very generous to me).</div><div class='line' id='LC114'><br/></div><div class='line' id='LC115'>```{r subset cheap, tidy = FALSE}</div><div class='line' id='LC116'>diamonds.cheap &lt;- subset(diamonds, price &lt; 1000)</div><div class='line' id='LC117'>```</div><div class='line' id='LC118'><br/></div><div class='line' id='LC119'>Then our new data set would look like this</div><div class='line' id='LC120'><br/></div><div class='line' id='LC121'>```{r str subset cheap, tidy = FALSE}</div><div class='line' id='LC122'>str(diamonds.cheap)</div><div class='line' id='LC123'>```</div><div class='line' id='LC124'><br/></div><div class='line' id='LC125'>Now the new ```diamonds.cheap``` subset is a reduced data set of the original ```diamonds``` data set only having `r nrow(diamonds.cheap)` entries instead of the original `r nrow(diamonds)` entries.</div><div class='line' id='LC126'><br/></div><div class='line' id='LC127'>In case we were interested in a subset only including all diamonds of quality (cut) &#39;Premium&#39; the command would be</div><div class='line' id='LC128'><br/></div><div class='line' id='LC129'>```{r subset premium, tidy = FALSE}</div><div class='line' id='LC130'>diamonds.premium &lt;- subset(diamonds, cut == &quot;Premium&quot;)</div><div class='line' id='LC131'>str(diamonds.premium)</div><div class='line' id='LC132'>```</div><div class='line' id='LC133'><br/></div><div class='line' id='LC134'>Note the **two** equal signs in order to specify our selection (this stems from an effort to be consistent with selection criteria such as *smaller than* ```&lt;=``` or *not equal* ```!=``` and basically translates to *is equal*)!!</div><div class='line' id='LC135'><br/></div><div class='line' id='LC136'>Any combinations of these subset commands are valid, e.g.</div><div class='line' id='LC137'><br/></div><div class='line' id='LC138'>```{r subset premium and cheap, tidy = FALSE}</div><div class='line' id='LC139'>diamonds.premium.and.cheap &lt;- subset(diamonds, cut == &quot;Premium&quot; &amp; </div><div class='line' id='LC140'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price &lt;= 1000)</div><div class='line' id='LC141'>```</div><div class='line' id='LC142'><br/></div><div class='line' id='LC143'>produces a rather strict subset only allowing diamonds of premium quality that cost less than 1000 US$</div><div class='line' id='LC144'><br/></div><div class='line' id='LC145'>In case we want **ANY** of these, meaning all diamonds of premium quality **OR** cheaper than 1000 US$, we would use the **|** operator to combine the two specifications</div><div class='line' id='LC146'><br/></div><div class='line' id='LC147'>```{r subset premium or cheap, tidy = FALSE}</div><div class='line' id='LC148'>diamonds.premium.or.cheap &lt;- subset(diamonds, cut == &quot;Premium&quot; | </div><div class='line' id='LC149'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price &lt;= 1000)</div><div class='line' id='LC150'>```</div><div class='line' id='LC151'><br/></div><div class='line' id='LC152'>The **OR** specification is much less rigid than the **AND** specification which will result in a larger data set:</div><div class='line' id='LC153'><br/></div><div class='line' id='LC154'>* `diamonds.premium.and.cheap` has `r nrow(diamonds.premium.and.cheap)` rows, while</div><div class='line' id='LC155'>* `diamonds.premium.or.cheap` has `r nrow(diamonds.premium.or.cheap)` rows</div><div class='line' id='LC156'><br/></div><div class='line' id='LC157'>```{r str comparison, tidy = FALSE}</div><div class='line' id='LC158'>str(diamonds.premium.and.cheap)</div><div class='line' id='LC159'>str(diamonds.premium.or.cheap)</div><div class='line' id='LC160'>```</div><div class='line' id='LC161'><br/></div><div class='line' id='LC162'>There is, in principle, no limitation to the combination of these so-called Boolean operators (and, or, equal to, not equal to, greater than, less than). I guess you get the idea...</div><div class='line' id='LC163'><br/></div><div class='line' id='LC164'>&gt; ### -----------------------~~ Exercise I ~~------------------------------</div><div class='line' id='LC165'>create one subset of the diamonds dataframe which contains    </div><div class='line' id='LC166'>only diamonds of quality &#39;Ideal&#39; and a second subset that     </div><div class='line' id='LC167'>contains the rest excluding all diamonds of color &#39;J&#39;</div><div class='line' id='LC168'>&gt; ### ----------------------------~~ ° ~~--------------------------------------</div><div class='line' id='LC169'><br/></div><div class='line' id='LC170'>### 1.2. aggregating our data</div><div class='line' id='LC171'><br/></div><div class='line' id='LC172'>Suppose we wanted to calculate the average price of the diamonds for each level of ```cut```, i.e. the average price for all diamonds of &quot;Ideal&quot; quality, for all diamonds of &quot;Premium&quot; quality and so on, this would be done like this</div><div class='line' id='LC173'><br/></div><div class='line' id='LC174'>```{r aggregate price cut, tidy = FALSE}</div><div class='line' id='LC175'>ave.price.cut &lt;- aggregate(diamonds$price, by = list(diamonds$cut), </div><div class='line' id='LC176'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUN = mean)</div><div class='line' id='LC177'>### by = ... needs a list, even if there is only one entry</div><div class='line' id='LC178'>```</div><div class='line' id='LC179'><br/></div><div class='line' id='LC180'>and will look like this</div><div class='line' id='LC181'><br/></div><div class='line' id='LC182'>```{r show table, tidy = FALSE}</div><div class='line' id='LC183'>ave.price.cut</div><div class='line' id='LC184'>```</div><div class='line' id='LC185'><br/></div><div class='line' id='LC186'>Note, that the original column names are not carried over to the newly created table of averaged values. Instead these get the generic names ```Group.1``` and ```x```</div><div class='line' id='LC187'><br/></div><div class='line' id='LC188'>The ```Group.1``` already indicates that we are not limited to aggregate just over one factorial variable, more are also possible. Furthermore, any  function to compute the summary statistics which can be applied to all data subsets is allowed, e.g. to compute the number of items per category we could use ```length```</div><div class='line' id='LC189'><br/></div><div class='line' id='LC190'>```{r aggregate price cut + color, tidy = FALSE}</div><div class='line' id='LC191'>ave.n.cut.color &lt;- aggregate(diamonds$price, </div><div class='line' id='LC192'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by = list(diamonds$cut,</div><div class='line' id='LC193'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diamonds$color), </div><div class='line' id='LC194'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUN = length)</div><div class='line' id='LC195'>ave.n.cut.color</div><div class='line' id='LC196'>```</div><div class='line' id='LC197'><br/></div><div class='line' id='LC198'>Given that as a result of aggregating this way we loose our variable names, it makes sense to set them afterwards, so that we can easily refer to them later</div><div class='line' id='LC199'><br/></div><div class='line' id='LC200'>```{r set names, tidy = FALSE}</div><div class='line' id='LC201'>names(ave.n.cut.color) &lt;- c(&quot;cut&quot;, &quot;color&quot;, &quot;n&quot;)</div><div class='line' id='LC202'>str(ave.n.cut.color)</div><div class='line' id='LC203'>```</div><div class='line' id='LC204'><br/></div><div class='line' id='LC205'>So, I hope you see how useful ```aggregate()``` is for calculating summary statistics of your data.</div><div class='line' id='LC206'><br/></div><div class='line' id='LC207'>&gt; ### -----------------------~~ Exercise II ~~-----------------------------</div><div class='line' id='LC208'>aggregate the first dataframe from exercise I as mean carat    </div><div class='line' id='LC209'>per clarity and the second one as median carat per clarity</div><div class='line' id='LC210'>&gt; ### -----------------------------~~ ° ~~------------------------------------</div><div class='line' id='LC211'><br/></div><div class='line' id='LC212'>### 1.3. sorting our data</div><div class='line' id='LC213'><br/></div><div class='line' id='LC214'>Sorting our data according to one (or more) of the variables in our data can also be very handy.   </div><div class='line' id='LC215'>Sorting of a vector can be achieved using ```sort()```</div><div class='line' id='LC216'><br/></div><div class='line' id='LC217'>```{r sort vector, tidy = FALSE}</div><div class='line' id='LC218'>sort(ave.n.cut.color$n)</div><div class='line' id='LC219'>```</div><div class='line' id='LC220'><br/></div><div class='line' id='LC221'>sorting of an entire dataframe is done using ```order()``` as follows</div><div class='line' id='LC222'><br/></div><div class='line' id='LC223'>* for sorting according to one variable</div><div class='line' id='LC224'><br/></div><div class='line' id='LC225'>```{r sort df, tidy = FALSE}</div><div class='line' id='LC226'>ave.n.cut.color &lt;- ave.n.cut.color[order(ave.n.cut.color$cut), ]</div><div class='line' id='LC227'>ave.n.cut.color</div><div class='line' id='LC228'>```</div><div class='line' id='LC229'><br/></div><div class='line' id='LC230'>* for sorting according to two variables</div><div class='line' id='LC231'><br/></div><div class='line' id='LC232'>```{r sort df2, tidy = FALSE}</div><div class='line' id='LC233'>ave.n.cut.color &lt;- ave.n.cut.color[order(ave.n.cut.color$cut,</div><div class='line' id='LC234'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ave.n.cut.color$n), ]</div><div class='line' id='LC235'>ave.n.cut.color</div><div class='line' id='LC236'>```</div><div class='line' id='LC237'><br/></div><div class='line' id='LC238'>&gt; ### -------------------------~~ Exercise III ~~--------------------------</div><div class='line' id='LC239'>sort the first data frame from exercise 2 according to carat</div><div class='line' id='LC240'>&gt; ### -------------------------------~~ ° ~~-----------------------------------</div><div class='line' id='LC241'><br/></div><div class='line' id='LC242'>### 1.4. merging our data</div><div class='line' id='LC243'><br/></div><div class='line' id='LC244'>Often enough we end up with multiple data sets on our hard drive that contain useful data for the same analysis. In this case we might want to amalgamate our data sets so that we have all the data in one set.   </div><div class='line' id='LC245'>R provides a function called ```merge()``` that does just that</div><div class='line' id='LC246'><br/></div><div class='line' id='LC247'>```{r merge 2 dfs, tidy = FALSE}</div><div class='line' id='LC248'>ave.n.cut.color.price &lt;- merge(ave.n.cut.color, ave.price.cut, </div><div class='line' id='LC249'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by.x = &quot;cut&quot;, by.y = &quot;Group.1&quot;)</div><div class='line' id='LC250'>ave.n.cut.color.price</div><div class='line' id='LC251'>```</div><div class='line' id='LC252'><br/></div><div class='line' id='LC253'>As the variable names of our two data sets differ, we need to specifically provide the names for each by which the merging should be done (```by.x``` &amp; ```by.y```). The default of ```merge()``` tries to find variable names which are identical.</div><div class='line' id='LC254'><br/></div><div class='line' id='LC255'>Note, in order to merge more that two data frames at a time, we need to call a powerful higher order function called ```Reduce()```. This is one mighty function for doing all sorts of things iteratively.</div><div class='line' id='LC256'><br/></div><div class='line' id='LC257'>```{r merge multiple dfs, tidy = FALSE}</div><div class='line' id='LC258'>names(ave.price.cut) &lt;- c(&quot;cut&quot;, &quot;price&quot;)</div><div class='line' id='LC259'><br/></div><div class='line' id='LC260'>set.seed(12)</div><div class='line' id='LC261'><br/></div><div class='line' id='LC262'>df3 &lt;- data.frame(cut = ave.price.cut$cut,</div><div class='line' id='LC263'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var1 = rnorm(nrow(ave.price.cut), 10, 2),</div><div class='line' id='LC264'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var2 = rnorm(nrow(ave.price.cut), 100, 20))</div><div class='line' id='LC265'><br/></div><div class='line' id='LC266'>ave.n.cut.color.price &lt;- Reduce(function(...) merge(..., all=T), </div><div class='line' id='LC267'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list(ave.n.cut.color, </div><div class='line' id='LC268'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ave.price.cut,</div><div class='line' id='LC269'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df3))</div><div class='line' id='LC270'>ave.n.cut.color.price</div><div class='line' id='LC271'>```</div><div class='line' id='LC272'><br/></div><div class='line' id='LC273'>&gt; ### ------------------------~~ Exercise IV ~~----------------------------</div><div class='line' id='LC274'>merge the two data frames from exercise II</div><div class='line' id='LC275'>&gt; ### ------------------------------~~ ° ~~------------------------------------</div><div class='line' id='LC276'><br/></div><div class='line' id='LC277'>Ok, so now we have a few tools at hand to manipulate our data in a way that we should be able to produce some meaningful graphs which tell the story that we want to be heard, or better, seen...</div><div class='line' id='LC278'><br/></div><div class='line' id='LC279'>So, let&#39;s start plotting stuff</div><div class='line' id='LC280'><br/></div><div class='line' id='LC281'>## 2. Data visualisation</div><div class='line' id='LC282'><br/></div><div class='line' id='LC283'>In the next few sections, we will produce several varieties of *scatter plots*, *box &amp; whisker plots*, *plots with error bars*, *histograms* and *density plots*. All of these will first be produced using the ```lattice``` package and then an attempt is made to recreate these in (pretty much) the exact same way in ```ggplot2```. First, the default versions are created and then we will see how they can be modified in order to produce plots that satisfy the requirements of most academic journals.    </div><div class='line' id='LC284'><br/></div><div class='line' id='LC285'>We will see that some things are easier to achieve using ```lattice```, some other things are easier in ```ggplot2```, so it is good to learn how to use both of them...</div><div class='line' id='LC286'><br/></div><div class='line' id='LC287'>Ok, let&#39;s start with the classic statistical plot of variable x vs. variable y - the scatter plot...</div><div class='line' id='LC288'><br/></div><div class='line' id='LC289'>### 2.1. Scatter plots</div><div class='line' id='LC290'><br/></div><div class='line' id='LC291'>Even with all the enhancements &amp; progress made in the field of computer based graphics in recent years/decades, the best (as most intuitive) way to show the relationship between two continuous variables remains the scatter plot. Just like for the smoothest ride, the best shape of the wheel is still round.</div><div class='line' id='LC292'><br/></div><div class='line' id='LC293'>If, from our original diamonds data set we wanted to see the relation between price and carat of the diamonds (or more precisely how price is influenced by carat), we would use a scatter plot.</div><div class='line' id='LC294'><br/></div><div class='line' id='LC295'>#### 2.1.1. The _lattice_ way</div><div class='line' id='LC296'><br/></div><div class='line' id='LC297'>```{r scatter lattice, tidy = FALSE, fig.width = 10, fig.height = 10, fig.cap = fn(&quot;a basic scatter plot produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC298'>scatter.lattice &lt;- xyplot(price ~ carat, data = diamonds)</div><div class='line' id='LC299'><br/></div><div class='line' id='LC300'>scatter.lattice</div><div class='line' id='LC301'>```</div><div class='line' id='LC302'><br/></div><div class='line' id='LC303'>What we see is that generally lower carat values tend to be cheaper. </div><div class='line' id='LC304'><br/></div><div class='line' id='LC305'>However, there is, especially at the high price end, a lot of scatter, i.e. there are diamonds of 1 carat that cost just as much as diamonds of 4 or more carat. Maybe this is a function of the cut? Let&#39;s see...</div><div class='line' id='LC306'><br/></div><div class='line' id='LC307'>Another thing that we might be interested in is the nature and strength of the relationship that we see in our scatter plot. These plots are still the fundamental way of visualising linear (and non-linear) statistics between 2 (or more) variables. In our case (and I said we will only be marginally touching statistics here) let&#39;s try to figure out what the linear relationship between x (cut) and y (price) is. Given that we are plotting cut on the y-axis and the general linear regression formula is ```y ~ a + b*x``` means that we are assuming that cut is influencing (determining) price, NOT the other way round!!</div><div class='line' id='LC308'><br/></div><div class='line' id='LC309'>Lattice is a very powerful package that provides a lot of flexibility and power to create all sorts of taylor-made statistical plots. In particular, it is designed to provide an easy to use framework for the representation of some variable(s) conditioned on some other variable(s). This means, that we can easily show the same relationship from figure 1, but this time for each of the different quality levels (the variable ```cut``` in the diamonds data set) into which diamonds can be classified. These conditional subsets are called panels in lattice.</div><div class='line' id='LC310'><br/></div><div class='line' id='LC311'>This is done using the ```|``` character just after the formula expression. So the complete formula would read:</div><div class='line' id='LC312'><br/></div><div class='line' id='LC313'>```</div><div class='line' id='LC314'>y ~ x | g</div><div class='line' id='LC315'>``` </div><div class='line' id='LC316'><br/></div><div class='line' id='LC317'>y is a function of x conditional to the values of g (where g is usually a factorial variable)</div><div class='line' id='LC318'><br/></div><div class='line' id='LC319'>The code below shows how all of this is achieved.</div><div class='line' id='LC320'><br/></div><div class='line' id='LC321'>* plot ```price ~ carat``` conditional to ```cut```</div><div class='line' id='LC322'>* draw the regression line for each panel</div><div class='line' id='LC323'>* also provide the _R^2_ value for each panel</div><div class='line' id='LC324'><br/></div><div class='line' id='LC325'>```{r scatter lattice with panels and line, tidy = FALSE, fig.cap = fn(&quot;a panel plot showing regression lines for each panel produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC326'>scatter.lattice &lt;- xyplot(price ~ carat | cut, </div><div class='line' id='LC327'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = diamonds, </div><div class='line' id='LC328'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel = function(x, y, ...) {</div><div class='line' id='LC329'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.xyplot(x, y, ...)</div><div class='line' id='LC330'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1 &lt;- lm(y ~ x)</div><div class='line' id='LC331'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1sum &lt;- summary(lm1)</div><div class='line' id='LC332'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r2 &lt;- lm1sum$adj.r.squared</div><div class='line' id='LC333'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.abline(a = lm1$coefficients[1], </div><div class='line' id='LC334'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b = lm1$coefficients[2])</div><div class='line' id='LC335'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.text(labels = </div><div class='line' id='LC336'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bquote(italic(R)^2 == </div><div class='line' id='LC337'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.(format(r2, </div><div class='line' id='LC338'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digits = 3))),</div><div class='line' id='LC339'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = 4, y = 1000)</div><div class='line' id='LC340'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div><div class='line' id='LC341'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xscale.components = xscale.components.subticks,</div><div class='line' id='LC342'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yscale.components = yscale.components.subticks,</div><div class='line' id='LC343'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as.table = TRUE)</div><div class='line' id='LC344'><br/></div><div class='line' id='LC345'>scatter.lattice</div><div class='line' id='LC346'>```</div><div class='line' id='LC347'><br/></div><div class='line' id='LC348'>This is where ```lattice``` becomes a bit more challenging, yet how do they say: with great power comes great complexity... (maybe I didn&#39;t get this quote completely correct, but it certainly reflects the nature of ```lattice&#39;s``` flexibility. A lot of things are possible, but they need a bit more effort than accepting the default settings.</div><div class='line' id='LC349'><br/></div><div class='line' id='LC350'>Basically, what we have done here is to provide a so-called panel function (actually, we have provided 3 of them).</div><div class='line' id='LC351'><br/></div><div class='line' id='LC352'>But let&#39;s look at this step-by-step... </div><div class='line' id='LC353'><br/></div><div class='line' id='LC354'>As ```lattice``` is geared towards providing plots in small multiples (as E. Tufte calls them) or panels it provides a ```panel = ``` argument to which we can assign certain functions that will be evaluated separately for each of the panels. There&#39;s a variety of pre-defined panel functions (such as the ones we used here - panel.xyplot, panel.abline, panel.text &amp; many more) but we can also define out own panel functions. This is why ```lattice``` is so versatile and powerful. Basically, writing panel functions is just like writing any other function in R (though some limitations do exist).</div><div class='line' id='LC355'><br/></div><div class='line' id='LC356'>The important thing to note here is that ```x``` and ```y``` in the context of panel functions refer to the ```x``` and ```y``` variables we define in the plot definition, i.e. ```x = carat``` and ```y = price```. So, for the panel functions we can use these shorthands, like as we are doing in defining our linear model ```lm1 &lt;- lm(y ~ x)```. This linear model will be calculated separately for each of the panels, which are basically nothing else than subsets of our data corresponding to the different levels of cut. Maybe it helps to think of this as a certain type of for loop:</div><div class='line' id='LC357'><br/></div><div class='line' id='LC358'>```</div><div class='line' id='LC359'>for (level in levels(cut)) lm1 &lt;- lm(price ~ carat)</div><div class='line' id='LC360'>```</div><div class='line' id='LC361'><br/></div><div class='line' id='LC362'>This then enables us to access the outcome of this linear model separately for each panel and we can use ```panel.abline``` to draw a line in each panel corresponding to the calculated model coefficients ```a = Intercept``` and ```b = slope```. Hence, we are drawing the regression line which represents the line of least squares for each panel separately.</div><div class='line' id='LC363'><br/></div><div class='line' id='LC364'>The same holds true for the calculation and plotting of the adjusted _R^2_ value for each linear model per panel. In this case we use the ```panel.text``` function to &#39;write&#39; the corresponding value into each of the panel boxes. The location of the text is determined by the ```x = ``` and ```y = ``` arguments. This is where some car needs to be taken, as in the ```panel.text``` call ```x``` and ```y``` don&#39;t refer to the ```x``` and ```y``` variables of the global plot function (```xyplot```) anymore, but rather represent the locations of where to position the text within each of the panel boxes in the units used for each of the axes (in our case ```x = 4``` and ```y = 1000```).</div><div class='line' id='LC365'><br/></div><div class='line' id='LC366'>There&#39;s two more things to note with regard to panel functions</div><div class='line' id='LC367'><br/></div><div class='line' id='LC368'>1. In order to draw what we originally intended to draw, i.e. the scatterplot, we need to provide a panel function that represents our initial intention. In our case this is the rather blank call ```panel.xyplot(x, y, ...)```. Without this, the points of our plot will not be drawn and we will get a plot that only shows the regression line and the text (feel free to try it!). This seems like a good place to introduce one of the most awkward (from a programming point of view) but at the same time most awesome (from a users point of view) things in the R language. The ```...``` are a shorthand for &#39;everything else that is possible in a certain function&#39;. This is both a very lazy and at the same time a very convenient way of passing arguments to a function. Basically, this enables us to provide any additional argument that the function might be able to understand. Any argument that ```xyplot``` is able to evaluate (understand) can be passed in addition to ```x``` and ```y```. Try it yourself by, for example specifying ```col = &quot;red&quot;```. If we had not included ```, ...``` in the ```panel = function(x, y, ...)``` argument, the ```col = ``` definition would not be possible. Anyway, this is only a side note that is not really related to the topic at hand, so let&#39;s move on....</div><div class='line' id='LC369'><br/></div><div class='line' id='LC370'>2. the order in which panel functions are supplied does matter. This means that the first panel function will be evaluated (and drawn) first, then the second, then the third and so on. Hence, if we were to plot the points of our plot on top of everything else, we would need to provide the ```panel.xyplot``` function as the last of the panel functions.</div><div class='line' id='LC371'><br/></div><div class='line' id='LC372'>Right, so now we have seen how to use panel functions to calculate and draw things specific to each panel. One thing I really dislike about ```lattice``` is the default graphical parameter settings (such as colours etc). However, changing these is rather straight forward. We can easily create our own themes by replacing the default values for each of the graphical parameters individually and saving these as our own themes. The function that let&#39;s us access the default (or already modified) graphical parameter settings is called ```trellis.par.get()```. Assigning this to a new object, we can modify every entry of the default settings to our liking (remember ```str()``` provides a &#39;road map&#39; for accessing individual bits of an object).</div><div class='line' id='LC373'><br/></div><div class='line' id='LC374'>```{r latt panel scat2, tidy = FALSE, fig.cap = fn(&quot;a panel plot with modified settings of the lattice layout&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC375'>my.theme &lt;- trellis.par.get()</div><div class='line' id='LC376'>my.theme$strip.background$col &lt;- &quot;grey80&quot;</div><div class='line' id='LC377'>my.theme$plot.symbol$pch &lt;- 16</div><div class='line' id='LC378'>my.theme$plot.symbol$col &lt;- &quot;grey60&quot;</div><div class='line' id='LC379'>my.theme$plot.polygon$col &lt;- &quot;grey90&quot;</div><div class='line' id='LC380'><br/></div><div class='line' id='LC381'>l.sc &lt;- update(scatter.lattice, par.settings = my.theme, </div><div class='line' id='LC382'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;layout = c(3, 2),</div><div class='line' id='LC383'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between = list(x = 0.3, y = 0.3))</div><div class='line' id='LC384'><br/></div><div class='line' id='LC385'>print(l.sc)</div><div class='line' id='LC386'>```</div><div class='line' id='LC387'><br/></div><div class='line' id='LC388'>Apart from showing us how to change the graphical parameter settings, the above code chunk also highlights one of the very handy properties of ```lattice``` (which is also true for ```ggplot2```). We are able to store any plot we create in an object and can refer to this object later. This enables us to simply ```update``` the object rather than having to define it over (and over) again.</div><div class='line' id='LC389'><br/></div><div class='line' id='LC390'>Like many other packages, ```lattice``` has a companion called ```latticeExtra```. This package provides several additions/extensions to the core functionality of ```lattice```. One of the very handy additions is a panel function called ```panel.smoother``` which enables us to evaluate several linear and non-linear models for each panel individually. This means that we actually don&#39;t need to calculate these models &#39;by hand&#39; for each panel, but can use this pre-defined function to evaluate them. This is demonstrated in the next code chunk.</div><div class='line' id='LC391'><br/></div><div class='line' id='LC392'>Note that we are still calculating the linear model in order to be able to provide the _R^2_ value for each panel. We don&#39;t need the ```panel.abline``` anymore to draw the regression line anymore. Actually, this is done using ```panel.smoother``` which also provides us with an estimation of the standard error related to the mean estimation of ```y``` for each ```x```. This may be hard to see, but there is a confidence band of the standard error plotted around the regression line in each panel. Note, unfortunately, the the confidence intervals are very narrow so that they are hard to see in the plot below.</div><div class='line' id='LC393'><br/></div><div class='line' id='LC394'>For an overview of possible models to be specified using ```panel.smoother``` see ```?panel.smoother``` (in library ```latticeExtra```)</div><div class='line' id='LC395'><br/></div><div class='line' id='LC396'>```{r latt panel smooth scat, tidy = FALSE, fig.cap = fn(&quot;a panel plot showing regression lines  and confidence intervals for each panel produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC397'>scatter.lattice &lt;- xyplot(price ~ carat | cut, </div><div class='line' id='LC398'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = diamonds, </div><div class='line' id='LC399'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel = function(x, y, ...) {</div><div class='line' id='LC400'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.xyplot(x, y, ...)</div><div class='line' id='LC401'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1 &lt;- lm(y ~ x)</div><div class='line' id='LC402'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1sum &lt;- summary(lm1)</div><div class='line' id='LC403'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r2 &lt;- lm1sum$adj.r.squared</div><div class='line' id='LC404'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.text(labels = </div><div class='line' id='LC405'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bquote(italic(R)^2 == </div><div class='line' id='LC406'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.(format(r2, </div><div class='line' id='LC407'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digits = 3))),</div><div class='line' id='LC408'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = 4, y = 1000)</div><div class='line' id='LC409'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.smoother(x, y, method = &quot;lm&quot;, </div><div class='line' id='LC410'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col = &quot;black&quot;, </div><div class='line' id='LC411'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.se = &quot;black&quot;,</div><div class='line' id='LC412'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.se = 0.3)</div><div class='line' id='LC413'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div><div class='line' id='LC414'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xscale.components = xscale.components.subticks,</div><div class='line' id='LC415'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yscale.components = yscale.components.subticks,</div><div class='line' id='LC416'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as.table = TRUE)</div><div class='line' id='LC417'><br/></div><div class='line' id='LC418'>l.sc &lt;- update(scatter.lattice, par.settings = my.theme)</div><div class='line' id='LC419'><br/></div><div class='line' id='LC420'>print(l.sc)</div><div class='line' id='LC421'>```</div><div class='line' id='LC422'><br/></div><div class='line' id='LC423'>Having a look at the scatter plots we have produced so far, there is an obvious problem. There are so many points that it is impossible to determine their actual distribution. One way to address this problem could be to plot each point in a semi-transparent manner. I have tried this potential solution and found that it does not help a great deal (but please feel free, and I highly encourage, to try it yourself).</div><div class='line' id='LC424'><br/></div><div class='line' id='LC425'>Hence, we need another way to address the over-plotting of points.</div><div class='line' id='LC426'><br/></div><div class='line' id='LC427'>A potential remedy is to map the 2 dimensional space in which we plot to a grid and estimate the point density in each of the grid cells. This can be done using a so-called 2 dimensional kernel density estimator. We won&#39;t have the time to go into much detail about this method here, but we will see how this can be done... Before we go there, though, we need to spend some time to have a closer look at colour representation of certain variables. A careful study of colour-spaces (e.g HERE AND HERE AND HERE) leads to the conclusion that the ```hcl``` colour space is preferable when mapping a variable to colour (be it factorial or continuous).</div><div class='line' id='LC428'><br/></div><div class='line' id='LC429'>This colour space is readily available in R through the package ```colorspace``` and the function of interest is called ```hcl()```.</div><div class='line' id='LC430'><br/></div><div class='line' id='LC431'>In the code chunk that follows we will create a colour palette that varies in both colour (hue) and also luminance (brightness) so that this can be distinguished even in grey-scale (printed) versions of the plot. As a reference colour palette we will use the &#39;Spectral&#39; palette from clorobrewer.org which is also a multi-hue palette but represents a diverging colour palette. Hence, each end of the palette will look rather similar when converted to grey-scale. </div><div class='line' id='LC432'><br/></div><div class='line' id='LC433'>```{r colours, tidy = FALSE, fig.width = 8, fig.height = 3}</div><div class='line' id='LC434'>clrs.spec &lt;- colorRampPalette(rev(brewer.pal(11, &quot;Spectral&quot;)))</div><div class='line' id='LC435'>clrs.hcl &lt;- function(n) {</div><div class='line' id='LC436'>&nbsp;&nbsp;hcl(h = seq(230, 0, length.out = n), </div><div class='line' id='LC437'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = 60, l = seq(10, 90, length.out = n), </div><div class='line' id='LC438'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixup = TRUE)</div><div class='line' id='LC439'>&nbsp;&nbsp;}</div><div class='line' id='LC440'><br/></div><div class='line' id='LC441'>### function to plot a colour palette</div><div class='line' id='LC442'>pal &lt;- function(col, border = &quot;transparent&quot;, ...)</div><div class='line' id='LC443'>{</div><div class='line' id='LC444'>&nbsp;n &lt;- length(col)</div><div class='line' id='LC445'>&nbsp;plot(0, 0, type=&quot;n&quot;, xlim = c(0, 1), ylim = c(0, 1),</div><div class='line' id='LC446'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axes = FALSE, xlab = &quot;&quot;, ylab = &quot;&quot;, ...)</div><div class='line' id='LC447'>&nbsp;rect(0:(n-1)/n, 0, 1:n/n, 1, col = col, border = border)</div><div class='line' id='LC448'>}</div><div class='line' id='LC449'>```</div><div class='line' id='LC450'><br/></div><div class='line' id='LC451'>So here&#39;s the Spectral palette from colorbrewer.org interpolated over 100 colours</div><div class='line' id='LC452'><br/></div><div class='line' id='LC453'>```{r spectr pal, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;a diverging rainbow colour palette from colorbrewer&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC454'>pal(clrs.spec(100))</div><div class='line' id='LC455'>```</div><div class='line' id='LC456'><br/></div><div class='line' id='LC457'>And this is what it looks like in grey-scale</div><div class='line' id='LC458'><br/></div><div class='line' id='LC459'>```{r spectr pal grey, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;same palette as above in grey-scale&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC460'>pal(desaturate(clrs.spec(100)))</div><div class='line' id='LC461'>```</div><div class='line' id='LC462'><br/></div><div class='line' id='LC463'>We see that this palette varies in lightness from a very bright centre to darker ends on each side. Note, that the red end is slightly darker than the blue end</div><div class='line' id='LC464'><br/></div><div class='line' id='LC465'>This is quite ok in case we want to show some diverging data (deviations from a zero point - e.g. the mean). If we, however, are dealing with a sequential measure, such as temperature, or in our case the density of points plotted per some grid cell, we really need to use a sequential colour palette. There are two common problems with sequential palettes:</div><div class='line' id='LC466'><br/></div><div class='line' id='LC467'>1. we need to create a palette that maps the data accurately. This means that the perceived distances between the different hues utilised needs to reflect the distances between our data points. AND this distance needs to be constant, no matter between which two point of the palette we want to estimate their distance. Let me give you an example. Consider the classic &#39;rainbow&#39; palette (Matlab refers to this as &#39;jet colors&#39;)</div><div class='line' id='LC468'><br/></div><div class='line' id='LC469'>```{r rainb pal, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;the classic rainbow colour palette&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC470'>pal(rainbow(100))</div><div class='line' id='LC471'>```</div><div class='line' id='LC472'><br/></div><div class='line' id='LC473'>It becomes obvious that there are several thin bands in this colour palette (yellow, aquamarine, purple) which do not map the distances between variable values accurately. That is, the distance between two values located in/around the yellow region of the palette will seem to change faster than, for example somewhere in the green region (and red and blue).</div><div class='line' id='LC474'><br/></div><div class='line' id='LC475'>When converted to grey-scale this palette produces a hell of a mess...</div><div class='line' id='LC476'><br/></div><div class='line' id='LC477'>```{r rainb pal grey, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;same palette as above in grey-scale&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC478'>pal(desaturate(rainbow(100)))</div><div class='line' id='LC479'>```</div><div class='line' id='LC480'><br/></div><div class='line' id='LC481'>Note, that this palette is maybe the most widely used colour coding palette for mapping a sequential continuous variable to colour. We will see further examples later on...</div><div class='line' id='LC482'><br/></div><div class='line' id='LC483'>I hope you get the idea that this is not a good way of mapping a sequential variable to colour!</div><div class='line' id='LC484'><br/></div><div class='line' id='LC485'>```hcl()``` produces so-called perceptually uniform colour palettes and is therefore much better suited to represent sequential data.</div><div class='line' id='LC486'><br/></div><div class='line' id='LC487'>```{r hcl pal, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;an hcl based multi-hue colour palette with increasing luminence towards the red end&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC488'>pal(clrs.hcl(100))</div><div class='line' id='LC489'>```</div><div class='line' id='LC490'><br/></div><div class='line' id='LC491'>We see that the different hues are spread constantly over the palette and therefore it is easy to estimate distances between data values from the changes in colour.   </div><div class='line' id='LC492'>The fact that we also vary luminance here means that we get a very light colour at one end (here the red end - which is a more of a pink tone than red). This might, at first sight, not seem very aesthetically pleasing, yet it enables us to encode our data even in grey-scale...</div><div class='line' id='LC493'><br/></div><div class='line' id='LC494'>```{r hcl pal grey, tidy = FALSE, fig.width = 8, fig.height = 3, fig.cap = fn(&quot;same palette as above in grey-scale&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC495'>pal(desaturate(clrs.hcl(100)))</div><div class='line' id='LC496'>```</div><div class='line' id='LC497'><br/></div><div class='line' id='LC498'>As a general suggestion I encourage you to make use of the hcl colour space whenever you can. But most importantly, it is essential to do some thinking before mapping data to colour. The most basic question you always need to ask yourself is **what is the nature of the data that I want to show? - sequential, diverging or qualitative?** Once you know this, it is easy to choose the appropriate colour palette for the mapping. A good place to start for choosing perceptually well thought through palettes is [the colorbrewer website](http://www.colorbrewer2.org).</div><div class='line' id='LC499'><br/></div><div class='line' id='LC500'>Right, so now that we have established some principles about colour representation, we can go ahead and use this to show the density of the points in our scatter plot.</div><div class='line' id='LC501'><br/></div><div class='line' id='LC502'>To do this we need a so-called &#39;2 dimensional kernel density estimator&#39;. I won&#39;t go into much detail about the density estimation here. What is important for our purpose is that we actually need to estimate this twice. Once globally, meaning for the whole data set, in order to find the absolute extremes (minimum and maximum) of our data distribution. This is important for the colour mapping, because the values of each panel need to be mapped to a common scale in order to interpret them. In other words, this way we are making sure that the similar values of our data are represented by similar shades of, let&#39;s say red.</div><div class='line' id='LC503'><br/></div><div class='line' id='LC504'>However, in order to be able to estimate the density for each of our panels we also need to do the same calculation in our panel function. </div><div class='line' id='LC505'><br/></div><div class='line' id='LC506'>Essentially what we are creating is a gridded data set (like a photo) of the density of points within each of the defined pixels. The ```lattice``` function for plotting gridded data is called ```levelplot()```.</div><div class='line' id='LC507'><br/></div><div class='line' id='LC508'>Here&#39;s the code</div><div class='line' id='LC509'><br/></div><div class='line' id='LC510'>```{r latt dens scat, tidy = FALSE, fig.cap = fn(&quot;a lattice panel plot showing the point density within each panel&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC511'>xy &lt;- kde2d(x = diamonds$carat, y = diamonds$price, n = 100) </div><div class='line' id='LC512'>xy.tr &lt;- con2tr(xy)</div><div class='line' id='LC513'>offset &lt;- max(xy.tr$z) * 0.2</div><div class='line' id='LC514'>z.range &lt;- seq(min(xy.tr$z), max(xy.tr$z) + offset, offset * 0.01)</div><div class='line' id='LC515'><br/></div><div class='line' id='LC516'>l.sc &lt;- update(scatter.lattice, aspect = 1, par.settings = my.theme, </div><div class='line' id='LC517'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between = list(x = 0.3, y = 0.3),</div><div class='line' id='LC518'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel=function(x,y) {</div><div class='line' id='LC519'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xy &lt;- kde2d(x,y, n = 100) </div><div class='line' id='LC520'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xy.tr &lt;- con2tr(xy)                 </div><div class='line' id='LC521'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.levelplot(xy.tr$x, xy.tr$y, xy.tr$z, asp = 1,</div><div class='line' id='LC522'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subscripts = seq(nrow(xy.tr)), </div><div class='line' id='LC523'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contour = FALSE, region = TRUE, </div><div class='line' id='LC524'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = c(&quot;white&quot;, </div><div class='line' id='LC525'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rev(clrs.hcl(10000))),</div><div class='line' id='LC526'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = z.range)</div><div class='line' id='LC527'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1 &lt;- lm(y ~ x)</div><div class='line' id='LC528'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm1sum &lt;- summary(lm1)</div><div class='line' id='LC529'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r2 &lt;- lm1sum$adj.r.squared</div><div class='line' id='LC530'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.abline(a = lm1$coefficients[1], </div><div class='line' id='LC531'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b = lm1$coefficients[2])</div><div class='line' id='LC532'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel.text(labels = </div><div class='line' id='LC533'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bquote(italic(R)^2 == </div><div class='line' id='LC534'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.(format(r2, digits = 3))),</div><div class='line' id='LC535'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = 4, y = 1000)</div><div class='line' id='LC536'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#panel.xyplot(x,y) </div><div class='line' id='LC537'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </div><div class='line' id='LC538'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) </div><div class='line' id='LC539'><br/></div><div class='line' id='LC540'>print(l.sc)</div><div class='line' id='LC541'>```</div><div class='line' id='LC542'><br/></div><div class='line' id='LC543'>It should not go unnoticed that there is a panel function in ```lattice``` that does this for you. The function is called ```panel.smoothScatter()``` and unless we need to specify a custom colour palette, this is more than sufficient.</div><div class='line' id='LC544'><br/></div><div class='line' id='LC545'>As a hint, if you want to use this panel function with your own colour palette you need to make sure that your palette starts with white as otherwise things will look really weird...</div><div class='line' id='LC546'><br/></div><div class='line' id='LC547'>```{r latt smooth scat, tidy = FALSE, fig.cap = fn(&quot;a lattice panel plot showing the point density within each panel using the panel function smoothScatter()&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC548'>l.sc.smooth &lt;- update(scatter.lattice, aspect = 1, </div><div class='line' id='LC549'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par.settings = my.theme, </div><div class='line' id='LC550'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between = list(x = 0.3, y = 0.3),</div><div class='line' id='LC551'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panel = panel.smoothScatter)</div><div class='line' id='LC552'><br/></div><div class='line' id='LC553'>print(l.sc.smooth)</div><div class='line' id='LC554'>```</div><div class='line' id='LC555'><br/></div><div class='line' id='LC556'>This representation of our data basically adds another dimension to our plot which enables us to see that no matter what the quality of the diamond, most of the diamonds are actually of low carat and low price. Whether this is good or bad news, depends on your interpretation (and the size of your wallet, of course).</div><div class='line' id='LC557'><br/></div><div class='line' id='LC558'>#### 2.1.2. The _ggplot2_ way</div><div class='line' id='LC559'><br/></div><div class='line' id='LC560'>Now let&#39;s try to recreate what we have achieved with ```lattice``` using ```ggplot2```.</div><div class='line' id='LC561'><br/></div><div class='line' id='LC562'>```ggplot2``` is radically different from the way that ```lattice``` works. ```lattice``` is much closer to the traditional way of plotting in R. There are different functions for different types of plots. In ```ggplot2``` this is different. Every plot we want to draw, is, at a fundamental level, created in exactly the same way. What differs are the subsequent calls on how to represent the individual plot components (basically ```x``` and ```y```). This means a much more consistent way of *building* visualisations, but it also means that things are rather different from what you might have learned about syntax and structure of (plotting) objects in R. But not to worry, even I managed to understand how thing are done in ```ggplot2``` (and prior to writing this I had almost never used it before).</div><div class='line' id='LC563'><br/></div><div class='line' id='LC564'>Before I get carried away too much let&#39;s jump right into our first plot using ```ggplot2```</div><div class='line' id='LC565'><br/></div><div class='line' id='LC566'>```{r gg scat, tidy = FALSE, fig.cap = fn(&quot;a basic scatter plot created with ggplot2&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC567'>scatter.ggplot &lt;- ggplot(aes(x = carat, y = price), data = diamonds)</div><div class='line' id='LC568'><br/></div><div class='line' id='LC569'>g.sc &lt;- scatter.ggplot + geom_point()</div><div class='line' id='LC570'><br/></div><div class='line' id='LC571'>print(g.sc)</div><div class='line' id='LC572'>```</div><div class='line' id='LC573'><br/></div><div class='line' id='LC574'>Similar to ```lattice```, plots are (usually) stored in objects. But that is about all the similarity there is.</div><div class='line' id='LC575'><br/></div><div class='line' id='LC576'>Let&#39;s look at the above code in a little more detail. The first line is the fundamental definition of **what** we want to plot. We provide the &#39;aesthetics&#39; for the plot (```aes()```) We state that we want the values on the x-axis to represent carat and the y-values are price. The data set to take these variables from is the diamonds data set. That&#39;s basically it, and this will not change a hell of a lot in the subsequent plotting routines.</div><div class='line' id='LC577'><br/></div><div class='line' id='LC578'>What will change in the plotting code chunks that follow is **how** we want the relationship between these variables to be represented in our plot. This is done by defining so-called geometries (```geom_...()```). In this first case we stated that we want the relationship between ```x``` and ```y``` to be represented as points, hence we used ```geom_point()```.</div><div class='line' id='LC579'><br/></div><div class='line' id='LC580'>If we wanted to provide a plot showing the relationship between price and carat in panels representing the quality of the diamonds, we need what in ```gglot2``` is called facetting (panels in ```lattice```). To achieve this, we simply repeat our plotting call from earlier and add another layer to the call which does the facetting.</div><div class='line' id='LC581'><br/></div><div class='line' id='LC582'>```{r gg facet scat, tidy = FALSE, fig.cap = fn(&quot;ggplot2 version of a facetted plot&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC583'>g.sc &lt;- scatter.ggplot + </div><div class='line' id='LC584'>&nbsp;&nbsp;geom_point() +</div><div class='line' id='LC585'>&nbsp;&nbsp;facet_wrap(~ cut)</div><div class='line' id='LC586'><br/></div><div class='line' id='LC587'>print(g.sc)</div><div class='line' id='LC588'>```</div><div class='line' id='LC589'><br/></div><div class='line' id='LC590'>One thing that some people dislike about the default settings in ```ggplot2``` is the grey background of the plots. This grey background is, in my opinion, a good idea when colors are involved as it tends to increase the contrast of the colours. If, however, the plot is a simple black-and-white scatter plot as in our case here, a white panel, or better facet background seems more reasonable. We can easily change this using a pre-defined theme called ```theme_bw()```.</div><div class='line' id='LC591'><br/></div><div class='line' id='LC592'>In order to provide the regression line for each panel like we did in ```lattice```, we need a function called ```stat_smooth()```. This is fundamentally the same function that we used earlier, as the ```panel.smoother()``` in ```lattice``` is based on ```stat_smooth()```.</div><div class='line' id='LC593'><br/></div><div class='line' id='LC594'>Putting this together we could do something like this (note that we also change the number of rows and columns into which the facets should be arranged):</div><div class='line' id='LC595'><br/></div><div class='line' id='LC596'>```{r gg facet smooth scat, tidy = FALSE, fig.cap = fn(&quot;a ggplot2 panel plot with modified theme and added regression lines and confidence bands for each panel&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC597'>g.sc &lt;- scatter.ggplot + </div><div class='line' id='LC598'>&nbsp;&nbsp;#geom_tile() +</div><div class='line' id='LC599'>&nbsp;&nbsp;geom_point(colour = &quot;grey60&quot;) +</div><div class='line' id='LC600'>&nbsp;&nbsp;facet_wrap(~ cut, nrow = 2, ncol = 3) +</div><div class='line' id='LC601'>&nbsp;&nbsp;theme_bw() +</div><div class='line' id='LC602'>&nbsp;&nbsp;stat_smooth(method = &quot;lm&quot;, se = TRUE, </div><div class='line' id='LC603'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = &quot;black&quot;, colour = &quot;black&quot;)</div><div class='line' id='LC604'><br/></div><div class='line' id='LC605'>print(g.sc)</div><div class='line' id='LC606'>```</div><div class='line' id='LC607'><br/></div><div class='line' id='LC608'>Simple and straight forward, and the result looks rather similar to the ```lattice``` version we created earlier.</div><div class='line' id='LC609'><br/></div><div class='line' id='LC610'>Creating a point density scatter plot in ```ggplot2``` is actually a fair bit easier than in ```lattice```, as ```gglot2``` provides several predefined ```stat_...()``` function calls. One of these is designed to create 2 dimensional kernel density estimations, just what we want. However, this is where the syntax of ```ggplot2``` really becomes a bit abstract. he definition of the fill argument of this call is ```..density..```, which, at least to me, does not seem very intuitive. </div><div class='line' id='LC611'><br/></div><div class='line' id='LC612'>Furthermore, it is not quite sufficient to supply the stat function, we also need to state how to map the colours to that stat definition. Therefore, we need yet another layer which defines what colour palette to use. As we want a continuous variable (density) to be filled with a gradient of n colours, we need to use ```scale_fill_gradientn()``` in which we can define the colours we want to be used.</div><div class='line' id='LC613'><br/></div><div class='line' id='LC614'>```{r gg dens scat, tidy = FALSE, fig.cap = fn(&quot;ggplot2 version of a panel plot showing point densities in each panel&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC615'>g.sc &lt;- scatter.ggplot + </div><div class='line' id='LC616'>&nbsp;&nbsp;geom_tile() +</div><div class='line' id='LC617'>&nbsp;&nbsp;#geom_point(colour = &quot;grey60&quot;) +</div><div class='line' id='LC618'>&nbsp;&nbsp;facet_wrap(~ cut, nrow = 3, ncol = 2) +</div><div class='line' id='LC619'>&nbsp;&nbsp;theme_bw() +</div><div class='line' id='LC620'>&nbsp;&nbsp;stat_density2d(aes(fill = ..density..), n = 100,</div><div class='line' id='LC621'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geom = &quot;tile&quot;, contour = FALSE) +</div><div class='line' id='LC622'>&nbsp;&nbsp;scale_fill_gradientn(colours = c(&quot;white&quot;,</div><div class='line' id='LC623'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rev(clrs.hcl(100)))) +</div><div class='line' id='LC624'>&nbsp;&nbsp;stat_smooth(method = &quot;lm&quot;, se = FALSE, colour = &quot;black&quot;) +</div><div class='line' id='LC625'>&nbsp;&nbsp;coord_fixed(ratio = 5/30000)</div><div class='line' id='LC626'><br/></div><div class='line' id='LC627'>print(g.sc)</div><div class='line' id='LC628'>```</div><div class='line' id='LC629'><br/></div><div class='line' id='LC630'>&gt; ### ------------------------~~ Exercise V ~~-----------------------------</div><div class='line' id='LC631'>create a lattice &amp; a ggplot2 scatterplot of mean (y) vs. median (x)     </div><div class='line' id='LC632'>carat using the merged data set from exercise IV both with      </div><div class='line' id='LC633'>standard confidence intervals</div><div class='line' id='LC634'>&gt; ### ------------------------------~~ ° ~~------------------------------------</div><div class='line' id='LC635'><br/></div><div class='line' id='LC636'>### 2.2. Box an whisker plots</div><div class='line' id='LC637'><br/></div><div class='line' id='LC638'>I honestly don&#39;t have a lot to say about box and whisker plots. They are probably the most useful plots for showing the nature/distribution of your data and allow for some easy comparisons between different levels of a factor for example.</div><div class='line' id='LC639'><br/></div><div class='line' id='LC640'>see http://upload.wikimedia.org/wikipedia/commons/1/1a/Boxplot_vs_PDF.svg for a visual representation of the standard R settings of BW plots in relation to mean and standard deviation of a normal distribution.</div><div class='line' id='LC641'><br/></div><div class='line' id='LC642'>So without further ado, here&#39;s a basic lattice box and whisker plot.</div><div class='line' id='LC643'><br/></div><div class='line' id='LC644'>#### 2.2.1. The _lattice_ way</div><div class='line' id='LC645'><br/></div><div class='line' id='LC646'>```{r latt bw1, tidy = FALSE, fig.cap = fn(&quot;a basic box-whisker-plot produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC647'>bw.lattice &lt;- bwplot(price ~ color, data = diamonds)</div><div class='line' id='LC648'><br/></div><div class='line' id='LC649'>bw.lattice</div><div class='line' id='LC650'>```</div><div class='line' id='LC651'><br/></div><div class='line' id='LC652'>Not so very beautiful... So, let&#39;s again modify the standard ```par.settings``` so that we get an acceptable box and whisker plot.</div><div class='line' id='LC653'><br/></div><div class='line' id='LC654'>```{r latt bw2, tidy = FALSE, fig.cap = fn(&quot;lattice bw-plot with modified graphical parameter settings&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC655'>bw.theme &lt;- trellis.par.get()</div><div class='line' id='LC656'>bw.theme$box.dot$pch &lt;- &quot;|&quot;</div><div class='line' id='LC657'>bw.theme$box.rectangle$col &lt;- &quot;black&quot;</div><div class='line' id='LC658'>bw.theme$box.rectangle$lwd &lt;- 2</div><div class='line' id='LC659'>bw.theme$box.rectangle$fill &lt;- &quot;grey90&quot;</div><div class='line' id='LC660'>bw.theme$box.umbrella$lty &lt;- 1</div><div class='line' id='LC661'>bw.theme$box.umbrella$col &lt;- &quot;black&quot;</div><div class='line' id='LC662'>bw.theme$plot.symbol$col &lt;- &quot;grey40&quot;</div><div class='line' id='LC663'>bw.theme$plot.symbol$pch &lt;- &quot;*&quot;</div><div class='line' id='LC664'>bw.theme$plot.symbol$cex &lt;- 2</div><div class='line' id='LC665'>bw.theme$strip.background$col &lt;- &quot;grey80&quot;</div><div class='line' id='LC666'><br/></div><div class='line' id='LC667'>l.bw &lt;- update(bw.lattice, par.settings = bw.theme)</div><div class='line' id='LC668'><br/></div><div class='line' id='LC669'>print(l.bw)</div><div class='line' id='LC670'>```</div><div class='line' id='LC671'><br/></div><div class='line' id='LC672'>Much better, isn&#39;t it?</div><div class='line' id='LC673'><br/></div><div class='line' id='LC674'>```{r latt panel bw, tidy = FALSE, fig.cap = fn(&quot;a lattice panel bw-plot with box widths relative to number of observations and coloured boxes&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC675'>bw.lattice &lt;- bwplot(price ~ color | cut, data = diamonds,</div><div class='line' id='LC676'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asp = 1, as.table = TRUE, varwidth = TRUE)</div><div class='line' id='LC677'>l.bw &lt;- update(bw.lattice, par.settings = bw.theme, xlab = &quot;color&quot;, </div><div class='line' id='LC678'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = clrs.hcl(7),</div><div class='line' id='LC679'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xscale.components = xscale.components.subticks,</div><div class='line' id='LC680'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yscale.components = yscale.components.subticks)</div><div class='line' id='LC681'><br/></div><div class='line' id='LC682'>print(l.bw)</div><div class='line' id='LC683'>```</div><div class='line' id='LC684'><br/></div><div class='line' id='LC685'>In addition to the rather obvious provision of a color palette to to fill the boxes, in this final box &amp; whisker plot we have also told ```lattice``` to adjust the widths of the boxes so that they reflect the relative sizes of the data samples for each of the factors (colours). This is a rather handy way of providing insight into the data distribution along the factor of the x-axis. We can show this without having to provide any additional plot to highlight that some of the factor levels (i.e. colours) are much less represented than others (&#39;J&#39; compared to &#39;G&#39;, for example, especially for the &#39;Ideal&#39; quality class). </div><div class='line' id='LC686'><br/></div><div class='line' id='LC687'>#### 2.2.2. The _ggplot2_ way</div><div class='line' id='LC688'><br/></div><div class='line' id='LC689'>As much as I love ```lattice```, I always end up drawing box and whisker plots with ```ggplot2``` because they look so much nicer and there&#39;s no need to modify so many graphical parameter settings in order to get an acceptable result.</div><div class='line' id='LC690'><br/></div><div class='line' id='LC691'>You will see what I mean when we plot a ```ggplot2``` version using the default settings.</div><div class='line' id='LC692'><br/></div><div class='line' id='LC693'>```{r gg bw1, tidy = FALSE, fig.cap = fn(&quot;a basic ggplot2 bw-plot&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC694'>bw.ggplot &lt;- ggplot(diamonds, aes(x = color, y = price))</div><div class='line' id='LC695'><br/></div><div class='line' id='LC696'>g.bw &lt;- bw.ggplot + geom_boxplot()</div><div class='line' id='LC697'><br/></div><div class='line' id='LC698'>print(g.bw)</div><div class='line' id='LC699'>```</div><div class='line' id='LC700'><br/></div><div class='line' id='LC701'>This is much much better straight away!!</div><div class='line' id='LC702'><br/></div><div class='line' id='LC703'>And, as we&#39;ve already seen, the facetting is also just one more line...</div><div class='line' id='LC704'><br/></div><div class='line' id='LC705'>```{r gg facet bw, tidy = FALSE, fig.cap = fn(&quot;ggplot2 panel bw-plot&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC706'>bw.ggplot &lt;- ggplot(diamonds, aes(x = color, y = price))</div><div class='line' id='LC707'><br/></div><div class='line' id='LC708'>g.bw &lt;- bw.ggplot + </div><div class='line' id='LC709'>&nbsp;&nbsp;geom_boxplot(fill = &quot;grey90&quot;) +</div><div class='line' id='LC710'>&nbsp;&nbsp;theme_bw() +</div><div class='line' id='LC711'>&nbsp;&nbsp;facet_wrap(~ cut)</div><div class='line' id='LC712'><br/></div><div class='line' id='LC713'>print(g.bw)</div><div class='line' id='LC714'>```</div><div class='line' id='LC715'><br/></div><div class='line' id='LC716'>So far, you may have gotten the impression that pretty much everything is a little bit easier the ```ggplot2``` way. Well, a lot of things are, but some are not. If we wanted to highlight the relative sample sizes of the different colour levels like we did earlier in ```lattice``` (using ```varwidth = TRUE```) we have to put a little more effort into ```ggplot2```. Meaning, we have to calculate this ourselves. There is no built in functionality for this feature (yet), at least none that I am aware of.</div><div class='line' id='LC717'><br/></div><div class='line' id='LC718'>But, it is not too complicated. The equation for this adjustment is rather straight forward, we simply take the square root of the counts for each colour and divide it by the overall number of observations. Then we standardise this relative to the maximum of this calculation. As a final step, we need to break this down to each of the panels of the plot. This is the toughest part of it. I won&#39;t go into any detail here, but the ```llply``` pat of the following code chunk is basically the equivalent of what is going on behind the scenes of ```lattice``` (though ```lattice``` most likely does not use ```llply```).</div><div class='line' id='LC719'><br/></div><div class='line' id='LC720'>Anyway, it does not require too many lines of code to achieve the box width adjustment in ```ggplot2```.</div><div class='line' id='LC721'><br/></div><div class='line' id='LC722'>```{r gg facet width bw, tidy = FALSE, fig.cap = fn(&quot;a ggplot2 panel bw-plot with box widths relative to number of observations and coloured boxes&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC723'>w &lt;- sqrt(table(diamonds$color)/nrow(diamonds))</div><div class='line' id='LC724'>### standardise w to maximum value</div><div class='line' id='LC725'>w &lt;- w / max(w)</div><div class='line' id='LC726'><br/></div><div class='line' id='LC727'>g.bw &lt;- bw.ggplot + </div><div class='line' id='LC728'>&nbsp;&nbsp;facet_wrap(~ cut) +</div><div class='line' id='LC729'>&nbsp;&nbsp;llply(unique(diamonds$color), </div><div class='line' id='LC730'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(i) geom_boxplot(fill = clrs.hcl(7)[i],</div><div class='line' id='LC731'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width = w[i], outlier.shape = &quot;*&quot;,</div><div class='line' id='LC732'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outlier.size = 3,</div><div class='line' id='LC733'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = subset(diamonds, color == i))) +</div><div class='line' id='LC734'>&nbsp;&nbsp;theme_bw()</div><div class='line' id='LC735'><br/></div><div class='line' id='LC736'>print(g.bw)</div><div class='line' id='LC737'>```</div><div class='line' id='LC738'><br/></div><div class='line' id='LC739'>The result is very very similar to what we have achieved earlier with ```lattice```. In summary, lattice needs a little more care to adjust the standard graphical parameters, whereas ```ggplot2``` requires us to manually calculate the width of the boxes. I leave it up to you, which way suits you better... I have already made my choice a few years ago ;-)</div><div class='line' id='LC740'><br/></div><div class='line' id='LC741'>Boxplots are, as mentioned above, a brilliant way to visualise data distribution(s). Their strength lies in the comparability of different classes as they are plotted next to each other using a common scale. Another, more classical - as parametric - way are histograms (and densityplots).</div><div class='line' id='LC742'><br/></div><div class='line' id='LC743'>### 2.2. Histograms &amp; densityplots</div><div class='line' id='LC744'><br/></div><div class='line' id='LC745'>The classic way to visualise the distribution any data are histograms. They are closely related to density plots, where the individual data points are not binned into certain classes but a continuous density function is calculated to show the distribution. Both approaches reflect a certain level of abstraction (binning vs. functional representation), therefore a general formulation of which of them is more accepted is hard. In any case, the both achieve exactly the same result, they will show us the distribution of our data.</div><div class='line' id='LC746'><br/></div><div class='line' id='LC747'>#### 2.2.1. The _lattice_ way</div><div class='line' id='LC748'><br/></div><div class='line' id='LC749'>As is to be expected with ```lattice```, the default plotting routine does not really satisfy the (or maybe better my) aesthetic expectations.</div><div class='line' id='LC750'><br/></div><div class='line' id='LC751'>```{r altt hist, tidy = FALSE, fig.cap = fn(&quot;a basic histogram produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC752'>hist.lattice &lt;- histogram(~ price, data = diamonds)</div><div class='line' id='LC753'>hist.lattice</div><div class='line' id='LC754'>```</div><div class='line' id='LC755'><br/></div><div class='line' id='LC756'>This is even worse for the default density plot...</div><div class='line' id='LC757'><br/></div><div class='line' id='LC758'>```{r latt dens, tidy = FALSE, fig.cap = fn(&quot;a basic density plot produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC759'>dens.lattice &lt;- densityplot(~ price, data = diamonds)</div><div class='line' id='LC760'>dens.lattice</div><div class='line' id='LC761'>```</div><div class='line' id='LC762'><br/></div><div class='line' id='LC763'>Yet, as we&#39;ve already adjusted our global graphical parameter settings, we can now easily modify this.</div><div class='line' id='LC764'><br/></div><div class='line' id='LC765'>```{r latt panel hist, tidy = FALSE, fig.cap = fn(&quot;a panel histogram with modofied graphical parameter settings&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC766'>hist.lattice &lt;- histogram(~ price | color, </div><div class='line' id='LC767'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = diamonds,</div><div class='line' id='LC768'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as.table = TRUE,</div><div class='line' id='LC769'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par.settings = my.theme)</div><div class='line' id='LC770'><br/></div><div class='line' id='LC771'>l.his &lt;- hist.lattice</div><div class='line' id='LC772'><br/></div><div class='line' id='LC773'>print(l.his)</div><div class='line' id='LC774'>```</div><div class='line' id='LC775'><br/></div><div class='line' id='LC776'>Now, this is a plot that every journal editor will very likely accept.</div><div class='line' id='LC777'><br/></div><div class='line' id='LC778'>Until now, we have seen how to condition our plots according to one factorial variable (```diamonds$cut```). It is, in theory, possible to condition plots on any number of factorial variable, though more than two is seldom advisable. Two, however, is definitely acceptable and still easy enough to perceive and interpret. In ```lattice``` this is generally done as follows.</div><div class='line' id='LC779'><br/></div><div class='line' id='LC780'>```</div><div class='line' id='LC781'>y ~ x | g + f</div><div class='line' id='LC782'>```</div><div class='line' id='LC783'><br/></div><div class='line' id='LC784'>where ```g``` and ```f``` are the factorial variables used for the conditioning.</div><div class='line' id='LC785'><br/></div><div class='line' id='LC786'>In the below code chunk we are first creating out plot object and the we are using a function called ```useOuterStrips()``` which makes sure that the strips that correspond to the conditioning variables are plotted on both the top and the left side of our plot. The default ```lattice``` setting is to plot both at the top, which makes the navigation through the plot by the viewer a little more difficult.</div><div class='line' id='LC787'><br/></div><div class='line' id='LC788'>Another default setting for densityplots in ```lattice``` is to plot a point (circle) for each observation of our variable (price) at the bottom of the plot along the x--axis. In our case, as we have a lot of data points, this is not desirable, so we set the argument ```plot.points``` to ```FALSE```.</div><div class='line' id='LC789'><br/></div><div class='line' id='LC790'>```{r latt panel dens, tidy = FALSE, fig.cap = fn(&quot;a panel density plot conditioned according to 2 variables using lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC791'>dens.lattice &lt;- densityplot(~ price | cut + color, </div><div class='line' id='LC792'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = diamonds,</div><div class='line' id='LC793'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as.table = TRUE,</div><div class='line' id='LC794'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par.settings = my.theme,</div><div class='line' id='LC795'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plot.points = FALSE,</div><div class='line' id='LC796'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between = list(x = 0.2, y = 0.2),</div><div class='line' id='LC797'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scales = list(x = list(rot = 45)))</div><div class='line' id='LC798'><br/></div><div class='line' id='LC799'>l.den &lt;- useOuterStrips(dens.lattice)</div><div class='line' id='LC800'><br/></div><div class='line' id='LC801'>print(l.den)</div><div class='line' id='LC802'>```</div><div class='line' id='LC803'><br/></div><div class='line' id='LC804'>You may have noticed that the lines of the densityplot are plotted in a light shade of blue (cornflowerblue to be precise). I it up to you to change this yourself...</div><div class='line' id='LC805'><br/></div><div class='line' id='LC806'>Another thing you may notice when looking at the above plot is that the x-axis labels are rotated by 45 degrees. This one I also leave up to you to figure out... ;-)</div><div class='line' id='LC807'><br/></div><div class='line' id='LC808'>#### 2.2.2. The _ggplot2_ way</div><div class='line' id='LC809'><br/></div><div class='line' id='LC810'>Much like with the box and whisker plot, the default settings of ```ggplot2``` are quite a bit nicer for both histogram and densityplot.</div><div class='line' id='LC811'><br/></div><div class='line' id='LC812'>```{r gg hist, tidy = FALSE, fig.cap = fn(&quot;a basic histogram produced with ggplot2&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC813'>hist.ggplot &lt;- ggplot(diamonds, aes(x = price))</div><div class='line' id='LC814'><br/></div><div class='line' id='LC815'>g.his &lt;- hist.ggplot +</div><div class='line' id='LC816'>&nbsp;&nbsp;geom_histogram()</div><div class='line' id='LC817'><br/></div><div class='line' id='LC818'>print(g.his)</div><div class='line' id='LC819'>```</div><div class='line' id='LC820'><br/></div><div class='line' id='LC821'>One thing that is really nice about the ```ggplot2``` densityplots that it is so easy to fill the area under the curve which really helps the visual representation of the data.</div><div class='line' id='LC822'><br/></div><div class='line' id='LC823'>```{r gg dens, tidy = FALSE, fig.cap = fn(&quot;a basic density plot produced with ggplot2&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC824'>dens.ggplot &lt;- ggplot(diamonds, aes(x = price))</div><div class='line' id='LC825'><br/></div><div class='line' id='LC826'>g.den &lt;- dens.ggplot +</div><div class='line' id='LC827'>&nbsp;&nbsp;geom_density(fill = &quot;black&quot;, alpha = 0.5)</div><div class='line' id='LC828'><br/></div><div class='line' id='LC829'>print(g.den)</div><div class='line' id='LC830'>```</div><div class='line' id='LC831'><br/></div><div class='line' id='LC832'>Just as before, we are encountering again the rather peculiar way of ```ggplot2``` to adjust certain default settings to suit our needs (likes). In we wanted to show percentages instead of counts for the histograms, we again need to use the strange ```..something..``` syntax.</div><div class='line' id='LC833'><br/></div><div class='line' id='LC834'>Another thing I want to highlight in the following code chunk is the way to achieve binary conditioning in ```ggplot2```. This is done as follows:</div><div class='line' id='LC835'><br/></div><div class='line' id='LC836'>```</div><div class='line' id='LC837'>facet_grid(g ~ f)</div><div class='line' id='LC838'>```</div><div class='line' id='LC839'><br/></div><div class='line' id='LC840'>where, again, ```g``` and ```f``` are the two variables used for the conditioning.</div><div class='line' id='LC841'><br/></div><div class='line' id='LC842'>```{r gg facet hist, tidy = FALSE, fig.cap = fn(&quot;a ggplot2 panel histogram with y-axis labelled according to percentages&quot;), fig.align = &#39;center&#39;, message = FALSE}</div><div class='line' id='LC843'>g.his &lt;- hist.ggplot +</div><div class='line' id='LC844'>&nbsp;&nbsp;geom_histogram(aes(y = ..ncount..)) +</div><div class='line' id='LC845'>&nbsp;&nbsp;scale_y_continuous(labels = percent_format()) +</div><div class='line' id='LC846'>&nbsp;&nbsp;facet_grid(color ~ cut) + </div><div class='line' id='LC847'>&nbsp;&nbsp;ylab(&quot;Percent&quot;)</div><div class='line' id='LC848'><br/></div><div class='line' id='LC849'>print(g.his)</div><div class='line' id='LC850'>```</div><div class='line' id='LC851'><br/></div><div class='line' id='LC852'>Similar to our ```lattice``` approach we&#39;re going to rotate the x-axis labels by 45 degrees.</div><div class='line' id='LC853'><br/></div><div class='line' id='LC854'>```{r gg facet density, tidy = FALSE, fig.cap = fn(&quot;a ggplot2 panel density plot conditioned according to 2 variables&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC855'>dens.ggplot &lt;- ggplot(diamonds, aes(x = price))</div><div class='line' id='LC856'><br/></div><div class='line' id='LC857'>g.den &lt;- dens.ggplot +</div><div class='line' id='LC858'>&nbsp;&nbsp;geom_density(fill = &quot;black&quot;, alpha = 0.5) +</div><div class='line' id='LC859'>&nbsp;&nbsp;facet_grid(color ~ cut) +</div><div class='line' id='LC860'>&nbsp;&nbsp;theme_bw() +</div><div class='line' id='LC861'>&nbsp;&nbsp;theme(axis.text.x = element_text(angle = 45, hjust = 1))</div><div class='line' id='LC862'><br/></div><div class='line' id='LC863'>print(g.den)</div><div class='line' id='LC864'>```</div><div class='line' id='LC865'><br/></div><div class='line' id='LC866'>Ok, another thing we might want to show is the value of a certain estimated value (like the mean of our sample) including error bars.</div><div class='line' id='LC867'><br/></div><div class='line' id='LC868'>### 2.3. Plotting error bars</div><div class='line' id='LC869'><br/></div><div class='line' id='LC870'>#### 2.3.1. The _lattice_ way</div><div class='line' id='LC871'><br/></div><div class='line' id='LC872'>Honestly, ```lattice``` sucks at plotting error bars... Therefore, we will only explore one way of achieving this. In case you really want to explore this further, I refer you to Stackoverflow and other R related forums/lists, where you will find a solution, but I doubt that you will like it... Error bars are much easier plotted using ```ggplot2```.</div><div class='line' id='LC873'><br/></div><div class='line' id='LC874'>```{r latt err, tidy = FALSE, fig.cap = fn(&quot;a basic dotplot with error bars produced with lattice&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC875'>my.theme$dot.symbol$col &lt;- &quot;black&quot;</div><div class='line' id='LC876'>my.theme$dot.symbol$cex &lt;- 1.5</div><div class='line' id='LC877'>my.theme$plot.line$col &lt;- &quot;black&quot;</div><div class='line' id='LC878'>my.theme$plot.line$lwd &lt;- 1.5</div><div class='line' id='LC879'><br/></div><div class='line' id='LC880'>dmod &lt;- lm(price ~ cut, data = diamonds)</div><div class='line' id='LC881'>cuts &lt;- data.frame(cut = unique(diamonds$cut), </div><div class='line' id='LC882'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;predict(dmod, data.frame(cut = unique(diamonds$cut)), </div><div class='line' id='LC883'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;se = TRUE)[c(&quot;fit&quot;, &quot;se.fit&quot;)])</div><div class='line' id='LC884'><br/></div><div class='line' id='LC885'>errbar.lattice &lt;- Hmisc::Dotplot(cut ~ Cbind(fit, </div><div class='line' id='LC886'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit + se.fit, </div><div class='line' id='LC887'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fit - se.fit),</div><div class='line' id='LC888'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = cuts, </div><div class='line' id='LC889'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par.settings = my.theme)</div><div class='line' id='LC890'><br/></div><div class='line' id='LC891'>l.err &lt;- errbar.lattice</div><div class='line' id='LC892'><br/></div><div class='line' id='LC893'>print(l.err)</div><div class='line' id='LC894'>```</div><div class='line' id='LC895'><br/></div><div class='line' id='LC896'>#### 2.3.2. The _ggplot2_ way</div><div class='line' id='LC897'><br/></div><div class='line' id='LC898'>As mentioned above, when plotting error bars ```ggplot2``` is much easier. Whether this is because of the general ongoing discussion about the usefulness of these plots I do not want to judge.</div><div class='line' id='LC899'><br/></div><div class='line' id='LC900'>Anyway, plotting error bars in ```gglplot2``` is as easy as everything else...</div><div class='line' id='LC901'><br/></div><div class='line' id='LC902'>```{r gg err, tidy = FALSE, fig.cap = fn(&quot;a basic dotplot with error bars produced with ggplot2&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC903'>errbar.ggplot &lt;- ggplot(cuts, aes(cut, fit, ymin = fit - se.fit, </div><div class='line' id='LC904'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ymax=fit + se.fit))</div><div class='line' id='LC905'>g.err &lt;- errbar.ggplot + </div><div class='line' id='LC906'>&nbsp;&nbsp;geom_pointrange() +</div><div class='line' id='LC907'>&nbsp;&nbsp;coord_flip() +</div><div class='line' id='LC908'>&nbsp;&nbsp;theme_classic()</div><div class='line' id='LC909'><br/></div><div class='line' id='LC910'>print(g.err)</div><div class='line' id='LC911'>```</div><div class='line' id='LC912'><br/></div><div class='line' id='LC913'>Especially, when plotting them as part of a bar plot.</div><div class='line' id='LC914'><br/></div><div class='line' id='LC915'>```{r gg err bar, tidy = FALSE, fig.cap = fn(&quot;a ggplot2 bar plot with error bars&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC916'>g.err &lt;- errbar.ggplot + </div><div class='line' id='LC917'>&nbsp;&nbsp;geom_bar(fill = &quot;grey80&quot;) +</div><div class='line' id='LC918'>&nbsp;&nbsp;geom_errorbar(width = 0.2) +</div><div class='line' id='LC919'>&nbsp;&nbsp;coord_flip() +</div><div class='line' id='LC920'>&nbsp;&nbsp;theme_classic()</div><div class='line' id='LC921'><br/></div><div class='line' id='LC922'>print(g.err)</div><div class='line' id='LC923'>```</div><div class='line' id='LC924'><br/></div><div class='line' id='LC925'>Just as before (with the box widths) though, applying this to each panel is a little more complicated...</div><div class='line' id='LC926'><br/></div><div class='line' id='LC927'>```{r gg facet err bar, tidy = FALSE, concordance = TRUE, fig.cap = fn(&quot;a ggplot2 panel bar plot with error bars and modified fill colours&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC928'>errbar.ggplot.facets &lt;- ggplot(diamonds, aes(x = color, y = price))</div><div class='line' id='LC929'><br/></div><div class='line' id='LC930'>### function to calculate the standard error of the mean</div><div class='line' id='LC931'>se &lt;- function(x) sd(x)/sqrt(length(x))</div><div class='line' id='LC932'><br/></div><div class='line' id='LC933'>### function to be applied to each panel/facet</div><div class='line' id='LC934'>my.fun &lt;- function(x) {</div><div class='line' id='LC935'>&nbsp;&nbsp;data.frame(ymin = mean(x) - se(x), </div><div class='line' id='LC936'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ymax = mean(x) + se(x), </div><div class='line' id='LC937'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = mean(x))</div><div class='line' id='LC938'>&nbsp;&nbsp;}</div><div class='line' id='LC939'><br/></div><div class='line' id='LC940'>g.err.f &lt;- errbar.ggplot.facets + </div><div class='line' id='LC941'>&nbsp;&nbsp;stat_summary(fun.y = mean, geom = &quot;bar&quot;, </div><div class='line' id='LC942'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = clrs.hcl(7)) + </div><div class='line' id='LC943'>&nbsp;&nbsp;stat_summary(fun.data = my.fun, geom = &quot;linerange&quot;) + </div><div class='line' id='LC944'>&nbsp;&nbsp;facet_wrap(~ cut) +</div><div class='line' id='LC945'>&nbsp;&nbsp;theme_bw()</div><div class='line' id='LC946'><br/></div><div class='line' id='LC947'>print(g.err.f)</div><div class='line' id='LC948'><br/></div><div class='line' id='LC949'>```</div><div class='line' id='LC950'><br/></div><div class='line' id='LC951'>Still, trust me on this, much much easier than to achieve the same result in ```lattice```.</div><div class='line' id='LC952'><br/></div><div class='line' id='LC953'>## 3. Manipulating plots with the grid package</div><div class='line' id='LC954'><br/></div><div class='line' id='LC955'>Ok, so now we have seen how to produce a variety of widely used plot types using both ```lattice``` and ```ggplot2```. I hope that, apart from the specifics, you also obtained a general idea of how these two packages work and how you may use the various things we&#39;ve touched upon here in scenarios other than the ones provided here.</div><div class='line' id='LC956'><br/></div><div class='line' id='LC957'>Now, we&#39;re moving on to a more basic and much more flexible level of modifying, constructing and arranging graphs. Both, ```lattice``` and ```ggplot2``` are based upon the ```grid``` package. This means that we can use this package to fundamentally modify whatever we&#39;ve produced (remember, we&#39;re always storing our plots in objects) in a much more flexible way that provided by any pf these packages.</div><div class='line' id='LC958'><br/></div><div class='line' id='LC959'>With his ```grid``` package, Paul Murrell has achieved nothing less than a, in my opinion, much more flexible and powerful plotting framework for R. As a side note, this has already been &#39;officially&#39; recognised as he is now member of the core team (at least I think so) and his ```grid``` package is now shipped with the base version of R. This means that we don&#39;t have to install the package anymore (however, we still have to load it via ```library(grid)```.</div><div class='line' id='LC960'><br/></div><div class='line' id='LC961'>In order to fully appreciate the possibilities of the ```grid``` package, it helps to think of this package as a package for **drawing** things. Yes, we&#39;re not producing statistical plots as such (for this we have ```lattice``` and ```ggplot2```), we&#39;re actually *drawing** things!</div><div class='line' id='LC962'><br/></div><div class='line' id='LC963'>The fundamental features of the ```grid``` package are the ```viewports```. By default, the whole plotting area, may it be the standard R plotting device or the png plotting device, is considered as the root viewport (basically like the ```home/&lt;username&gt;``` folder on your linux system or the ```Users\&lt;username&gt;``` folder in windows). In this viewport we now have the possibility to specify other viewports which are relative to the root viewport (just like the ```Users&lt;username&gt;\Documents``` folder in windows or - to provide a different example - the ```home/&lt;username&gt;/Downloads``` folder in linux). </div><div class='line' id='LC964'><br/></div><div class='line' id='LC965'>The very very important thing to realise here is that in order to do anything in this folder (be it creating another sub-folder or simply saving a file or whatever), we need to first **create** the folder and then we also need to **navigate/change/go** into the folder. If you keep this in mind, you will quickly understand the fundamental principle of ```grid```.</div><div class='line' id='LC966'><br/></div><div class='line' id='LC967'>When we start using the ```grid``` package, we always start with the &#39;root&#39; viewport. This is already available, it is created for us, we don&#39;t need to do anything. This is our starting point. The really neat thing about ```grid``` is that each viewport is, by default, defined as both x and y ranging from 0 - 1. In the lower left corner x = 0 and y = 0. The lower right corner is x = 1 &amp; y = 0, the upper right corner x = 1 &amp; y = 1 and so on... It is, however, possible to specify a myriad of different unit systems (type, with the ```grid``` package loaded, ```?unit``` to get an overview of what is available). I usually stick to these default settings called ```npc - natural parent coordinates``` which range from 0 - 1 in each direction, as this makes setting up viewports very intuitive.</div><div class='line' id='LC968'><br/></div><div class='line' id='LC969'>A viewport needs some basic specifications for it to be located somewhere in the plotting area (the current viewport). These are:</div><div class='line' id='LC970'><br/></div><div class='line' id='LC971'>* x - the location along the x-axis</div><div class='line' id='LC972'>* y - the location along the y -axis</div><div class='line' id='LC973'>* width - the width of the viewport</div><div class='line' id='LC974'>* height - the height of the viewport</div><div class='line' id='LC975'>* just - the justification of the viewport in both x and y directions</div><div class='line' id='LC976'><br/></div><div class='line' id='LC977'>`width` and `height` should be rather self-explanatory.   </div><div class='line' id='LC978'>`x`, `y` and `just` are a bit more mind-bending. As default, `x` and `y` are 0.5 and `just` is `c(centre, centre)`. This means that the new viewport will be positioned at `x = 0.5` and `y = 0.5`. As the default of `just` is `centre` this means that a new viewport will be created at the midpoint of the current viewport (0.5 &amp; 0.5) and it will be centered on this point. It helps to think of the `just` specification in the same way that you provide your text justification in Word (left, right, centre &amp; justified). Let us try a first example which should highlight the way this works</div><div class='line' id='LC979'><br/></div><div class='line' id='LC980'>```{r, include = FALSE}</div><div class='line' id='LC981'>## this is needed to keep the graphical device open so that we can build </div><div class='line' id='LC982'>## our layered grid figure</div><div class='line' id='LC983'>opts_knit$set(global.device = TRUE)</div><div class='line' id='LC984'>```</div><div class='line' id='LC985'><br/></div><div class='line' id='LC986'>```{r grid newpage, tidy = FALSE, , fig.keep = &#39;none&#39;}</div><div class='line' id='LC987'>grid.newpage()</div><div class='line' id='LC988'>```</div><div class='line' id='LC989'><br/></div><div class='line' id='LC990'>```{r grid first vp, tidy = FALSE, fig.cap = fn(&quot;producing a standard viewport using grid&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC991'>grid.rect()</div><div class='line' id='LC992'>grid.text(&quot;this is the root vp&quot;, x = 0.5, y = 1, </div><div class='line' id='LC993'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;top&quot;))</div><div class='line' id='LC994'><br/></div><div class='line' id='LC995'>our.first.vp &lt;- viewport(x = 0.5, y = 0.5, </div><div class='line' id='LC996'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC997'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;centre&quot;))</div><div class='line' id='LC998'><br/></div><div class='line' id='LC999'>pushViewport(our.first.vp)</div><div class='line' id='LC1000'><br/></div><div class='line' id='LC1001'>grid.rect(gp = gpar(fill = &quot;pink&quot;))</div><div class='line' id='LC1002'>grid.text(&quot;this is our first vp&quot;, x = 0.5, y = 1, </div><div class='line' id='LC1003'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;top&quot;))</div><div class='line' id='LC1004'>```</div><div class='line' id='LC1005'><br/></div><div class='line' id='LC1006'>Ok, so now we have created a viewport in the middle of the `root` viewport at `x = 0.5` and `y = 0.5` - `just = c(&quot;centre&quot;, ,&quot;centre&quot;)` that is half the height and half the width of the original viewport - `height = 0.5` and `width = 0.5`.</div><div class='line' id='LC1007'><br/></div><div class='line' id='LC1008'>Afterwards we navigated into this viewport - `pushViewport(our.first.vp)` and then we have drawn a rectangle that fills the entire viewport and filled it in pink colour - `grid.rect(gp = gpar(fill = &quot;pink&quot;))`</div><div class='line' id='LC1009'><br/></div><div class='line' id='LC1010'>Note that we didn&#39;t leave the viewport yet. This means, whatever we do now, will happen in the currently active viewport (the pink one). To illustrate this, we will simply repeat the exact same code from above once more.</div><div class='line' id='LC1011'><br/></div><div class='line' id='LC1012'>```{r grid second vp, tidy = FALSE, fig.cap = fn(&quot;producing a second viewport using grid&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1013'>our.first.vp &lt;- viewport(x = 0.5, y = 0.5, </div><div class='line' id='LC1014'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1015'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;centre&quot;))</div><div class='line' id='LC1016'><br/></div><div class='line' id='LC1017'>pushViewport(our.first.vp)</div><div class='line' id='LC1018'><br/></div><div class='line' id='LC1019'>grid.rect(gp = gpar(fill = &quot;cornflowerblue&quot;))</div><div class='line' id='LC1020'>```</div><div class='line' id='LC1021'><br/></div><div class='line' id='LC1022'>This means, that whatever viewport we are currently in, this defines our reference system (0 - 1). In case you don&#39;t believe me, we can repeat this 10 times more...</div><div class='line' id='LC1023'><br/></div><div class='line' id='LC1024'>```{r grid several vps, tidy = FALSE, fig.cap = fn(&quot;producing several viewports using grid&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1025'>for (i in 1:10) {</div><div class='line' id='LC1026'>&nbsp;&nbsp;our.first.vp &lt;- viewport(x = 0.5, y = 0.5, </div><div class='line' id='LC1027'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1028'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;centre&quot;))</div><div class='line' id='LC1029'>&nbsp;&nbsp;</div><div class='line' id='LC1030'>&nbsp;&nbsp;pushViewport(our.first.vp)</div><div class='line' id='LC1031'>&nbsp;&nbsp;</div><div class='line' id='LC1032'>&nbsp;&nbsp;grid.circle(gp = gpar(fill = &quot;cornflowerblue&quot;))</div><div class='line' id='LC1033'>&nbsp;&nbsp;}</div><div class='line' id='LC1034'>```</div><div class='line' id='LC1035'><br/></div><div class='line' id='LC1036'>I hope this is proof enough now! We are cascading down viewports always creating a rectangle that fills half the &#39;mother&#39; viewport each time. Yet, as the &#39;mother&#39; viewport becomes smaller and smaller, our rectangles also become smaller at each step along the way (programmers would actually call these steps iterations, but we won&#39;t be bothered here...)</div><div class='line' id='LC1037'><br/></div><div class='line' id='LC1038'>So, how do we navigate back?</div><div class='line' id='LC1039'><br/></div><div class='line' id='LC1040'>If I counted correctly, we went down 12 rabbit holes. In order to get out of these again, we need to `upViewport(12)` and in order to see whether we are correct, we ask ```grid``` what viewport we are currently in.</div><div class='line' id='LC1041'><br/></div><div class='line' id='LC1042'><br/></div><div class='line' id='LC1043'>```{r grid back to root vp, tidy = FALSE, fig.keep = &#39;none&#39;}</div><div class='line' id='LC1044'>upViewport(12)</div><div class='line' id='LC1045'><br/></div><div class='line' id='LC1046'>current.viewport()</div><div class='line' id='LC1047'>```</div><div class='line' id='LC1048'><br/></div><div class='line' id='LC1049'>Sweet, we&#39;re back in the &#39;root&#39; viewport...</div><div class='line' id='LC1050'><br/></div><div class='line' id='LC1051'>Now, let&#39;s see how this `just` parameter works. As you have seen we are now in the `root` viewport. Let&#39;s try to draw another rectangle that sits right at the top left corner of the pink one. In theory the lower right corner of this viewport should be located at `x = 0.25` and `y = 0.75`. If we specify it like this, we need to adjust the justification, because we do not want to centre it on these coordinates. If these coordinates are the point of origin, this viewport should be justified right horizontally and bottom vertically. And the space we have to plot should be `0.25` vertically and `0.25` horizontally. Let&#39;s try this...</div><div class='line' id='LC1052'><br/></div><div class='line' id='LC1053'>```{r grid top left vp, tidy = FALSE, fig.cap = fn(&quot;producing a yet another viewport using grid&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1054'>top.left.vp &lt;- viewport(x = 0.25, y = 0.75, </div><div class='line' id='LC1055'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.25, width = 0.25,</div><div class='line' id='LC1056'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;))</div><div class='line' id='LC1057'><br/></div><div class='line' id='LC1058'>pushViewport(top.left.vp)</div><div class='line' id='LC1059'><br/></div><div class='line' id='LC1060'>grid.rect(gp = gpar(fill = &quot;grey&quot;, alpha = 0.5))</div><div class='line' id='LC1061'>```</div><div class='line' id='LC1062'><br/></div><div class='line' id='LC1063'>```{r, include = FALSE}</div><div class='line' id='LC1064'>## close the graphical device again</div><div class='line' id='LC1065'>opts_knit$set(global.device = FALSE)</div><div class='line' id='LC1066'>```</div><div class='line' id='LC1067'><br/></div><div class='line' id='LC1068'>I hope that you have understood 2 things now:</div><div class='line' id='LC1069'><br/></div><div class='line' id='LC1070'>1. how to create and navigate between viewports</div><div class='line' id='LC1071'>2. why I said earlier that `grid` is a package for drawing...</div><div class='line' id='LC1072'><br/></div><div class='line' id='LC1073'>Assuming that you have understood these two points, lets make use of the first one and use this incredibly flexible plotting framework for arranging multiple plots on one page.</div><div class='line' id='LC1074'><br/></div><div class='line' id='LC1075'>### 3.1. multiple plots on one page</div><div class='line' id='LC1076'><br/></div><div class='line' id='LC1077'>**In order to succeed plotting several of our previoulsly created plots on one page, there&#39;s two things of importance:**</div><div class='line' id='LC1078'><br/></div><div class='line' id='LC1079'>1. the `lattice/ggplot2` plot objects need to be printed using `print(latticeObject)/print(ggplot2Object)`</div><div class='line' id='LC1080'>2. we need to set `newpage = FALSE` in the print call so that the previously drawn elements are not deleted</div><div class='line' id='LC1081'><br/></div><div class='line' id='LC1082'>Let&#39;s try and plot the ```lattice``` and `ggplot2` versions of our box and whisker plots and scatter plots next to each other on one page by setting up a suitable viewport structure.</div><div class='line' id='LC1083'><br/></div><div class='line' id='LC1084'>```{r grid multiple, tidy = FALSE, fig.cap = fn(&quot;using the grid package to place multiple plots on one page&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1085'>### clear plot area</div><div class='line' id='LC1086'>grid.newpage()</div><div class='line' id='LC1087'><br/></div><div class='line' id='LC1088'>### define first plotting region (viewport)</div><div class='line' id='LC1089'>vp1 &lt;- viewport(x = 0, y = 0, </div><div class='line' id='LC1090'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1091'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1092'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower left&quot;)</div><div class='line' id='LC1093'><br/></div><div class='line' id='LC1094'>### enter vp1 </div><div class='line' id='LC1095'>pushViewport(vp1)</div><div class='line' id='LC1096'><br/></div><div class='line' id='LC1097'>### show the plotting region (viewport extent)</div><div class='line' id='LC1098'>grid.rect(gp = gpar(fill = &quot;red&quot;, alpha = 0.2))</div><div class='line' id='LC1099'><br/></div><div class='line' id='LC1100'>### plot a plot - needs to be printed (and newpage set to FALSE)!!!</div><div class='line' id='LC1101'>print(l.bw, newpage = FALSE)</div><div class='line' id='LC1102'><br/></div><div class='line' id='LC1103'>### leave vp1 - up one level (into root vieport)</div><div class='line' id='LC1104'>upViewport(1)</div><div class='line' id='LC1105'><br/></div><div class='line' id='LC1106'>### define second plot area</div><div class='line' id='LC1107'>vp2 &lt;- viewport(x = 1, y = 0, </div><div class='line' id='LC1108'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1109'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1110'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower right&quot;)</div><div class='line' id='LC1111'><br/></div><div class='line' id='LC1112'>### enter vp2</div><div class='line' id='LC1113'>pushViewport(vp2)</div><div class='line' id='LC1114'><br/></div><div class='line' id='LC1115'>### show the plotting region (viewport extent)</div><div class='line' id='LC1116'>grid.rect(gp = gpar(fill =  &quot;white&quot;, alpha = 0.2))</div><div class='line' id='LC1117'><br/></div><div class='line' id='LC1118'>### plot another plot</div><div class='line' id='LC1119'>print(g.bw, newpage = FALSE)</div><div class='line' id='LC1120'><br/></div><div class='line' id='LC1121'>### leave vp2</div><div class='line' id='LC1122'>upViewport(1)</div><div class='line' id='LC1123'><br/></div><div class='line' id='LC1124'><br/></div><div class='line' id='LC1125'>vp3 &lt;- viewport(x = 0, y = 1, </div><div class='line' id='LC1126'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1127'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;top&quot;),</div><div class='line' id='LC1128'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper left&quot;)</div><div class='line' id='LC1129'><br/></div><div class='line' id='LC1130'>pushViewport(vp3)</div><div class='line' id='LC1131'><br/></div><div class='line' id='LC1132'>### show the plotting region (viewport extent)</div><div class='line' id='LC1133'>grid.rect(gp = gpar(fill =  &quot;green&quot;, alpha = 0.2))</div><div class='line' id='LC1134'><br/></div><div class='line' id='LC1135'>print(l.sc, newpage = FALSE)</div><div class='line' id='LC1136'><br/></div><div class='line' id='LC1137'>upViewport(1)</div><div class='line' id='LC1138'><br/></div><div class='line' id='LC1139'><br/></div><div class='line' id='LC1140'>vp4 &lt;- viewport(x = 1, y = 1, </div><div class='line' id='LC1141'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.5,</div><div class='line' id='LC1142'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;top&quot;),</div><div class='line' id='LC1143'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper right&quot;)</div><div class='line' id='LC1144'><br/></div><div class='line' id='LC1145'>pushViewport(vp4)</div><div class='line' id='LC1146'><br/></div><div class='line' id='LC1147'>### show the plotting region (viewport extent)</div><div class='line' id='LC1148'>grid.rect(gp = gpar(fill =  &quot;black&quot;, alpha = 0.2))</div><div class='line' id='LC1149'><br/></div><div class='line' id='LC1150'>print(g.sc, newpage = FALSE)</div><div class='line' id='LC1151'><br/></div><div class='line' id='LC1152'>upViewport(1)</div><div class='line' id='LC1153'>```</div><div class='line' id='LC1154'><br/></div><div class='line' id='LC1155'>So there we have it. Creating and navigating between viewports enables us to build a graphical layout in whatever way we want. In my opinion this is way better than saving all the plots to the hard drive and then using some sort of graphics software such as Photoshop or Inkscape to arrange the plots onto one page. After all, sometimes we may have several of these multi-plot-pages that we want to produce and now we know how to do this automatically and we won&#39;t need any post-production steps.</div><div class='line' id='LC1156'><br/></div><div class='line' id='LC1157'>### 3.2. manipulating existing plots</div><div class='line' id='LC1158'><br/></div><div class='line' id='LC1159'>Another application of `grid` is to manipulate an existing plot object. You may have noted that our version of the 2D density scatter plot produced with `lattice` lacks a colour key. This can be easily added using `grid`. As `lattice` is built upon `grid`, it produces a lot of viewports in the creation of the plots (like our scatter plot). We can, after they have been set up, navigate to each of these and edit them or delete them or add new stuff. Looking at the `ggplot2` version of the density scatter, we see that this has a colour key which is placed to right of the main plot. Given that we have 5 panels, we actually have some &#39;white&#39; space that we could use for the colour key placement, thus making better use of the available space...</div><div class='line' id='LC1160'><br/></div><div class='line' id='LC1161'>In order to do so, we need to know into which of the viewports created by `lattice` we need to navigate. Therefore, we need to know their names. `lattice` provides a function for this. We can use `trellis.vpname()` to extract the name(s) of the viewport(s) we are interested in. `lattice` provides a structured naming convention for its viewports. We can use this to specify what viewport name(s) we want to extract. As we are interested in the viewport that comprises the main figure, we will tell `lattice` to extract this name (see below in the code). Then we can navigate into this viewport `downViewport()` and set up a new viewport in the main plotting area (the figure viewport) to make use of the existing &#39;white&#39; space. Remember that the default units of `grid` are 0 - 1. This means that we can easily calculate the necessary viewport dimensions. Let&#39;s see how this is done (Note, we are actually creating 2 new viewports in the figure area, one for the colour key and another one for the colour key label).</div><div class='line' id='LC1162'><br/></div><div class='line' id='LC1163'>```{r grid manipulate, tidy = FALSE, fig.width = 10, fig.height = 7, fig.cap = fn(&quot;using the grid package to add a color key to an existing lattice plot object&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1164'>grid.newpage()</div><div class='line' id='LC1165'>#grid.rect()</div><div class='line' id='LC1166'>print(l.sc, newpage = FALSE)</div><div class='line' id='LC1167'>#grid.rect()</div><div class='line' id='LC1168'>downViewport(trellis.vpname(name = &quot;figure&quot;))</div><div class='line' id='LC1169'>#grid.rect()</div><div class='line' id='LC1170'>vp1 &lt;- viewport(x = 1, y = 0, </div><div class='line' id='LC1171'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.3,</div><div class='line' id='LC1172'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1173'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.vp&quot;)</div><div class='line' id='LC1174'><br/></div><div class='line' id='LC1175'>pushViewport(vp1)</div><div class='line' id='LC1176'>#grid.rect()</div><div class='line' id='LC1177'><br/></div><div class='line' id='LC1178'>vp1.1 &lt;- viewport(x = 0.2, y = 0.5, </div><div class='line' id='LC1179'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.7, width = 0.5,</div><div class='line' id='LC1180'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;centre&quot;),</div><div class='line' id='LC1181'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.key&quot;)</div><div class='line' id='LC1182'><br/></div><div class='line' id='LC1183'>pushViewport(vp1.1)</div><div class='line' id='LC1184'>#grid.rect()</div><div class='line' id='LC1185'><br/></div><div class='line' id='LC1186'>xy &lt;- kde2d(x = diamonds$carat, y = diamonds$price, n = 100) </div><div class='line' id='LC1187'>xy.tr &lt;- con2tr(xy)</div><div class='line' id='LC1188'>offset &lt;- max(xy.tr$z) * 0.01</div><div class='line' id='LC1189'>z.range &lt;- seq(min(xy.tr$z), max(xy.tr$z) + 50 * offset, offset)</div><div class='line' id='LC1190'><br/></div><div class='line' id='LC1191'>key &lt;- draw.colorkey(key = list(col = c(&quot;white&quot;, rev(clrs.hcl(10000))),</div><div class='line' id='LC1192'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = z.range), draw = TRUE)</div><div class='line' id='LC1193'><br/></div><div class='line' id='LC1194'>seekViewport(&quot;legend.vp&quot;)</div><div class='line' id='LC1195'>#grid.rect()</div><div class='line' id='LC1196'>vp1.2 &lt;- viewport(x = 1, y = 0.5, </div><div class='line' id='LC1197'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 1, width = 0.3,</div><div class='line' id='LC1198'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;centre&quot;),</div><div class='line' id='LC1199'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.text&quot;, angle = 0)</div><div class='line' id='LC1200'><br/></div><div class='line' id='LC1201'>pushViewport(vp1.2)</div><div class='line' id='LC1202'>#grid.rect()</div><div class='line' id='LC1203'><br/></div><div class='line' id='LC1204'>grid.text(&quot;estimated point density&quot;, </div><div class='line' id='LC1205'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = 0, y = 0.5, rot = 270, </div><div class='line' id='LC1206'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;bottom&quot;))</div><div class='line' id='LC1207'><br/></div><div class='line' id='LC1208'>upViewport(3)</div><div class='line' id='LC1209'><br/></div><div class='line' id='LC1210'>```</div><div class='line' id='LC1211'><br/></div><div class='line' id='LC1212'>Not too complicated, ey. And, in comparison to the `ggplot2` version, we are utilising the available space a bit more efficiently. Though, obviously, we could also manipulate the `ggplot2` density scatter plot (or any other plot) in a similar manner. </div><div class='line' id='LC1213'><br/></div><div class='line' id='LC1214'>I hope it became clear just how useful `grid` can be and how it provides us with tools which enable us to produce individual graphics that satisfy our needs. This may become a little clearer in section 5, where we will see how to use `grid` for map creation.</div><div class='line' id='LC1215'><br/></div><div class='line' id='LC1216'>So far, we have put our efforts into plot creation. I think, by now, we have a few tools handy to achieve what we want, so let&#39;s see how we can save our graphics to our hard drive.</div><div class='line' id='LC1217'><br/></div><div class='line' id='LC1218'>## 4. Saving your visualisations</div><div class='line' id='LC1219'><br/></div><div class='line' id='LC1220'>Saving graphics in R is very straight forward. We simply need to call a suitable device. There are a number of different plotting devices available. Here, we will introduce 2 examples, `postscript` and `png`. `postscript` should be used for vector graphics (e.g. line plots, point plots, polygon plots etc.), whereas `png` is preferable for raster graphics (e.g. photos, our density scatter plot or anything pixel based).</div><div class='line' id='LC1221'><br/></div><div class='line' id='LC1222'>All the graphics devices in R basically work the same way:</div><div class='line' id='LC1223'><br/></div><div class='line' id='LC1224'>1. we open the respective device (postscript, png, jpeg, svg...)</div><div class='line' id='LC1225'>2. we plot (or in our case print our plot objects)</div><div class='line' id='LC1226'>3. we close the device using `dev.off()` - otherwise the file will not be written to the hard drive.</div><div class='line' id='LC1227'><br/></div><div class='line' id='LC1228'>That&#39;s it. Simple and straight forward. Here&#39;s the two examples using `postscript` and `png`:</div><div class='line' id='LC1229'><br/></div><div class='line' id='LC1230'>```{r saving ps, eval = FALSE}</div><div class='line' id='LC1231'>postscript(&quot;test.ps&quot;)</div><div class='line' id='LC1232'>print(g.bw)</div><div class='line' id='LC1233'>dev.off()</div><div class='line' id='LC1234'>```</div><div class='line' id='LC1235'><br/></div><div class='line' id='LC1236'>**NOTE: In order to get postscript to work, you may have to install a prostscript driver on you computer**</div><div class='line' id='LC1237'><br/></div><div class='line' id='LC1238'>```{r saving png, eval = FALSE}</div><div class='line' id='LC1239'>png(&quot;test.png&quot;, width = 14.7, height = 18.8, </div><div class='line' id='LC1240'>&nbsp;&nbsp;&nbsp;&nbsp;units = &quot;cm&quot;, res = 600, pointsize = 12)</div><div class='line' id='LC1241'><br/></div><div class='line' id='LC1242'>grid.newpage()</div><div class='line' id='LC1243'><br/></div><div class='line' id='LC1244'>print(l.sc, newpage = FALSE)</div><div class='line' id='LC1245'><br/></div><div class='line' id='LC1246'>downViewport(trellis.vpname(name = &quot;figure&quot;))</div><div class='line' id='LC1247'><br/></div><div class='line' id='LC1248'>vp1 &lt;- viewport(x = 1, y = 0, </div><div class='line' id='LC1249'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.3,</div><div class='line' id='LC1250'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1251'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.vp&quot;)</div><div class='line' id='LC1252'><br/></div><div class='line' id='LC1253'>pushViewport(vp1)</div><div class='line' id='LC1254'>#grid.rect()</div><div class='line' id='LC1255'><br/></div><div class='line' id='LC1256'>vp1.1 &lt;- viewport(x = 0.2, y = 0.5, </div><div class='line' id='LC1257'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.7, width = 0.5,</div><div class='line' id='LC1258'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;centre&quot;),</div><div class='line' id='LC1259'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.key&quot;)</div><div class='line' id='LC1260'><br/></div><div class='line' id='LC1261'>pushViewport(vp1.1)</div><div class='line' id='LC1262'>#grid.rect()</div><div class='line' id='LC1263'>xy &lt;- kde2d(x = diamonds$carat, y = diamonds$price, n = 100) </div><div class='line' id='LC1264'>xy.tr &lt;- con2tr(xy)</div><div class='line' id='LC1265'>offset &lt;- max(xy.tr$z) * 0.01</div><div class='line' id='LC1266'>z.range &lt;- seq(min(xy.tr$z), max(xy.tr$z) + 50 * offset, offset)</div><div class='line' id='LC1267'><br/></div><div class='line' id='LC1268'>key &lt;- draw.colorkey(key = list(col = c(&quot;white&quot;, rev(clrs.hcl(10000))),</div><div class='line' id='LC1269'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = z.range), draw = TRUE)</div><div class='line' id='LC1270'><br/></div><div class='line' id='LC1271'>seekViewport(&quot;legend.vp&quot;)</div><div class='line' id='LC1272'>#grid.rect()</div><div class='line' id='LC1273'>vp1.2 &lt;- viewport(x = 1, y = 0.5, </div><div class='line' id='LC1274'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 1, width = 0.3,</div><div class='line' id='LC1275'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;centre&quot;),</div><div class='line' id='LC1276'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;legend.text&quot;, angle = 0)</div><div class='line' id='LC1277'><br/></div><div class='line' id='LC1278'>pushViewport(vp1.2)</div><div class='line' id='LC1279'>#grid.rect()</div><div class='line' id='LC1280'>grid.text(&quot;estimated point density&quot;, </div><div class='line' id='LC1281'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x = 0, y = 0.5, rot = 270, </div><div class='line' id='LC1282'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;centre&quot;, &quot;bottom&quot;))</div><div class='line' id='LC1283'><br/></div><div class='line' id='LC1284'>upViewport(3)</div><div class='line' id='LC1285'><br/></div><div class='line' id='LC1286'>dev.off()</div><div class='line' id='LC1287'>```</div><div class='line' id='LC1288'><br/></div><div class='line' id='LC1289'>&gt; ### -----------------------~~ Exercise VI ~~-----------------------------</div><div class='line' id='LC1290'>using one of the data sets from exercise I save to your local drive     </div><div class='line' id='LC1291'>a plot showing the lattice and ggplot2 versions of a histogram of      </div><div class='line' id='LC1292'>price conditioned according to both cut and color utilising the       </div><div class='line' id='LC1293'>grid package to set up the plotting device</div><div class='line' id='LC1294'>&gt; ### -------------------------------~~ ° ~~------------------------------------</div><div class='line' id='LC1295'><br/></div><div class='line' id='LC1296'>Ok, so for the general part of this tutorial, we have come to an end. </div><div class='line' id='LC1297'><br/></div><div class='line' id='LC1298'>* we have learned how to use the two main grid based plotting packages `lattice` and `ggplot2` to create basic statistical plots. Adjusting and expanding this to the kinds of plots you want to produce for individual work should now be a little easier, I hope</div><div class='line' id='LC1299'>* we have seen how to modify/manipulate the default graphical parameter settings in order to make our plots a little &#39;nicer&#39;</div><div class='line' id='LC1300'>* we heave also seen how to produce panel/facetted plots providing some statistic for each subset of the data</div><div class='line' id='LC1301'>* we have used the underlying `grid` framework to create multi-plot-pages and to manipulate existing plots</div><div class='line' id='LC1302'>* as a final step, we have learned how to save our plots to our hard drive, so we can send them off to somewhere/someone...</div><div class='line' id='LC1303'><br/></div><div class='line' id='LC1304'>The last part of this tutorial is concerned with a more specific topic, the use of spatial data in R for creating maps. As this workshop is aimed at environmental sciences students, I have decided to include at least a tiny little introduction into the use of spatial data with focus on creating maps (after all this workshop is about visualisation, not analysis).</div><div class='line' id='LC1305'><br/></div><div class='line' id='LC1306'>## 5. Spatial data in R</div><div class='line' id='LC1307'><br/></div><div class='line' id='LC1308'>In order to use R for spatial data we need to prepare the computer environment so that we can make use of some spatial libraries (as in computer libraries, not R libraries). In particular, we need to install and set up the so-called `geographical data abstraction library - gdal`. This is the backbone for any analysis that involves geographical coordinates (i.e. projected spatial data). I cannot go into any detail here, but without these libraries installed on your machine, you will not be able to do any sort of geographical analysis.</div><div class='line' id='LC1309'><br/></div><div class='line' id='LC1310'>In case you&#39;re on a windows machine, the easiest solution (in my opinion) is to install `OSGEO4W`, a bundle of various spatial tools and programs including `gdal`. In case you are asked during the installation progress whether to include the `gdal` libraries in the windows path, click yes (or mark the respective option). In case you are not asked, you have to set this yourself. Here&#39;s a little tutorial how to [set the global windows path to gdal installation](http://php.scripts.psu.edu/jzl5325/wordpress/?p=60). This is necessary so that windows always knows where to find `gdal` in case any program (like R) executes a `gdal` call.</div><div class='line' id='LC1311'><br/></div><div class='line' id='LC1312'>Then, the R binding to the `gdal` libraries, called `rgdal`, should install just like any other package. The other package that we will need to install for any spatial task in R is `sp` (for spatial). This is the centre of the spatial universe in R and any other package for spatial analysis is dependent on it. A final package that we will need here is `raster` which is, as the name already implies, focussed towards the spatial analysis of raster data. </div><div class='line' id='LC1313'><br/></div><div class='line' id='LC1314'>### 5.1. Polygon data</div><div class='line' id='LC1315'><br/></div><div class='line' id='LC1316'>It may come as a surprise for many people, but R can, with the aid of a few packages, be used as a full-blown GIS system. Especially, the visualisation of maps is rather straight forward.</div><div class='line' id='LC1317'><br/></div><div class='line' id='LC1318'>Using the functionality provided by ```sp```, there are several hundred packages that provide extended possibilities for the analysis and visualisation of spatial data. A comprehensive list of available packages can be found [here](http://cran.r-project.org/web/views/Spatial.html).</div><div class='line' id='LC1319'><br/></div><div class='line' id='LC1320'>One nice thing about `sp` is that (nearly) all plotting routines are using the ```lattice``` package, so that they are highly customisable (and most of the things we learned here are directly applicable to spatial representations using `sp` or related packages).</div><div class='line' id='LC1321'><br/></div><div class='line' id='LC1322'>As an example, let&#39;s try to produce a graphic that uses colour to represent a certain continuous variable mapped to each of the federal states of Germany. In our case here, we create a random variable based on a poisson distribution and assume it represents the number of breweries in each German federal state.</div><div class='line' id='LC1323'><br/></div><div class='line' id='LC1324'>The spatial data (polygons) for German federal states can be downloaded from [the gadm project site](http://www.gadm.org/) or with aid of the `raster` package they can be downloaded straight into our R session using `getData()`. </div><div class='line' id='LC1325'><br/></div><div class='line' id='LC1326'>For Germany, level1 is the data set that provides the outlines of the German federal states (level0 is country outline, level2 is &#39;Bezirke&#39;). The neat thing about this online data base is that all data is provided in several formats including R spatial data format. This means that we can use this straight away in R and no conversion is necessary.</div><div class='line' id='LC1327'><br/></div><div class='line' id='LC1328'>As we have already seen how to use `grid` to arrange multiple plots on one page, we will do this now with spatial data - maps. In order to draw multiple plots we will obviously need several variables to be displayed. Therefore, in addition to the number of breweries in each state, we will create some additional variables such as the number of micro-/corporate breweries and the total amount of beer they sell in a year - in the arbitrary unit fantastiliters ;-).</div><div class='line' id='LC1329'><br/></div><div class='line' id='LC1330'>Here we go...</div><div class='line' id='LC1331'><br/></div><div class='line' id='LC1332'>```{r spatial polygon data, tidy = FALSE, message = FALSE}</div><div class='line' id='LC1333'>### load the necessary spatial packages</div><div class='line' id='LC1334'>library(sp)</div><div class='line' id='LC1335'>library(raster)</div><div class='line' id='LC1336'>library(fields) # only needed for the hideous tim.colors() palette</div><div class='line' id='LC1337'><br/></div><div class='line' id='LC1338'>### load the German federal state polygons</div><div class='line' id='LC1339'>gadm &lt;- getData(&#39;GADM&#39;, country = &#39;DEU&#39;, level = 1)</div><div class='line' id='LC1340'><br/></div><div class='line' id='LC1341'>#load(&#39;/media/windows/tappelhans/uni/marburg/lehre/2013/ss/Sp-VpPh/data/DEU_adm1.RData&#39;)</div><div class='line' id='LC1342'><br/></div><div class='line' id='LC1343'>### create the random variables</div><div class='line' id='LC1344'>set.seed(12345)</div><div class='line' id='LC1345'>breweries &lt;- rpois(16, 3) * 100</div><div class='line' id='LC1346'>micro &lt;- breweries * rnorm(16, 0.4, 0.1)</div><div class='line' id='LC1347'>corporate &lt;- breweries - micro</div><div class='line' id='LC1348'>micro.fl &lt;- rnorm(16, 100000L, 20000L)</div><div class='line' id='LC1349'>corporate.fl &lt;- rnorm(16, 100000L, 10000L)</div><div class='line' id='LC1350'><br/></div><div class='line' id='LC1351'>### calculate global minima and maxima to standardise the colors </div><div class='line' id='LC1352'>### in each plot. We need to add a little offset at the upper end!</div><div class='line' id='LC1353'>brew.min &lt;- range(breweries)[1]</div><div class='line' id='LC1354'>brew.max &lt;- range(breweries)[2] + 10</div><div class='line' id='LC1355'>litres.min &lt;- min(micro.fl, corporate.fl)</div><div class='line' id='LC1356'>litres.max &lt;- max(micro.fl, corporate.fl) + 1000</div><div class='line' id='LC1357'><br/></div><div class='line' id='LC1358'>### German language hick-ups need to be resolved</div><div class='line' id='LC1359'>enamessp &lt;- gsub(&quot;ü&quot;, &quot;ue&quot;, gadm@data$NAME_1)</div><div class='line' id='LC1360'>gadm@data$NAME_1 &lt;- enamessp</div><div class='line' id='LC1361'><br/></div><div class='line' id='LC1362'>### insert the newly created brewery variables into the spatial data frame</div><div class='line' id='LC1363'>gadm$breweries &lt;- breweries</div><div class='line' id='LC1364'>gadm$micro &lt;- micro</div><div class='line' id='LC1365'>gadm$corp &lt;- corporate</div><div class='line' id='LC1366'>gadm$micro.fl &lt;- micro.fl</div><div class='line' id='LC1367'>gadm$corp.fl &lt;- corporate.fl</div><div class='line' id='LC1368'><br/></div><div class='line' id='LC1369'>### create colour palettes for the plots</div><div class='line' id='LC1370'>clrs.breweries &lt;- colorRampPalette(brewer.pal(9, &quot;YlGnBu&quot;))</div><div class='line' id='LC1371'>clrs.litres &lt;- colorRampPalette(brewer.pal(9, &quot;YlOrBr&quot;))</div><div class='line' id='LC1372'><br/></div><div class='line' id='LC1373'>### create the plot objects with fixed ranges for the z variable (at = ...)</div><div class='line' id='LC1374'>p.total &lt;- spplot(gadm, zcol = &quot;breweries&quot;, </div><div class='line' id='LC1375'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Total number of breweries&quot;, </div><div class='line' id='LC1376'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.breweries(1000),</div><div class='line' id='LC1377'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = seq(brew.min, brew.max, 10),</div><div class='line' id='LC1378'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par.settings = list(axis.line = list(col = 0)),</div><div class='line' id='LC1379'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorkey = list(space = &quot;top&quot;, width = 1, height = 0.75))</div><div class='line' id='LC1380'><br/></div><div class='line' id='LC1381'>p.micro &lt;- spplot(gadm, zcol = &quot;micro&quot;, </div><div class='line' id='LC1382'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Number of micro-breweries&quot;, </div><div class='line' id='LC1383'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.breweries(1000),</div><div class='line' id='LC1384'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = seq(brew.min, brew.max, 10)) </div><div class='line' id='LC1385'><br/></div><div class='line' id='LC1386'>p.corpo &lt;- spplot(gadm, zcol = &quot;corp&quot;, </div><div class='line' id='LC1387'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Number of corporate breweries&quot;, </div><div class='line' id='LC1388'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.breweries(1000),</div><div class='line' id='LC1389'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = seq(brew.min, brew.max, 10))</div><div class='line' id='LC1390'><br/></div><div class='line' id='LC1391'>p.micro.fl  &lt;- spplot(gadm, zcol = &quot;micro.fl&quot;, </div><div class='line' id='LC1392'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Micro-breweries production (fantastilitres)&quot;, </div><div class='line' id='LC1393'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.litres(1000),</div><div class='line' id='LC1394'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = seq(litres.min, litres.max, 1000))</div><div class='line' id='LC1395'><br/></div><div class='line' id='LC1396'>p.corpo.fl &lt;- spplot(gadm, zcol = &quot;corp.fl&quot;, </div><div class='line' id='LC1397'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Corporate breweries production (fantastilitres)&quot;, </div><div class='line' id='LC1398'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.litres(1000),</div><div class='line' id='LC1399'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at = seq(litres.min, litres.max, 1000))</div><div class='line' id='LC1400'>```</div><div class='line' id='LC1401'><br/></div><div class='line' id='LC1402'>Now we can set up our plotting device to plot all five plots on the one device. This is done by defining a viewport for all of them. The first viewport we create will be the upper left viewport. It will be half the height and a quarter the width of the complete plotting device (called the root viewport). It will be drawn at x = 0 and y = 1 and will be left-aligned horizontally and top-aligned vertically. Once it is set up, we need to navigate to this viewport by pushing into it (pushviewport). Once we are &#39;in&#39; the viewport, we can draw our plot. </div><div class='line' id='LC1403'><br/></div><div class='line' id='LC1404'>**NOTE: there are two things of importance here (I know this is repetition, but didactically, repetition is not such a bad thing)**</div><div class='line' id='LC1405'><br/></div><div class='line' id='LC1406'>1. the lattice plot objects need to be printed using print(latticeObject)</div><div class='line' id='LC1407'>2. we need to set newpage = FALSE so that the previously drawn elements are not deleted</div><div class='line' id='LC1408'><br/></div><div class='line' id='LC1409'>Then we create another viewport for the next plot and so on...    </div><div class='line' id='LC1410'>Here&#39;s the code:</div><div class='line' id='LC1411'><br/></div><div class='line' id='LC1412'>```{r plotting polygons, tidy = FALSE, fig.width=15, fig.height=10, fig.cap = fn(&quot;using packages sp, raster, RColorBrewer, and grid to create a multiple map plot&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1413'>### grid.newpage() clears whatever has been drawn on the device before</div><div class='line' id='LC1414'>grid.newpage()</div><div class='line' id='LC1415'><br/></div><div class='line' id='LC1416'>vp1 &lt;- viewport(x = 0, y = 1, </div><div class='line' id='LC1417'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1418'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;top&quot;),</div><div class='line' id='LC1419'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper left&quot;)</div><div class='line' id='LC1420'>pushViewport(vp1)</div><div class='line' id='LC1421'>print(p.micro, newpage = FALSE)</div><div class='line' id='LC1422'><br/></div><div class='line' id='LC1423'>upViewport(1)</div><div class='line' id='LC1424'><br/></div><div class='line' id='LC1425'>vp2 &lt;- viewport(x = 0, y = 0, </div><div class='line' id='LC1426'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1427'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1428'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower left&quot;)</div><div class='line' id='LC1429'>pushViewport(vp2)</div><div class='line' id='LC1430'>print(p.micro.fl, newpage = FALSE) </div><div class='line' id='LC1431'><br/></div><div class='line' id='LC1432'>upViewport(1)</div><div class='line' id='LC1433'><br/></div><div class='line' id='LC1434'>vp3 &lt;- viewport(x = 0.25, y = 0, </div><div class='line' id='LC1435'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 1, width = 0.5,</div><div class='line' id='LC1436'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1437'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;centre&quot;)</div><div class='line' id='LC1438'>pushViewport(vp3)</div><div class='line' id='LC1439'>print(p.total, newpage = FALSE) </div><div class='line' id='LC1440'><br/></div><div class='line' id='LC1441'>upViewport(1)</div><div class='line' id='LC1442'><br/></div><div class='line' id='LC1443'>vp4 &lt;- viewport(x = 1, y = 1, </div><div class='line' id='LC1444'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1445'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;top&quot;),</div><div class='line' id='LC1446'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper right&quot;)</div><div class='line' id='LC1447'>pushViewport(vp4)</div><div class='line' id='LC1448'>print(p.corpo, newpage = FALSE) </div><div class='line' id='LC1449'><br/></div><div class='line' id='LC1450'>upViewport(1)</div><div class='line' id='LC1451'>vp5 &lt;- viewport(x = 1, y = 0, </div><div class='line' id='LC1452'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1453'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1454'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower right&quot;)</div><div class='line' id='LC1455'>pushViewport(vp5)</div><div class='line' id='LC1456'>print(p.corpo.fl, newpage = FALSE) </div><div class='line' id='LC1457'><br/></div><div class='line' id='LC1458'>upViewport(1)</div><div class='line' id='LC1459'><br/></div><div class='line' id='LC1460'>```</div><div class='line' id='LC1461'><br/></div><div class='line' id='LC1462'>Nice, isn&#39;t it?</div><div class='line' id='LC1463'><br/></div><div class='line' id='LC1464'>Now let&#39;s do something similar with raster data.</div><div class='line' id='LC1465'><br/></div><div class='line' id='LC1466'>### 5.2. Raster data</div><div class='line' id='LC1467'><br/></div><div class='line' id='LC1468'>To highlight the use of the raster package, we will use some temperature data for Germany. This can, again, be downloaded straight into the current session with `getData()`.</div><div class='line' id='LC1469'><br/></div><div class='line' id='LC1470'>The steps we are taking below to produce maps of average August temperatures in Germany are as follows:</div><div class='line' id='LC1471'><br/></div><div class='line' id='LC1472'>1. we get the global long-term mean temperatures from `worldclim` (these are so-called raster stacks with 12 layers, one for each month of the year - see below)</div><div class='line' id='LC1473'>2. we crop the global data set to the extent of Germany using the gadm data set from above</div><div class='line' id='LC1474'>3. we need to divide the temperature (which are in degrees celcius) by a factor of 10 (in order to save space, these data are stored as integers and hence multiplied by 10)</div><div class='line' id='LC1475'>4. we download the outline of Germany from `gadm`</div><div class='line' id='LC1476'>5. to highlight the problems related to colour representation we already touched upon in section 2.1.1. we plot 5 different representations of the same data on one page (similar to the polygon data from section 5.1.)</div><div class='line' id='LC1477'><br/></div><div class='line' id='LC1478'>```{r spatial raster data, tidy = FALSE, message = FALSE}</div><div class='line' id='LC1479'>Tmean &lt;- getData(&#39;worldclim&#39;, var = &#39;tmean&#39;, res = 5)</div><div class='line' id='LC1480'>ext &lt;- extent(gadm)</div><div class='line' id='LC1481'><br/></div><div class='line' id='LC1482'>Tmean.ger &lt;- crop(Tmean, ext)</div><div class='line' id='LC1483'><br/></div><div class='line' id='LC1484'># worldclim stores temepratures as degrees celcius * 10</div><div class='line' id='LC1485'>Tmean.ger &lt;- Tmean.ger / 10</div><div class='line' id='LC1486'><br/></div><div class='line' id='LC1487'>Tmean.ger</div><div class='line' id='LC1488'>```</div><div class='line' id='LC1489'><br/></div><div class='line' id='LC1490'>The default way of plotting raster data using `spplot` is, again, not so nice - see lattice defaults.</div><div class='line' id='LC1491'><br/></div><div class='line' id='LC1492'>```{r plotting raster data default, tidy = FALSE, fig.width=10, fig.height=15, fig.cap = fn(&quot;a basic raster plot using raster package&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1493'>Tplot &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;)</div><div class='line' id='LC1494'>print(Tplot)</div><div class='line' id='LC1495'>```</div><div class='line' id='LC1496'><br/></div><div class='line' id='LC1497'>So, let&#39;s manipulate the colours a little...</div><div class='line' id='LC1498'><br/></div><div class='line' id='LC1499'>```{r plotting raster data coladjustment, tidy = FALSE, fig.width=10, fig.height=15, fig.cap = fn(&quot;a basic raster plot using raster package&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1500'>ger &lt;- getData(&#39;GADM&#39;, country = &#39;DEU&#39;, level = 0)</div><div class='line' id='LC1501'><br/></div><div class='line' id='LC1502'>Tplot.spec &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;, </div><div class='line' id='LC1503'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.spec(1001), </div><div class='line' id='LC1504'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cuts = 1000, </div><div class='line' id='LC1505'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorkey = list(space = &quot;top&quot;),</div><div class='line' id='LC1506'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main = &quot;Average August temperatures in Germany&quot;) +</div><div class='line' id='LC1507'>&nbsp;&nbsp;as.layer(spplot(ger, zcol = &quot;NAME_ISO&quot;, col.regions = &quot;transparent&quot;))</div><div class='line' id='LC1508'><br/></div><div class='line' id='LC1509'>Tplot.rnbw &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;, </div><div class='line' id='LC1510'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = tim.colors(1001), </div><div class='line' id='LC1511'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cuts = 1000) +</div><div class='line' id='LC1512'>&nbsp;&nbsp;as.layer(spplot(ger, zcol = &quot;NAME_ISO&quot;, col.regions = &quot;transparent&quot;))</div><div class='line' id='LC1513'><br/></div><div class='line' id='LC1514'>clrs.hcl2 &lt;- function(n) {</div><div class='line' id='LC1515'>&nbsp;&nbsp;hcl(h = seq(270, 0, length.out = n), </div><div class='line' id='LC1516'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = 60, l = seq(90, 40, length.out = n), </div><div class='line' id='LC1517'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixup = TRUE)</div><div class='line' id='LC1518'>&nbsp;&nbsp;}</div><div class='line' id='LC1519'><br/></div><div class='line' id='LC1520'>Tplot.hcl &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;, </div><div class='line' id='LC1521'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.hcl2(1001), </div><div class='line' id='LC1522'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cuts = 1000) +</div><div class='line' id='LC1523'>&nbsp;&nbsp;as.layer(spplot(ger, zcol = &quot;NAME_ISO&quot;, col.regions = &quot;transparent&quot;))</div><div class='line' id='LC1524'><br/></div><div class='line' id='LC1525'>clrs.ylorrd &lt;- colorRampPalette(brewer.pal(9, &quot;YlOrRd&quot;))</div><div class='line' id='LC1526'><br/></div><div class='line' id='LC1527'>Tplot.ylorrd &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;, </div><div class='line' id='LC1528'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.ylorrd(1001), </div><div class='line' id='LC1529'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cuts = 1000) +</div><div class='line' id='LC1530'>&nbsp;&nbsp;as.layer(spplot(ger, zcol = &quot;NAME_ISO&quot;, col.regions = &quot;transparent&quot;))</div><div class='line' id='LC1531'><br/></div><div class='line' id='LC1532'>clrs.grey &lt;- colorRampPalette(brewer.pal(9, &quot;Greys&quot;))</div><div class='line' id='LC1533'><br/></div><div class='line' id='LC1534'>Tplot.greys &lt;- spplot(Tmean.ger, zcol = &quot;tmean8&quot;, </div><div class='line' id='LC1535'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.regions = clrs.grey(1001), </div><div class='line' id='LC1536'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cuts = 1000) +</div><div class='line' id='LC1537'>&nbsp;&nbsp;as.layer(spplot(ger, zcol = &quot;NAME_ISO&quot;, col.regions = &quot;transparent&quot;))</div><div class='line' id='LC1538'>```</div><div class='line' id='LC1539'><br/></div><div class='line' id='LC1540'>Now, we can plot the different versions and compare the usefulness of the different colour palettes.</div><div class='line' id='LC1541'><br/></div><div class='line' id='LC1542'>```{r plotting multiple rasters, tidy = FALSE, fig.width=20, fig.height=15, fig.cap = fn(&quot;using packages sp, raster, RColorBrewer, and grid to create a multiple raster map plot&quot;), fig.align = &#39;center&#39;}</div><div class='line' id='LC1543'>grid.newpage()</div><div class='line' id='LC1544'><br/></div><div class='line' id='LC1545'><br/></div><div class='line' id='LC1546'>vp1 &lt;- viewport(x = 0, y = 1, </div><div class='line' id='LC1547'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1548'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;top&quot;),</div><div class='line' id='LC1549'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper left&quot;)</div><div class='line' id='LC1550'>pushViewport(vp1)</div><div class='line' id='LC1551'>print(Tplot.rnbw, newpage = FALSE)</div><div class='line' id='LC1552'><br/></div><div class='line' id='LC1553'>upViewport(1)</div><div class='line' id='LC1554'><br/></div><div class='line' id='LC1555'>vp2 &lt;- viewport(x = 0, y = 0, </div><div class='line' id='LC1556'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1557'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1558'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower left&quot;)</div><div class='line' id='LC1559'>pushViewport(vp2)</div><div class='line' id='LC1560'>print(Tplot.ylorrd, newpage = FALSE) </div><div class='line' id='LC1561'><br/></div><div class='line' id='LC1562'>upViewport(1)</div><div class='line' id='LC1563'><br/></div><div class='line' id='LC1564'>vp3 &lt;- viewport(x = 0.25, y = 0, </div><div class='line' id='LC1565'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 1, width = 0.5,</div><div class='line' id='LC1566'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;left&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1567'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;centre&quot;)</div><div class='line' id='LC1568'>pushViewport(vp3)</div><div class='line' id='LC1569'>print(Tplot.spec, newpage = FALSE) </div><div class='line' id='LC1570'><br/></div><div class='line' id='LC1571'>upViewport(1)</div><div class='line' id='LC1572'><br/></div><div class='line' id='LC1573'>vp4 &lt;- viewport(x = 1, y = 1, </div><div class='line' id='LC1574'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1575'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;top&quot;),</div><div class='line' id='LC1576'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;upper right&quot;)</div><div class='line' id='LC1577'>pushViewport(vp4)</div><div class='line' id='LC1578'>print(Tplot.hcl, newpage = FALSE) </div><div class='line' id='LC1579'><br/></div><div class='line' id='LC1580'>upViewport(1)</div><div class='line' id='LC1581'>vp5 &lt;- viewport(x = 1, y = 0, </div><div class='line' id='LC1582'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = 0.5, width = 0.25,</div><div class='line' id='LC1583'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;just = c(&quot;right&quot;, &quot;bottom&quot;),</div><div class='line' id='LC1584'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name = &quot;lower right&quot;)</div><div class='line' id='LC1585'>pushViewport(vp5)</div><div class='line' id='LC1586'>print(Tplot.greys, newpage = FALSE) </div><div class='line' id='LC1587'><br/></div><div class='line' id='LC1588'>upViewport(1)</div><div class='line' id='LC1589'><br/></div><div class='line' id='LC1590'>```</div><div class='line' id='LC1591'><br/></div><div class='line' id='LC1592'>Again, the `hcl` based colour palette (top right panel) seems to be the most suitable, as data distortion is minimised and at the same time it provides multiple hues which help to distinguish the temperatures in more detail than e.g. the mono-hue palettes (bottom panels). The matlab jet colour palette - here `tim.colors()` clearly shows the worst distortion by creating several artificial cold &#39;islands/pools&#39;, especially in the German low-mountain-ranges (in the middle of the country). The colorbrewer `Spectral` palette is acceptable in that it does not distort the data very much, yet it is technically a diverging palette which is not optimal for representing data of sequential nature.</div><div class='line' id='LC1593'><br/></div><div class='line' id='LC1594'>Ok, so now we have a rather comprehensive, though far from complete (if that is even possible) set of tools for visualising our data using classical statistical plots as well as spatially mapped. I admit, that the spatial part is very limited here, but that may be part of another tutorial in the future. </div><div class='line' id='LC1595'><br/></div><div class='line' id='LC1596'>I hope that this tutorial was, at least in parts, useful for some of you and that we were able to expand your skill set of producing publication quality graphics using R to some extent.</div><div class='line' id='LC1597'><br/></div><div class='line' id='LC1598'>As mentioned at the beginning of this tutorial, I am happy to receive feedback, comments, criticism and bug reports at the e-mail address provided.</div><div class='line' id='LC1599'><br/></div><div class='line' id='LC1600'>Cheers</div><div class='line' id='LC1601'>Tim</div></pre></div>
          </td>
        </tr>
      </table>
  </div>

  </div>
</div>

<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" class="js-jump-to-line" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
  <form accept-charset="UTF-8" class="js-jump-to-line-form">
    <input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" autofocus>
    <button type="submit" class="button">Go</button>
  </form>
</div>

          </div>
        </div>

      </div><!-- /.repo-container -->
      <div class="modal-backdrop"></div>
    </div>
  </div><!-- /.site -->


    </div><!-- /.wrapper -->

      <div class="container">
  <div class="site-footer">
    <ul class="site-footer-links right">
      <li><a href="https://status.github.com/">Status</a></li>
      <li><a href="http://developer.github.com">API</a></li>
      <li><a href="http://training.github.com">Training</a></li>
      <li><a href="http://shop.github.com">Shop</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/about">About</a></li>

    </ul>

    <a href="/">
      <span class="mega-octicon octicon-mark-github"></span>
    </a>

    <ul class="site-footer-links">
      <li>&copy; 2013 <span title="0.05903s from fe4.rs.github.com">GitHub</span>, Inc.</li>
        <li><a href="/site/terms">Terms</a></li>
        <li><a href="/site/privacy">Privacy</a></li>
        <li><a href="/security">Security</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>
  </div><!-- /.site-footer -->
</div><!-- /.container -->


    <div class="fullscreen-overlay js-fullscreen-overlay" id="fullscreen_overlay">
  <div class="fullscreen-container js-fullscreen-container">
    <div class="textarea-wrap">
      <textarea name="fullscreen-contents" id="fullscreen-contents" class="js-fullscreen-contents" placeholder="" data-suggester="fullscreen_suggester"></textarea>
          <div class="suggester-container">
              <div class="suggester fullscreen-suggester js-navigation-container" id="fullscreen_suggester"
                 data-url="/tim-salabim/metvurst/suggestions/commit">
              </div>
          </div>
    </div>
  </div>
  <div class="fullscreen-sidebar">
    <a href="#" class="exit-fullscreen js-exit-fullscreen tooltipped leftwards" title="Exit Zen Mode">
      <span class="mega-octicon octicon-screen-normal"></span>
    </a>
    <a href="#" class="theme-switcher js-theme-switcher tooltipped leftwards"
      title="Switch themes">
      <span class="octicon octicon-color-mode"></span>
    </a>
  </div>
</div>



    <div id="ajax-error-message" class="flash flash-error">
      <span class="octicon octicon-alert"></span>
      <a href="#" class="octicon octicon-remove-close close ajax-error-dismiss"></a>
      Something went wrong with that request. Please try again.
    </div>

    
  </body>
</html>

